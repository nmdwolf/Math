\section{Lebesgue integral}
\subsection{Simple functions}

    \newdef{Indicator function}{\index{indicator function}
        An important function when working with sets is the following one:
        \begin{gather}
            \label{lebesgue:indicator_function}
    	    \mathbbm{1}_A(x) =
            \begin{cases}
	            1&x\in A\\
                0&x\not\in A
	        \end{cases}
	    \end{gather}
    }
    \newdef{Simple function}{\index{simple!function}\label{lebesgue:simple_function}
            Let $f$ be a function that takes on a finite number of non-negative values $\{a_i\}$ with for every $i\neq j: f^{-1}(a_i)\cap f^{-1}(a_j) = \emptyset$. $f$ is called a simple function if it can be expanded in the following way:
            \begin{gather}
                f(x) = \sum_{i=1}^n a_i\mathbbm{1}_{A_i}(x)
            \end{gather}
            with $A_i = f^{-1}(a_i)\in\mathcal{M}$.
    }
    \begin{definition}[Step function]\index{step function}\label{lebesgue:step_function}
        If the sets $A_i$ are intervals, the above function is often called a step function.
    \end{definition}

    \newformula{Lebesgue integral of simple functions}{\index{Lebesgue!integral}\label{lebesgue:integral_simple_function}
        Consider a simple function $\varphi$. Furthermore, let $\mu:\mathcal{M}\rightarrow\mathbb{R}$ be the Lebesgue measure and let $E$ be a measurable set. The Lebesgue integral of $\varphi$ over a $E$ with respect to $\mu$ is given by
        \begin{gather}
            \int_E\varphi\ d\mu = \sum_{i=1}^na_i\mu(E\cap A_i).
        \end{gather}
    }
    \begin{example}
        Let $\mathbbm{1}_\mathbb{Q}$ be the indicator function of the set of rational numbers. This function is clearly a simple function. Previous formula makes it possible to integrate the rational indicator function over the real line (which is not possible in the sense of Riemann):
        \begin{gather}
            \int_\mathbb{R}\mathbbm{1}_\mathbb{Q}\ d\mu = 1\times m(\mathbb{Q}) + 0\times m(\mathbb{R}\backslash\mathbb{Q}) = 0
        \end{gather}
        where the measure of the rational numbers is 0 because it is a countable set (see corollary \ref{lebesgue:theorem:countable_set_is_null}).
    \end{example}

\subsection{Measurable functions}

    \newformula{Lebesgue integral for non-negative functions}{\index{Lebesgue!integral}\label{lebesgue:integral}
        The definition for simple functions can be geenralized to non-negative measurable functions $f$ as follows:
        \begin{gather}
            \int_Ef\ d\mu = \sup\left\{\int_E\varphi\ d\mu:\varphi \text{ a simple function such that } \varphi\leq f\right\}.
        \end{gather}
        This integral is always non-negative.
    }

    \begin{formula}
        The following equality follows directly from $A\subseteq\mathbb{R}:A\cup A^c = \mathbb{R}$:
            \begin{gather}
                \label{lebesgue:interchanging_domains_with_indicator_function}
                \int_Af\ d\mu = \int f\mathbbm{1}_A\ d\mu.
            \end{gather}
    \end{formula}

    \begin{property}
        Let $f$ be a non-negative measurable function. Then $f=0$ a.e. if and only if $\int_\mathbb{R}f\ d\mu = 0$.
    \end{property}

    \begin{property}
        The Lebesgue integral over a null set is 0.
    \end{property}
    \begin{property}\label{lebesgue:general_properties}
        Let $f,g$ be measurable functions. The Lebesgue integral has the following properties:
        \begin{itemize}
            \item $f\leq g$ a.e. implies $\int f d\mu\leq\int g\ d\mu$.
            \item Let $A$ be a measurable set and consider a subset $B\subset A$. Then $\int_Bf\ d\mu\leq\int_Af\ d\mu$.
            \item The Lebesgue integral is linear.
            \item For every two disjoint measurable sets $A$ and $B$ we have that $\int_{A\cup B}f\ d\mu = \int_Af\ d\mu + \int_Bf\ d\mu$.
        \end{itemize}
    \end{property}

    \begin{theorem}[Mean value theorem]\index{mean!value theorem}
        If $a\leq f(x)\leq b$, then $am(A)\leq\int_Af\ d\mu\leq bm(A)$.
    \end{theorem}

    \begin{property}
        Let $f$ be a non-negative measurable function. There exists an increasing sequence $(\varphi_i)_{i\in\mathbb{N}}$ of simple functions such that $\varphi_i\nearrow f$.
    \end{property}
    \begin{property}
        Let $f$ be a bounded measurable function defined on the interval $[a,b]$. For every $\varepsilon>0$ there exists a step function\footnote{See definition \ref{lebesgue:step_function}.} $h$ such that $\int_a^b|f-h|\ d\mu<\varepsilon$.
    \end{property}

\subsection{Integrable functions}

    \newdef{Integrable function}{\index{integrable}\label{lebesgue:integrable_function}
        Let $E\in\mathcal{M}$. A measurable function $f$ is said to be integrable over $E$ if both $\int_Ef^+\ d\mu$ and $\int_Ef^-\ d\mu$ are finite. The Lebesgue integral of $f$ over $E$ is then defined as
        \begin{gather}
            \int_E f\ d\mu = \int_E f^+\ d\mu - \int_E f^-\ d\mu.
        \end{gather}
    }
    \sremark{The difference between the integral in definition \ref{lebesgue:integral} and the integral of an integrable function is that with the latter $f$ does not have to be non-negative.}

    \begin{property}
        $f$ is integrable if and only if $|f|$ is integrable. Furthermore, $\int_E|f|\ d\mu = \int_E f^+\ d\mu + \int_E f^-\ d\mu$.
    \end{property}
    \begin{property}
        Let $f,g$ be integrable functions. The following important properties apply:
        \begin{itemize}
            \item $f+g$ is also integrable.
            \item $\forall E\in\mathcal{M}, \int_Ef\ d\mu\leq\int_Eg\ d\mu\implies f\leq g$ a.e.
            \item Let $c\in\mathbb{R}$. $\int_E(cf)\ d\mu = c(\int_Ef\ d\mu)$.
            \item $f$ is finite a.e.
            \item $|\int f\ d\mu|\leq\int|f|\ d\mu$
            \item $f\geq0\land\int f\ d\mu=0\implies f=0$ a.e.
        \end{itemize}
    \end{property}

    \begin{definition}[Lebesgue integrable functions]
        The set of functions integrable over a set $E\in\mathcal{M}$ forms the vector space $\mathcal{L}^1(E)$.
    \end{definition}

    \begin{property}
        Let $f\in\mathcal{L}^1$ and $\varepsilon>0$. There exists a continuous function $g$, vanishing outside some finite interval, such that $\int|f-g|\ d\mu<\varepsilon$.
    \end{property}

    \begin{property}\index{continuity!absolute continuity}\label{lebesgue:theorem:measure_by_integral}
        Let $f\geq0$. The mapping $E\mapsto\int_Ef\ d\mu$ is a measure on $\mathcal{M}$ (if it exists, i.e. if $f$ is integrable). Furthermore, this measure is said to be \textbf{absolutely continuous}. (See section \ref{lebesgue:section:Radon-Nikodym} for further information.)
    \end{property}

    \newdef{Locally integrable function}{\index{locally!integrable}
        A measurable function is said to be locally integrable if it is integrable on every compact subset of its domain. The space of locally integrable functions is denoted by $\mathcal{L}^1_{loc}$.
    }
    \begin{example}
        All continuous functions are locally integrable.
    \end{example}

\subsection{Convergence theorems}

    \begin{theorem}[Fatou's lemma]\index{Fatou}\label{lebesgue:theorem:fatous_lemma}
        Let $(f_n)_{n\in\mathbb{N}}$ be a sequence of non-negative measurable functions.
        \begin{gather}
            \int_E\left(\liminf_{n\rightarrow\infty}f_n\right)\ d\mu \leq \liminf_{n\rightarrow\infty}\int_Ef_n\ d\mu
        \end{gather}
    \end{theorem}
    \begin{theorem}[Monotone convergence theorem]\index{monotone!convergence theorem}\label{lebesgue:theorem:monotone_convergence_theorem}
        Let $E\in\mathcal{M}$ and let $(f_n)_{n\in\mathbb{N}}$ be an increasing sequence of non-negative measurable functions such that $f_n\nearrow f$ pointwise a.e. We have the following powerful equality:
        \begin{gather}
            \int_E f\ d\mu = \lim_{n\rightarrow\infty}\int_E f_n(x)\ d\mu.
        \end{gather}
    \end{theorem}

    \begin{method}\label{lebesgue:method:linear_proofs}
        To prove results concerning integrable functions in spaces such as $\mathcal{L}^1(E)$ it is often useful to proceed as follows:
        \begin{enumerate}
            \item Verify that the property holds for indicator functions. (This often follows by definition.)
            \item Use the linearity to extend the property to simple functions.
            \item Apply the monotone convergence theorem to show that the property holds for all non-negative measurable functions.
            \item Extend the property to all integrable functions by expanding $f = f^+ - f^-$ and applying linearity again.
        \end{enumerate}
    \end{method}

    \begin{theorem}[Dominated convergence theorem]\index{dominated convergence theorem}\label{lebesgue:theorem:dominated_convergence_theorem}
        Let $E\in\mathcal{M}$ and let $(f_n)_{n\in\mathbb{N}}$ be a sequence of measurable functions with $\forall n:|f_n|\leq g$ a.e. for some function $g\in\mathcal{L}^1(E)$. If $f_n\rightarrow f$ pointwise a.e. then $f$ is integrable over $E$ and
        \begin{gather}
            \int_E f\ d\mu = \lim_{n\rightarrow\infty}\int_E f_n(x)\ d\mu.
        \end{gather}
    \end{theorem}

    \begin{property}[Interch]
        Let $(f_n)_{n\in\mathbb{N}}$ be a sequence of non-negative measurable functions. The following equality applies:
        \begin{gather}
            \int\sum_{n=1}^{+\infty}f_n(x)\ d\mu = \sum_{n=1}^{+\infty}\int f_n(x)\ d\mu.
        \end{gather}
        We cannot conclude that the right-hand side is finite a.e., so the series on the left-hand side need not be integrable.
    \end{property}

    \begin{theorem}[Beppo Levi\footnotemark]\index{Beppo Levi}\label{lebesgue:theorem:beppo_levi}
        \footnotetext{Note that various other theorems and variants can be found in the literature under the same name.}
        Suppose that \[\sum_{i=1}^\infty\int|f_n|(x)\ d\mu\text{ is finite.}\] The series $\sum_{i=1}^\infty f_n(x)$ converges a.e. Furthermore, the series is integrable and
        \begin{gather}
            \int\sum_{i=1}^\infty f_n(x)\ d\mu = \sum_{i=1}^\infty\int f_n(x)\ d\mu.
        \end{gather}
    \end{theorem}

    \begin{theorem}[Riemann-Lebesgue lemma]\index{Riemann!Riemann-Lebesgue lemma}\label{lebesgue:riemann_lebesue_lemma}
        Let $f\in\mathcal{L}^1$. The sequences \[s_k = \int_{-\infty}^{+\infty}f(x)\sin(kx)dx\] and \[c_k = \int_{-\infty}^{+\infty}f(x)\cos(kx)dx\] both converge to 0.
    \end{theorem}

\subsection{Relation to the Riemann integral}

    \begin{property}
        Let $f:[a,b]\rightarrow\mathbb{R}$ be a bounded function.
        \begin{itemize}
            \item $f$ is Riemann-integrable if and only if $f$ is continuous a.e. with respect to the Lebesgue measure on $[a,b]$, i.e. the set of discontinuities of $f$ has measure zero.
            \item Riemann-integrable functions on $[a,b]$ are integrable with respect to the Lebesgue measure on $[a,b]$ and the integrals coincide.
        \end{itemize}
    \end{property}

    \begin{property}
        If $f\geq0$ and the improper Riemann integral \ref{calculus:improper_integral} exists, then the Lebesgue integral $\int f\ d\mu$ exists and the two integrals coincide.
    \end{property}
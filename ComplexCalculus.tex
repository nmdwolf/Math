\chapter{Complex calculus}

\section{Complex algebra}
	
	The set of complex numbers $\mathbb{C}$ forms a 2-dimensional vector space over the field of real numbers. Furthermore the operations of complex addition and complex multiplication also turn the complex numbers into a field.

	\newdef{Complex conjugate}{\index{complex conjugate}
    		The complex conjugate $\overline{z}:a+bi\mapsto a-bi$ is an involution, i.e. $\overset{=}{z} = z$. It is sometimes denoted by $z^*$ instead of $\overline{z}$.
	}
    
	\newformula{Real/imaginary part}{
		\nomenclature[O]{$\text{\text{Re}}$}{Real part of a complex number.}
		\nomenclature[O]{$\text{\text{Im}}$}{Imaginary part of a complex number.}
    		A complex number $z$ can also be written as $\text{Re}(z) + i\text{Im}(z)$ where
        	\begin{equation}
			\text{Re}(z) = \stylefrac{z + \overline{z}}{2}
		\end{equation}
        	\begin{equation}
			\text{Im}(z) = \stylefrac{z - \overline{z}}{2i}
		\end{equation}
	}
	\newdef{Argument}{\index{argument}
		\nomenclature[O]{$\text{arg}$}{Argument of a complex number.}
		Let $z$ be a complex number parametrized as $z = re^{i\theta}$. The number $\theta$ is called the argument of $z$ and it is denoted by $\arg(z)$.
	}
	
	\newdef{Riemann sphere}{\index{Riemann!sphere}
		Consider the one-point compactification\footnote{See definition \ref{topology:alexandrov_compactification}.} $\overline{\mathbb{C}} = \mathbb{C}\cup\{\infty\}$. This set is called the Riemann sphere or extended complex plane. The standard operations on $\mathbb{C}$ can be generalized to $\overline{\mathbb{C}}$ in the following way:
		\begin{align}
			z + \infty &= \infty\nonumber\\
			z * \infty &= \infty\\
			\frac{z}{\infty} &= 0\nonumber
		\end{align}
		for all non-zero $z \neq \infty$. As there exists no multiplicative inverse for $\infty$ the Riemann sphere does not form a field.
	}

\section{Holomorphic functions}
        
        \begin{definition}[Holomorphic]\index{holomorphic}
	        A function $f$ is holomorphic on an open set $U$ if it is complex differentiable at every point $z_0\in U$. 
        \end{definition}
        \newdef{Biholomorphic}{
        	A complex function $f$ is said to be biholomorphic if both $f$ and $f^{-1}$ are holomorphic.
        }
        
        \begin{property}[Cauchy-Riemann conditions]\index{Cauchy!Cauchy-Riemann conditions}
	        A holomorphic function $f(z)$ satisfies the following conditions:
	        \begin{equation}
	                \label{complexcalculus:cauchy_riemann}
	                \boxed{\pderiv{u}{x} = \pderiv{v}{y} \text{\qquad and\qquad} \pderiv{u}{y} = -\pderiv{v}{x}}
	        \end{equation}
	        or equivalently:
	        \begin{equation}
	                \label{complexcalculus:holomorphic_alternative_condition}
	                \boxed{\pderiv{f}{\overline{z}} = 0}
	        \end{equation}
        \end{property}
        
        \begin{theorem}[Looman-Menchoff\footnotemark]
        	\footnotetext{This is the strongest (most general) theorem on the holomorphy of continuous functions as it generalizes the original results by Riemann and Cauchy-Goursat.}
        	Let $f(z)$ be a continuous complex-valued function defined on a subset $U\in\mathbb{C}$. If the partial derivatives of the real and imaginary part exist and if $f$ satisfies the Cauchy-Riemann conditions then $f$ is holomorphic on $U$.
        \end{theorem}

	\begin{property}
		Functions $u,v$ satisfying the CR-conditions are harmonic functions, i.e. they satisfy Laplace's equation.
	\end{property}
	\begin{property}
		Functions $u,v$ satisfying the CR-conditions have orthogonal level curves \ref{set:level_set}.
	\end{property}

\section{Complex integrals}
		
	In this and further sections, all contours have been chosen to be evaluated counterclockwise (by convention). To obtain results concerning clockwise evaluation, most of the time adding a minus sign is sufficient.
        
        \newdef{Contour}{\index{contour}
        	A contour is a curve $z(t)$ that can be parametrized by
	        \begin{equation}
			\left.
			\begin{array}{c}
                	x = x(t)\\
        	        y = y(t)
        	        \end{array}\right\}
        	        \rightarrow z(t) = z = x+iy
		\end{equation}
        }
        \newformula{Complex contour integral}{
        	The complex contour integral of a function $f(z) = u(z) + iv(z)$ is defined as the following line integral:
        	\begin{equation}
        	    	\label{complexcalculus:contour_integral}
			\int_{z_1}^{z_2}f(z)dz = \int_{(x_1,y_1)}^{(x_2,y_2)}[u(x,y) + iv(x,y)](dx + idy)
		\end{equation}
        }
        
        \begin{theorem}[Cauchy's Integral Theorem\footnotemark]\index{Cauchy!integral theorem}
        	\footnotetext{Also called the \textit{Cauchy-Goursat theorem}.}
        	Let $\Omega$ be a simply-connected subset of $\mathbb{C}$ and let $f$ be a holomorphic function on $\Omega$. Then for every closed rectifiable contour $C$  in $\Omega$:
        	\begin{equation}
			\label{complexcalculus:cauchy_integral_theorem}
        	        \boxed{\oint_C f(z) dz = 0}
		\end{equation}
        \end{theorem}
        \result{The contour integral of a holomorphic function depends only on the limits of integration and not on the contour connecting them.}
        
        \begin{formula}[Cauchy's Integral Formula]\index{Cauchy!integral formula}
        	Let $\Omega$ be a connected subset of $\mathbb{C}$ and let $f$ be a holomorphic function on $\Omega$. Let $C$ be a contour in $\Omega$. For every point $z_0$ inside $C$ we find:
        	\begin{equation}
			\label{complexcalculus:cauchy_integral_formula}
        	        \boxed{f(z_0) = \frac{1}{2\pi i}\oint_C \frac{f(z)}{z - z_0} dz}
		\end{equation}
        \end{formula}

        \begin{result}[Analytic function]\index{analytic}
		Let $\Omega$ be a connected subset of $\mathbb{C}$ and $C$ a closed contour in $\Omega$. If $f$ is holomorphic on $\Omega$ then $f$ is analytic\footnotemark\ on $\Omega$ and:
	        \begin{equation}
			\label{complexcalculus:cauchy_integral_formula_derivative}
	                \boxed{f^{(n)}(z_0) = \frac{1}{2\pi i}\oint_C f(z) \frac{n!}{(z - z_0)^{n+1}} dz}
		\end{equation}
	        Furthermore, the derivatives are also holomorphic on $\Omega$.
	        \footnotetext{See definition \ref{calculus:analytic}.}
	\end{result}
        
        \begin{theorem}[Morera's Theorem]\index{Morera's theorem}
	        If $f$ is continuous on a connected open set $\Omega$ and $\oint_C f(z) dz = 0$ for every closed contour $C$ in $\Omega$, then $f$ is holomorphic on $\Omega$.
	\end{theorem}
        
        \begin{definition}[Meromorphic]\index{meromorphic}
		A function $f$ is called meromorphic when it is analytic on the whole complex plane with exception of isolated poles and removable singularities.
	\end{definition}

	\begin{theorem}[Sokhotski-Plemelj]\index{Sokhotski-Plemelj theorem}
		Let $f(x)$ be a continuous complex-valued function defined on the real line and let $a<0<b$.
		\begin{equation}
			\lim_{\varepsilon\rightarrow0^+}\int_a^b\frac{f(x)}{x\pm i\varepsilon}dx = \mp i\pi f(0) + \mathcal{P}\int_a^b\frac{f(x)}{x}dx
		\end{equation}
		where $\mathcal{P}$ denotes the Cauchy principal value.
	\end{theorem}
        
\section{Laurent series}
    	
    	\begin{definition}[Laurent series]\index{Laurent!series}\label{complexcalculus:laurent_series}
        	If $f$ is function, analytic on an annulus A, then $f$ can be expanded as the following series:
        	\begin{equation}
        	        f(z) = \sum^{\infty}_{n=-\infty} a_n (z - z_0)^n \qquad \text{with} \qquad a_n = \frac{1}{2\pi i} \oint \frac{f(z')}{(z' - z_0)^{n+1}} dz'
		\end{equation}
	\end{definition}
        
        \begin{remark}
		The Laurent series of an analytic function $f$ converges uniformly to $f$ in the ring shaped region ('\textit{annulus}') $R_1 < |z - z_0| < R_2$, with $R_1$ and $R_2$ the distances from $z_0$ to the two closest poles.
        \end{remark}
        
        \newdef{Principal part}{\index{principal!part}
        	The principal part of a Laurent series is defined as the sum:
		\begin{equation}
	            	\sum_{n=-\infty}^{-1}a_n(z-z_0)^n
		\end{equation}
        }
    
\section{Singularities}
\subsection{Poles}
	
	\newdef{Pole}{\index{pole}
    		A function $f(z)$ has a pole of order $m>0$ at a point $z_0$ if its Laurent series at $z_0$ satisfies $\forall n<-m:a_n = 0$ and $a_{-m}\neq0$.
	}
    
	\newdef{Essential singularity}{\index{essential singularity}
    		A function $f(z)$ has an essential singularity at a point $z_0$ if its Laurent series at $z_0$ satisfies $\forall n\in\mathbb{N}:a_{-n}\neq0$, i.e. its Laurent series has infinitely many negative degree terms.
	}
    
	\begin{theorem}[Picard's great theorem]\index{Picard!great theorem}
		Let $f(z)$ be an analytic function with an essential singularity at $z_0$. On every punctured neighbourhood of $z_0$, $f(z)$ takes on all possible complex values, with at most a single exception, infinitely many times.
	\end{theorem}
    
	\newmethod{Frobenius transformation}{\index{Frobenius!transformation}
	  	To study the behaviour of a function $f(z)$ at $z\rightarrow\infty$, one should apply the Frobenius transformation $h = 1/z$ and study the limit $\lim_{h\rightarrow0}f(h)$.
	}

\subsection{Branch cuts}
	
	\newformula{Roots}{
    		Let $z\in\mathbb{C}$. The $n^{th}$ roots\footnotemark\ of $z = re^{i\theta}$ are given by:
        	\begin{equation}
			z^{1/n} = \sqrt[n]{r}\exp\left(i\frac{\theta + 2\pi k}{n}\right)
		\end{equation}
        	where $k\in\{0,1,...,n\}$.
		\footnotetext{Also see the \textit{fundamental theorem of algebra} \ref{linalgebra:fundamental_theorem_of_algebra}.}
	}
	\newformula{Complex logarithm}{\index{logarithm}
		We parametrize $z$ as $z = re^{i\theta}$.
    		\begin{equation}
			\text{LN}(z) = \ln(r) + i(\theta + 2\pi k)
		\end{equation}
	}
	
	\newdef{Branch}{
		From these two formulas it is clear that the complex roots and logarithms are multi-valued functions. To get an unambiguous image it is necessary to fix a value of the parameter $k$. By doing so there will arise curves in the complex plane where the function is discontinuous. These are the branch cuts. A \textbf{branch} is then defined as a particular choice of the parameter $k$. For the logarithm the choice for $\arg(\text{LN})\in\ ]\alpha, \alpha + 2\pi]$ is often denoted by $\text{LN}_\alpha$ or $\log_\alpha$.	
	}
	\newdef{Branch point}{
    		Let $f(z)$ be a complex valued function. A point $z_0$ such that there exists no neighbourhood $|z-z_0|<\varepsilon$ where $f(z)$ is single valued is called a branch point.
	}
	\newdef{Branch cut}{
    		A line connecting exactly two branch points is called a branch cut. One of the branch points can be at infinity. In case of multiple branch cuts, they do not cross. 
	}
	
	
	\begin{example}
		Consider the complex function \[f(z) = \stylefrac{1}{\sqrt{(z-z_1)...(z-z_n)}}\] This function has singularities at $z_1,...,z_n$. If $n$ is even, this function will have $n$ (finite) branch points. This implies that the points can be grouped in pairs connected by non-intersecting branch cuts. If $n$ is odd, this function will have $n$ (finite) branch points and one branch point at infinity. The finite branch points will be grouped in pairs connected by non-intersecting branch cuts and the remaining branch point will be joined to infinity by a branch cut which does not intersect the others.(See \cite{branchcut} for the proof.)
	\end{example}

	\newdef{Principal value}{\index{principal!value}
		The principal value of a multi-valued complex function is defined as the choice of branch such that $\arg(f)\in]-\pi,\pi]$.
	}
    
\subsection{Residue theorem}
	
	\newdef{Residue}{
		\nomenclature[O]{$\text{Res}$}{Residue of a complex function.}
    		By applying formula \ref{complexcalculus:contour_integral} to a polynomial function we find:
    		\begin{equation}
    			\int_C(z-z_0)^ndz = 2\pi i\delta_{n,-1}
    		\end{equation}
    		where $C$ is a circular contour around the pole $z = z_0$. This means that integrating a Laurent series around a pole isolates the coefficient $a_{-1}$. This coefficient is therefore called the residue of the function at the given pole.
	}
	\begin{notation}
		The residue of a complex function $f(z)$ at a pole $z_0$ is denoted by $\text{Res}[f(z)]_{z=z_0}$.
	\end{notation}
	
	\begin{formula}
    		For a pole of order $m$, the residue is calculated as follows:
		\begin{equation}
			\label{complexcalculus:residue}
            		\operatorname{Res}\left[f(z)\right]_{z=z_j} = a_{-1} = \lim_{z\rightarrow z_0} \stylefrac{1}{(m - 1)!} \left(\pderiv{}{z}\right)^{m-1}\left(f(z)(z-z_0)\right)
		\end{equation}
	        For essential singularities the residue can be found by writing out the Laurent series explicitly.
	\end{formula}

	\begin{theorem}[Residue theorem]\index{Residue theorem}\label{complexcalculus:residue_theorem}
		If $f(z)$ is a meromorphic function in $\Omega$ and if $C$ is a closed contour in $\Omega$ which contains the poles $z_j$ of $f(z)$, then:
		\begin{equation}
                	\boxed{\oint_Cf(z)dz = 2\pi i\sum_j \operatorname{Res}\left[f(z)\right]_{z=z_j}}
		\end{equation}
	\end{theorem}
	\remark{For poles on the contour $C$, only half of the residue contributes to the integral.}
    
	\begin{formula}[Argument principle]\index{argument principle}
		Let $f(z)$ be a meromorphic function. Let $Z_f, P_f$ be respectively the number of zeroes and poles of $f(z)$ inside the contour $C$. From the residue theorem we can derive the following formula:
		\begin{equation}
			\frac{1}{2\pi i}\oint_C\frac{f(z)}{f'(z)}dz = Z_f - P_f
		\end{equation}
	\end{formula}
	\begin{formula}[Winding number]\index{winding number}\index{index}
		Let $f(z)$ be a meromorphic function and let $C$ be a simple closed contour. For all $a\not\in f(C)$ the winding number or \textbf{index} of $a$ with respect to the function $f$ is defined as:
		\begin{equation}
			\text{Ind}_f(a) = \frac{1}{2\pi i}\oint_C\frac{f'(z)}{f(z) - a}dz
		\end{equation}
		This number will always be an integer.
	\end{formula}

\section{Limit theorems}

    	\begin{theorem}[Small limit theorem]\index{Limit theorem}\label{complexcalculus:theorem:small_limit}
		Let $f$ be a function that is holomorphic almost every where on $\mathbb{C}$. Let the contour $C$ be a circular segment with radius $\varepsilon$ and central angle $\alpha$.
		If $z$ is parametrized as $z = \varepsilon e^{i\theta}$ then\[\int_Cf(z)dz = i\alpha A\] with \[A = \lim_{\varepsilon\rightarrow0}f(z)\]
	\end{theorem}
	
        \begin{theorem}[Great limit theorem]\label{complexcalculus:theorem:great_limit}
		Let $f$ be a function that is holomorphic almost every where on $\mathbb{C}$. Let the contour $C$ be a circular segment with radius $R$ and central angle $\alpha$. If $z$ is parametrized as $z = Re^{i\theta}$ then\[\int_Cf(z)dz = i\alpha B\] with \[B = \lim_{R\rightarrow+\infty}f(z)\]
	\end{theorem}
	
        \begin{theorem}[Jordan's lemma]\index{Jordan}\label{complexcalculus:theorem:jordan}
		Let $g$ be a continuous function with $g(z) = f(z)e^{bz}$. Let the contour $C$ be a semicircle lying in the half-plane bounded by the real axis and oriented away of the point $\overline{b}i$. If $z$ is parametrized as $z=Re^{i\theta}$ and \[\lim_{R\rightarrow\infty}f(z) = 0\] then\[\int_Cg(z)dz = 0\]
	\end{theorem}
		
\section{Analytic continuation}

	\begin{theorem}[Schwarz' reflection principle]\index{Schwarz!reflection principle}
		Let $f(z)$ be analytic on the upper half plane. If $f(z)$ is real when $z$ is real then
	        \begin{equation}
	        	f(\overline{z}) = \overline{f(z)}
	        \end{equation}
	\end{theorem}

\section{Integration Theory}\label{section:integration_manifolds}

    For the theory on measure spaces and Lebesgue integration see chapter \ref{chapter:lebesgue}.

\subsection{Orientation and densities}

    One can define an orientation of manifolds by generalizing the situation for vector spaces \ref{tensor:orientation}:
    \newdef{Orientable manifold}{\index{orientation}\index{volume}\label{diff:orientability}
        First, we slightly modify the definition of the volume element. A \textbf{volume form} on $M$ is a nowhere-vanishing top-dimensional differential form $\text{Vol}\in\Omega^n(M)$ where $n=\dim(M)$. The definition of an orientation is then virtually the same as for vector spaces.

        An \textbf{oriented atlas} is given by all charts of $M$ for which the pullback of the Euclidean volume form is a positive multiple of $\text{Vol}$. This also implies that the transition functions have a positive Jacobian determinant. The existence of such a volume form turns a differentiable manifold into an \textbf{orientable manifold}.

        Alternatively, an orientable manifold with volume form $\text{Vol}$ is said to be \textbf{positively oriented} if it comes equipped with a smooth choice of bases $\{v_1,\ldots,v_n\}$ for $T_pM$ such that $\text{Vol}(v_1,\ldots,v_n)>0$.
    }

    \begin{example}\index{determinant}
        Let $M=\mathbb{R}^n$. The canonical Euclidean volume form is given by the determinant map
        \begin{gather}
            \det:(u_1,\ldots,u_n)\mapsto\det(u_1,\ldots,u_n)
        \end{gather}
        where the $u_n$'s are expressed in the canonical basis $(e_1,\ldots,e_n)$. The terminology of ''volume forms'' is justified by noting that the determinant map gives the signed volume of the $n$-dimensional parallelotope spanned by the vectors $\{u_1,\ldots,u_n\}$.
    \end{example}

    \begin{property}
        Let $\omega_1,\omega_2$ be two volume forms on $M$. There exists a smooth function $f$ such that \[\omega_1 = f\omega_2.\] Furthermore, the sign of this function is constant on every connected component of $M$.
    \end{property}

    One can also rephrase orientability of manifolds in terms of bundles:
    \newdef{Orientation bundle}{\index{orientation}
        Consider a smooth manifold $M$ with its tangent bundle $TM$. The transition function $A$ of $TM$ is given by the Jacobian of the transitions functions on $M$. The associated line bundle with transition function $\sgn\det(A)$ is called the orientation bundle $o(M)$.

        In general one can define the orientation bundle $o(E)$ for any vector bundle $E$, where one replaces the Jacobian in the above construction by the transition maps of $E$. From this it is clear that the orientation bundle $o(M)$ is the same as $o(TM)$.
    }
    \newadef{Orientable manifold}{
        A smooth manifold is orientable if its orientation bundle is trivial.
    }
    \begin{property}[Orientability]
        A smooth manifold is orientable if and only if its canonical line bundle \ref{diff:canonical_bundle} is trivial. Furthermore, for orientable manifolds there exists an isomorphism $\Gamma(\det(T^*M))\cong\Gamma(|\Omega|(M))$.
    \end{property}

    \begin{remark}
        By definition of the orientation bundle, the transition functions are those that have a positive determinant. This gives the equivalence with definition \ref{diff:orientability}. In the next chapter on principal bundles we will give yet another (equivalent) definition of orientability in terms of $G$-structures (see example \ref{diff:orientable_structure}).
    \end{remark}

    In a later paragraph in this section we will generalize integration from orientable manifolds to non-orientable manifolds. To achieve this goal we will need to generalize the notion of differential forms. A good introduction for this is \cite{tensor_bundle_calculus}.
    \newdef{Pseudoscalars}{\index{pseudo!scalar}
        Consider a group morphism $\phi:G\rightarrow\text{O}(p, q)$ for some $p,q\in\mathbb{N}$. The pseudoscalar representation of $G$, induced by $\phi$, is defined as the one-dimensional representation given by
        \begin{gather}
            \mathbf{1}_\sgn:g\mapsto\det(\phi(g)).
        \end{gather}
        The notation $\mathbf{1}_\sgn$ refers to the fact that this representation is a generalization of the \textit{alternating (or sign) representation} of the permutation groups $S_n$.

        Sections of vector bundle with defined by $\mathbf{1}_\sgn$ are generally called \textbf{pseudoscalar fields}.  When twitsing a vector bundle by the pseudoscalar bundle $\Psi$ over $M$, we often add the prefix ''pseudo'' to the name of the bundle $E$, e.g. the $\Psi$-twisted $k$-form bundle is called the bundle of $k$-pseudoforms.

        Any Riemannian manifold admits a canonical pseudoscalar bundle $\Psi$ associated to its (orthogonal) frame bundle. In fact for such manifolds the pseudoscalar bundle coincides with the following slightly different construction:
    }

    \begin{definition}[Tensor density]\index{tensor!density}\label{diff:density}
        Consider a vector bundle $E\rightarrow M$ defined by transition maps $A$. The associated bundle of (tensor) $s$-densities is obtained by using the representation
        \begin{gather}
            \rho:A\mapsto\det(A)^{-s}
        \end{gather}
        The number $s$ is called the \textbf{weight} of the density. For $E\equiv TM$ one obtains the (tensor) $s$-densities on $M$, which in the case of $s=1$ are equivalent to top-dimensional forms on $M$. When twisting a vector bundle by an $s$-density bundle, the prefix ''$s$-weighted'' is often added.
    \end{definition}

    \begin{example}[Pseudovectors]\index{pseudo!vector}
        If we consider the representation
        \begin{gather}
            \rho:A\mapsto\sgn\det(A)A,
        \end{gather}
        we can construct a bundle similar to the tangent bundle where the sign of the cocycles $t_{ji}$ now has an influence on the fibres. Sections of such bundles are called \textbf{pseudovector fields}. This construction is equivalent to twisting the tangent bundle by the pseudoscalar bundle $\Psi$, hence its name.
    \end{example}

    \begin{remark}[Honest densities]\index{density}
        Now one should pay incredible attention to the definition of a \textbf{density} (i.e. without the prefix ''tensor''). A density is defined as an $n$-pseudoform, i.e. a section of the \textbf{density bundle} $|\Omega|(M):=\Omega^n(M)\otimes o(M)$. Hence the transition function is $|\det(A)|$, where $A$ is the transition function of $T^*M$.\footnote{One can also define honest $s$-densities $|\Omega|^s(M)$ by combining definition \ref{diff:density} with the orientation bundle to obtain transition maps $|\det(A)|^s$ (for $A$ the cotangent transition map). This is also the only possible way to generalize the $s$-densities of definition \ref{diff:density} to real $s$.}  These are the objects one can integrate over any manifold, even the non-orientable ones. They are essentially maps $\Gamma(\det(T^*M))\rightarrow C^\infty(M)$.

        A naive way to construct a density on a manifold $M$ is by choosing a volume form $\text{Vol}$ and taking the absolute value $|\text{Vol}|$.
    \end{remark}

\subsection{Integration of top-dimensional forms}\index{Lebesgue!integral}\index{measure}

    \newdef{Measure zero}{\index{null!set}
        A subset $U\subset M$ of an orientable manifold is said to be of measure zero if it is the countable union of inverse images (with respect to the chart maps on $M$) of null sets in $\mathbb{R}^n$.
    }

    \newdef{Integrable form}{
        A differential form is said to be integrable if its components with respect to any basis of $\Omega^k(M)$ are Lebesgue integrable on $\mathbb{R}^n$.
    }

    \begin{formula}[Integration of compactly supported forms]
        Consider a form $\omega\in\Omega^{\dim(M)}$ on $M$ with compact support on a coordinate patch $U\subset M$.
        \begin{gather}
            \label{forms:integration_compact_support}
            \int_M\omega = \int_U\omega := \int_{-\infty}^{+\infty}\cdots\int_{-\infty}^{+\infty}\omega_{12\ldots n}(x)dx^1dx^2\cdots dx^n.
        \end{gather}
        This integral is well-defined because under an orientation-preserving change of coordinates the component $\omega_{1\ldots n}$ transforms as $\omega'_{1\ldots n} = \det(J)\omega_{1\ldots n}$ where $J$ is the Jacobian of the coordinate transformation. Inserting this in the integral and replacing $dx_i$ by $dx'_i$ then gives us the well-known change-of-variables formula from Lebesgue integration theory.

        If we require the manifold $M$ to be paracompact, such that to every open cover $\{U_i\subseteq M\}_{i\in I}$ there is associated a subordinate partition of unity $\{\phi_i\}_{i\in I}$, we define the integral of a general compactly supported form $\omega\in\Omega^n(M)$ as follows:
        \begin{gather}
            \int_M\omega := \sum_{i\in I}\int_{U_i}\rho_i\omega.
        \end{gather}
    \end{formula}
    \begin{remark}
        Although we only defined integration for compactly supported forms, the general formula can also sometimes be applied to general forms. It is well-defined whenever the forms $\rho_i\omega$ are integrable and the sum in the definition converges.
    \end{remark}

    \newprop{Compact manifolds}{
        Let $M$ be a smooth compact manifold. Because every form on $M$ is obviously compactly supported, all forms are integrable on $M$.
    }

    \newprop{Invariance under pullbacks}{
        Consider an orientation-preserving diffeomorphism $f:M\rightarrow N$.
        \begin{gather}
            \int_Mf^*\omega = \int_N\omega
        \end{gather}
    }

    \begin{notation}
        Because the integral of differential forms satisfies properties similar to the ones listed in \ref{lebesgue:general_properties}, we introduce the following notation:
        \begin{gather}
            \langle M, \omega \rangle := \int_M\omega.
        \end{gather}
    \end{notation}

\subsection{Stokes's theorem}

    \begin{theorem}[Stokes's theorem]\index{Stokes!theorem for differential forms}
        \label{forms:theorem:stokes_theorem}
        Let $M$ be an orientable smooth manifold with boundary $\partial M$ and let $\omega$ be a differential $k$-form on $M$.
        \begin{gather}
            \int_{\partial M}\omega = \int_M d\omega.
        \end{gather}
    \end{theorem}
    \begin{result}
        The Kelvin-Stokes theorem \ref{vectorcalculus:stokes_theorem}, the divergence theorem \ref{vectorcalculus:divergence_theorem} and Green's identity \ref{vectorcalculus:green_indentity} are immediate results of this (generalized) Stokes's theorem.
    \end{result}

\subsection{Distributions}

    For more information on the theory of distributions on Euclidean space, see chapter \ref{chapter:distributions}.

    There are two ways to introduce distributions on general manifolds. Either we use the locally Euclidean character and define distributions on charts and glue them using the right compatibility data (see for example \cite{AMP1}) or we define them as the dual of the space of smooth functions (with compact support) as in the Euclidean case. In this section we follow the second approach.

    We will require our base manifold $M$ to be paracompact and second-countable. Moreover, we will also assume that we are given a Riemannian metric $g$ (see chapter \ref{chapter:riemann} for more information). This data allows us to turn the space of smooth sections of any tensor bundle over $M$ into a Fr\'echet space using a generalization of the seminorms \ref{distribution:D_seminorm} where we replace the (partial) derivatives $\partial^i$ by covariant derivatives $\nabla^i$ ($\nabla$ is the Levi-Civita connection induced by $g$). The norm will now also be the one induced (fibrewise) by $g$. In a similar way we can for every compact subset $K\subset M$ define the space $\mathcal{D}(K, \otimes^p)$ of smooth $p$-tensor fields with support in $K$ and by taking the direct limit (with its associated topology) we obtain the space of smooth compactly supported $p$-tensor fields $\mathcal{D}(M, \otimes^p)$.

    \newdef{Tensor distribution}{\index{distribution!tensor}
        The space of tensor distributions (of order $p$) is defined as the continuous dual of $\mathcal{D}(M, \otimes^p)$.
    }

    Much of the theory of distributions on Euclidean space can be generalized to smooth manifolds without too much trouble (for example we again obtain a dense inclusion $\mathcal{D}\hookrightarrow\mathcal{D}'$). An interesting generalization is the definition of the covariant derivative:
    \newdef{Covariant derivative}{\index{covariant!derivative}
        Let $(M, g)$ be a Riemannian manifold with associated Levi-Civita connection $\nabla$. The covariant derivative of a tensor distribution $T$ is defined using duality as follows (as in the case of Euclidean space this can be interpreted as an extension of the integration by parts formula):
        \begin{gather}
            \langle \nabla T, \sigma\rangle := -\langle T, g\cdot\nabla\sigma\rangle
        \end{gather}
        where $g\cdot\nabla\sigma$ denotes the internal contraction (generalizing the divergence of a vector field) which, in local coordinates, is given by
        \begin{gather}
            (g\cdot\nabla\sigma)^{i_1\ldots i_p} = \nabla_j\sigma^{ji_1\ldots i_p}.
        \end{gather}
    }

    ?? COMPLETE? ??
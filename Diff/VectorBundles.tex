\chapter{Vector Bundles}\label{chapter:vector_bundles}

    An additional reference for this chapter is \cite{bott_tu}.

\section{Tangent bundle}

    The tangent space, as introduced in subsection \ref{diff:section:tangent_space}, can also be introduced in a more topological way. Because it will be the most important example of a vector bundle, we will introduce it first:
    \begin{construct}[Tangent bundle]\index{tangent!bundle}
        Let $M$ be an $n$-dimensional manifold with atlas $\{(U_i, \varphi_i)\}_{i\leq n}$. Construct for every open set $O$ an associated set $TO := O\times\mathbb{R}^n$ and construct for every smooth function $f$ an associated smooth function on $TO$, called the \textbf{differential} or \textbf{derivative} of $f$, by
        \begin{gather}
            \label{diff:manifolds:T_function}
            Tf:O\times\mathbb{R}^n\rightarrow f(O)\times\mathbb{R}^n:(p,v)\mapsto(f(p),Df(p)v)
        \end{gather}
        where $Df(p):\mathbb{R}^n\rightarrow\mathbb{R}^n$ is the linear operator represented by the Jacobian matrix of $f$ at $p$.

        By applying this definition to the transition functions $\psi_{ji}$ we obtain a new set of functions \[\widetilde{\psi}_{ji} \equiv T\psi_{ji}:U_i\times\mathbb{R}^n\rightarrow U_j\times\mathbb{R}^n\] given by
        \begin{gather}
            \widetilde{\psi}_{ji}(\varphi_i(p),v) = \left(\varphi_j(p),D(\varphi_j\circ\varphi_i^{-1})(\varphi_i(p))v\right).
        \end{gather}
        Because the transition functions are diffeomorphisms, the Jacobians are invertible. This implies that the maps $\widetilde\psi_{ji}$ are elements of $\text{GL}(\mathbb{R}^n)$. The tangent bundle is now obtained by applying the fibre bundle construction theorem \ref{manifolds:theorem:fibre_bundle_construction_theorem} to the triple $(M, \mathbb{R}^n,\text{GL}(\mathbb{R}^n))$ together with the cover $\{U_i\}_{i\leq n}$ and the cocycle $\{\widetilde\psi_{ji}\}_{i,j\leq n}$.
    \end{construct}

    \newdef{Natural chart}{\index{natural!chart}\index{adapted!chart|see{natural chart}}
        The charts in the atlas on this bundle are sometimes called \textbf{natural charts} or \textbf{adapted charts}, because the first $n$ coordinates are equal to the coordinates on the base space.
    }

    \newdef{Tangent space}{\index{tangent!space}
        Consider a point $p\in M$. The definition of the tangent space in the above setting is given by the fibre
        \begin{gather}
            T_pM := \pi_{TM}^{-1}(p).
        \end{gather}
        If we use the natural charts to map $T_pM$ to the set $\varphi_i(p)\times\mathbb{R}^n$, we see that $T_M$ is isomorphic to $\mathbb{R}^n$. Furthermore, we can equip every fibre with the following vector space structure:
        \begin{align*}
            (p, v_1)+(p, v_2)&:=(p, v_1 + v_2)\\
            r(p, v)&:=(p, rv).
        \end{align*}
    }

    \begin{adefinition}
        The above construction eventually comes down to the following, more intuitive, definition of the tangent bundle (where one starts from the tangent spaces as introduced in chapter \ref{chapter:manifolds}):
        \begin{gather}
            TM := \bigsqcup_{p\in M}T_pM
        \end{gather}
        equipped with the disjoint union topology \ref{topology:disjoint_union} and the projection map\footnote{The map $\pi$ is single-valued because the tangent bundle is defined as the disjoint union of the tangent spaces.}
        \begin{gather}
            \pi:TM\rightarrow M:(p, X)\mapsto p
        \end{gather}
        where $X$ is a tangent vector in $T_pM$. An atlas on $TM$ is then given by the charts $(\pi^{-1}(U_i), \theta)$ with
        \begin{gather}
            \theta:TM\rightarrow\mathbb{R}^{2n}:(p, X)\mapsto(\varphi_i(p),X^1,\ldots,X^n)
        \end{gather}
        where $(U_i, \varphi_i)$ is a chart on $M$ covering the point $p\in M$ with local coordinates $(x^1,\ldots,x^n)$ such that $X$ can be expressed as $X^i\left.\pderiv{}{x^i}\right|_p\in T_pM$.
    \end{adefinition}

    \begin{property}[Dimension]
        Let $M$ be an $n$-dimensional manifold. Using the natural charts on $TM$ and the charts on $M$, which give a local homeomorphism \[\psi_i:TM\rightarrow U_i\times\mathbb{R}^n\xrightarrow{\varphi}\mathbb{R}^n\times\mathbb{R}^n,\] we can see that $TM$ is locally isomorphic to $\mathbb{R}^{2n}$. This implies that:
        \begin{gather}
            \dim TM = 2\dim M.
        \end{gather}
    \end{property}

    \begin{remark}
        Now it is clear that the rule "\textit{a vector is something that transforms like a vector}", which one often hears in introductory physics courses, comes from the fact that \[\text{a vector }v\in T_pM\text{ is tangent to }\varphi_i(p)\text{ in a chart }(U_i, \varphi_i)\] if and only if \[D(\varphi_j\circ\varphi_i^{-1})(\varphi_i(p))v\text{ is tangent to }\varphi_j(p)\text{ in a chart }(U_j, \varphi_j).\]
    \end{remark}

    \newdef{Differential}{\index{differential}\label{manifolds:differential}
        The map $T$ defined in equation \ref{diff:manifolds:T_function} can be generalized to arbitrary smooth manifolds as the map $Tf:TM\rightarrow TN$, where the Jacobian now acts on the (linear) fibres. Furthermore, let $p\in U\subseteq M$ and let $V = f(U)$. By looking at the restriction of $Tf$ to $T_pM$, denoted by $T_pf$, we see that it maps $T_pU$ to $T_{f(p)}V$ linearly.
    }

    \begin{property}
        The map $Tf:TM\rightarrow TN$ has the following properties\footnote{This turns the map $T$ into an endofunctor on the category of smooth manifolds. Hence we can view $T$ as a ''functorial derivative''.}:
        \begin{itemize}
            \item $T$ preserves identities: $T(\mathbbm{1}_M) = \mathbbm{1}_{TM}$.
            \item Let $f, g$ be two smooth functions on smooth manifolds, then $T(f\circ g) = Tf\circ Tg$.
        \end{itemize}
    \end{property}

    \newdef{Rank}{\index{rank}
        \label{manifolds:rank}
        Let $f:M\rightarrow N$ be a differentiable map between smooth manifolds. Using the fact that $Tf$ is a linear map on fibres, we define the rank of $f$ at $p\in M$ as the rank (in the sense of \ref{linalgebra:image_rank}) of the differential $Tf:T_pM\rightarrow T_{f(p)}N$.
    }

    \begin{theorem}[Inverse function theorem]\index{inverse function theorem}\label{manifolds:theorem:inverse_function_theorem}
        A $C^\infty$-map $f:M\rightarrow N$ between smooth manifolds is a local homeomorphism (resp. local diffeomorphism) if and only if its differential $Tf:T_pM\rightarrow T_pN$ is an isomorphism (resp. diffeomorphism) at $p$.
    \end{theorem}

    \newdef{Parallelizable manifold}{\index{parallelizable}
        A manifold is said to be parallelizable if its tangent bundle is trivial.
    }

\section{Vector bundles}

    Instead of restricting ourselves by taking the typical fibre to be a Euclidean space with the same dimension as the base manifold, we can generalize the construction of the tangent bundle in the following way:
    \begin{construct}[Vector bundle]\index{vector!bundle}\label{manifolds:vector_bundle_construction}
        \nomenclature[S_Vect]{$\textbf{Vect}(X)$}{Category of vector bundles over a topological space $X$.}
        Consider a smooth $n$-dimensional manifold $M$ with atlas $\{(U_i, \varphi_i)\}_{i\leq n}$ together with a cocycle $\{g_{ji}: U_i\cap U_j\rightarrow G\}_{i,j\leq n}$ with values in a Lie group $G$ and a smooth representation $\rho:G\rightarrow GL(V)$ on a (finite-dimensional) vector space $V$. A bundle can then be constructed using construction \ref{manifolds:theorem:fibre_bundle_construction_theorem}
    \end{construct}

    \begin{remark}
        As is also the case for tangent bundles, the choice of charts on $E$ is not random. To preserve the structure of fibres, the use of the natural charts is imperative.
    \end{remark}

    \begin{example}[Line bundle]\index{line!bundle}\index{wave!function}
        A line bundle is a vector bundle with a one-dimensional fibre $V$. A common example is the $\mathbb{C}$-line bundle over some manifold. In quantum mechanics, the sections of this bundle correspond to the wave functions describing a given system. (See section \ref{section:geometric_quantization} on geometric quantization for more information.)
    \end{example}

\subsection{Whitney sums}

    \newdef{Whitney sum}{\index{Whitney!sum}\index{direct!sum}
        Consider two vector bundles $E, E'$ with fibres $W, W'$ respectively over the same base manifold. Then we can construct a new vector bundle $E\oplus E'$ by taking the new typical fibre to be the direct sum $W\oplus W'$, i.e. the fibre above b is given by $W_b\oplus W_b'$.  This operation is called the Whitney sum or \textbf{direct sum} of vector bundles.
    }

    Property \ref{linalgebra:complement} from linear algebra can be generalized in the following way:
    \begin{property}
        Let $X$ be a paracompact Hausdorff space and let $E$ be a vector bundle over $X$. Every vector subbundle $F$ of $E$ admits an orthogonal complement $F^\perp$ such that $F\oplus F^\perp \cong E$.
    \end{property}
    \begin{property}\label{bundles:prop:hausdorff}
        Let $X$ be a compact Hausdorff space. Every vector bundle $E$ over $X$ admits a complementary vector bundle $E^c$ such that $E\oplus E^c \cong X\times\mathbb{R}^n$ for some $n\in\mathbb{N}$.
    \end{property}

    \newdef{Stable isomorphism}{\index{stable!isomorphism}\label{bundle:stable_isomorphism}
        Two vector bundles $E, E'$ over a base space $B$ are said to be stably isomorphic if there exist integers $m,n\in\mathbb{N}$ such that $E \oplus (B\times\mathbb{R}^m)\cong E' \oplus (B\times\mathbb{R}^n)$.
    }

\subsection{Associated vector bundles}

    \newdef{Associated vector bundle}{\index{associated!vector bundle}\label{manifolds:associated_vector_bundle}
        Consider a general representation\newline $\rho:\text{GL}(\mathbb{R}^n)\rightarrow\text{GL}(\mathbb{R}^l)$ together with the cocycle $\{t_{ji} := D(\psi_{ji})\circ\varphi_i\}_{i,j\leq n}$ as defined for the tangent bundle. The composition \[\rho\circ t_{ji}:U_i\cap U_j\xrightarrow{t_{ji}} \text{GL}(\mathbb{R}^n)\xrightarrow{\rho}\text{GL}(\mathbb{R}^l)\] is again a cocycle and can thus be used to define a new vector bundle on $M$ through the construction \ref{manifolds:theorem:fibre_bundle_construction_theorem}. The vector bundle $E = \rho(TM)$ so obtained is called the associated bundle of the tangent bundle induced by $\rho$.
    }

    \begin{example}[Contravariant vectors]\index{contravariant}
        By noting that the $k^{th}$ tensor power $\otimes^k$ induces a representation given by the tensor product of the representations, we can construct the bundle of order-$k$ (contravariant) tensors $\otimes^k(TM)$ using the cocycle given by $x\mapsto t_{ji}(p)\otimes\cdots\otimes t_{ji}(p)$.
    \end{example}
    \begin{example}[Cotangent bundle]\index{covariant}\index{covector}\label{manifolds:cotangent_bundle}
        Another useful construction is given by the contragredient representation $A\mapsto (\rho^T)^{-1}=(\rho^{-1})^T$. The vector bundle constructed this way, where the cocycle is given by $(t_{ji}^T)^{-1}$, is called the cotangent bundle on $M$ and is denoted by $T^*M$. Elements of the fibres are called \textbf{covariant vectors} or \textbf{covectors}.
    \end{example}
    \begin{notation}
        A combination of the cocycle $t_{ji}$ and its dual $(t_{ji}^T)^{-1}$ can also be used to define the bundle of $(k, l)$-tensors on $M$. This bundle is denoted by $T^{(k, l)}M$.
    \end{notation}

    \begin{example}[Pseudovectors]\index{pseudo!vector}
        If we consider the representation
        \begin{gather}
            \rho:A\mapsto \sgn\det(A)A
        \end{gather}
        we can construct a bundle similar to the tangent bundle, where the sign of the cocycle functions $t_{ji}$ now has an influence on the fibres. Elements of these fibres are called \textbf{pseudovectors}.
    \end{example}
    \begin{example}[Tensor density]\index{tensor!density}
        Tensor $s$-densities are obtained by using the representation
        \begin{gather}
            \rho:A\mapsto \det(A)^sA
        \end{gather}
        The number $s$ is called the \textbf{weight} of the densities. Pseudotensor densities are obtained by combining the above two representations.
    \end{example}

    More generally we can define the following notion:
    \begin{construct}[Determinant line bundle]\index{bundle!determinant}\index{determinant!line bundle|see{determinant bundle}}
        Consider a vector bundle $E\rightarrow M$ and let $n$ be the dimension of the typical fibre of $E$. The determinant map induces an associated line bundle $\bigwedge^nE\rightarrow M$ where the transition functions on the fibres are given by the determinant of the transition functions of $E$.
    \end{construct}

    \begin{remark}[Densities]
        Now one should pay incredible attention to the definition of a \textbf{density} (without the prefix ''tensor''). This is defined as a section of the associated bundle with transition function $|\det(A)|$, i.e. one adds the absolute value signs to the transition functions of the determinant line bundle (of $T^*M$). It gets even worse since some people define densities using the transition function $|\det(A)|^{-1}$, i.e. they add a power of $-1$. This last definition, however, does coincide with the natural one: A volume element, i.e. a section of the top exterior power of $T^*M$, transforms by a factor of the Jacobian determinant (on an oriented manifold\footnote{For non-orientable manifolds one should replace the volume form $dx^1\wedge\cdots\wedge dx^n$ by the (oriented) volume \textit{element} (mind the different terminology) $|dx^1\wedge\cdots\wedge dx^n|$ which transforms by a factor $|\det(J)|$.}) and hence a genuine density, which multiplied by a volume gives a scalar, should transform by the inverse factor to give an invariant result.
    \end{remark}

    \begin{example}[Canonical bundle]\index{bundle!canonical}
        Consider a smooth manifold $M$ of dimension $n$. The canonical (line) bundle of $M$ is given by $\bigwedge^nT^*M$, i.e. the determinant line bundle of the cotangent bundle of $M$.
    \end{example}

\subsection{Grassmann bundle}

    Looking at property \ref{linalgebra:grassmannian_construction} and noting that GL$_n(\mathbb{R})$ is a Lie group, we can endow the Grassmannian Gr$(k, \mathbb{R}^n)$ \ref{linalgebra:grassmannian} with a differentiable structure, turning it into a smooth manifold. This allows us to construct a new bundle\footnote{Due to the fact that the Grassmannian is not a vector space, this will be a general fibre bundle and not a vector bundle.} by applying the usual construction theorem \ref{manifolds:theorem:fibre_bundle_construction_theorem}:

    \begin{construct}[Grassmann bundle]\index{Grassmann!bundle}\label{manifolds:grassmann_bundle}
        We first define a new set of transition functions:
        \begin{gather}
            \begin{aligned}
                \psi_{ji}&:\varphi_i(U_i\cap U_j)\times \text{Gr}(k, \mathbb{R}^n) \rightarrow \varphi_j(U_i\cap U_j)\times \text{Gr}(k, \mathbb{R}^n)\\
                &:(\varphi_i(p), V)\mapsto(\varphi_j(p), t_{ji}(p)\cdot V)
            \end{aligned}
        \end{gather}
        where $\{t_{ji}\}_{i, j\leq n}$ is the tangent bundle cocycle, but now with an action on the compact manifold Gr$(k, \mathbb{R}^n)$ instead of the vector space $\mathbb{R}^n$. These transition functions can then be used to create a new fibre bundle with typical fibre Gr$(k, \mathbb{R}^n)$. The fibre over a point $p\in M$ is the Grassmannian Gr$(k, T_pM)$ associated to the tangent space over $p$.
    \end{construct}
    \begin{notation}
        The Grassmann $k$-plane bundle is denoted by Gr$(k, TM)$.
    \end{notation}

    \newdef{Tautological bundle}{\index{tautological!bundle}
        Consider the Grassmannian Gr$(k, V)$ of an $(n+k)$-dimensional vector space $V$. The total space of the tautological $k$-bundle $\gamma_{n, k}$ is defined as the set of points $(W, w)$ where $W\in\text{Gr}(k, V)$ and $w\in W$. Local trivializations are constructed as follows:
        \begin{gather}
            \varphi:\pi^{-1}(U)\rightarrow \text{Gr}(k, V)\times Z: (W, w)\mapsto (W, \text{proj}_Z(w))
        \end{gather}
        where $\text{proj}_Z$ is the orthogonal projection\footnote{See definition \ref{linalgebra:orthogonal_projection}.} onto $Z$.
    }

\subsection{Sections}

    \newdef{Frame}{\index{frame}\label{diff:frame}
        A frame of a vector bundle $E$ is a tuple $(s_1,\ldots,s_n)$ of smooth sections such that $(s_1(b),\ldots,s_n(b))$ is a basis for the fibre $\pi^{-1}(b)$ for all $b\in B$.
    }
    \begin{property}\label{diff:prop:trivial_vector_bundle}
        A vector bundle is trivial if and only if there exists a frame of global sections.
    \end{property}

    \begin{theorem}[Serre \& Swan]\index{Serre-Swan}
        The set of all smooth sections $\Gamma(E)$ of a vector bundle $E$ with base space $M$ is a finitely generated projective $C^\infty(M)$-module.
    \end{theorem}

\section{Vector fields}

    \newdef{Vector field}{\index{vector field}
        A smooth section $s\in\Gamma(TM)$ of the tangent bundle is called a vector field. The set of vector fields forms a $C^\infty(M)$-module.
    }
    \begin{notation}
        \nomenclature[S_zsymXM]{$\mathfrak{X}(M)$}{$C^\infty(M)$-module of vector fields on the manifold $M$.}
        The set of all vector fields on a manifold $M$ is often denoted by $\mathfrak{X}(M)$.
    \end{notation}

    \begin{theorem}[Hairy ball theorem]\index{hairy ball theorem}
        There exists no nowhere vanishing vector field on an even-dimensional sphere $S^{2n}$.
    \end{theorem}

    \newdef{Pullback}{\index{pullback}
        Let $X$ be vector field on $M$ and let $\varphi:M\rightarrow N$ be a diffeomorphism between smooth manifolds. The pullback of $X$ along $\varphi$ is defined as
        \begin{gather}
            \label{manifolds:pullback}
            (\varphi^*X)_p := T\varphi^{-1}(X_{\varphi(p)}).
        \end{gather}
    }
    \newdef{Pushforward}{\index{pushforward}
        Let $X$ be a vector field on $M$ and let $\varphi:M\rightarrow N$ be a diffeomorphism between smooth manifolds. Using the differential $T\varphi$ we can define the pushforward of $X$ along $\varphi$ as
        \begin{gather}
            \label{manifolds:pushforward}
            (\varphi_*X)_{\varphi(p)} := T\varphi(X_p).
        \end{gather}
        We can rewrite this using the pullback as follows:
        \begin{gather}
            \label{manifolds:pullback_pushforward}
            \varphi_*X = \varphi^{-1*}X.
        \end{gather}
        Equivalently, we can define a vector field on $N$ by
        \begin{gather}
            (\varphi_*X)_q(f) := X_{\varphi^{-1}(q)}(f\circ\varphi)
        \end{gather}
        for all smooth functions $f:N\rightarrow\mathbb{R}$ and points $q\in N$.
    }

\subsection{Integral curves}

    \newdef{Integral curve}{\index{integral!curve}
        Let $X\in\mathfrak{X}(M)$ and let $\gamma:\ ]a, b[\rightarrow M$ be a smooth curve on $M$. $\gamma$ is said to be an integral curve of $X$ if
        \begin{gather}
            \label{manifolds:integral_curve}
            \gamma'(t) = X(\gamma(t))
        \end{gather}
        for all $t\in]a,b[$ where we defined $\gamma'(t) := T\gamma(t, 1)$.

        This equation can be seen as a system of ordinary differential equations. Using the Picard-Lindelo\"of existence theorem together with the initial value condition $\gamma(0) = p$ we can find a unique curve on $]a, b[$ satisfying the defining equation \ref{manifolds:integral_curve}. Furthermore, we can extend the interval $]a, b[$ to a maximal interval such that the solution is still unique. This solution, denoted by $\gamma_p$, is called the \textbf{integral curve of $X$ through $p$}.
    }

    \newdef{Flow}{\index{flow}\label{manifolds:flow}
        Let $X\in\mathfrak{X}(M)$ and consider its associated integral curve $\gamma_p$ through a point $p\in M$. The function $\sigma_t$, defined by
        \begin{gather}
            \sigma_t(p) := \gamma_p(t),
        \end{gather}
        is called the flow of $X$ at time $t$. The \textbf{flow domain} is defined as the set
        \begin{gather}
            D(X) := \big\{(t, p)\in\mathbb{R}\times M:p\in M, t\in\ ]a_p, b_p[\big\}
        \end{gather}
        where $]a_p, b_p[$ is the maximal interval on which $\gamma_p(t)$ is defined.
    }
    \begin{property}
        Suppose that $D(X) = \mathbb{R}\times M$. The flow $\sigma_t$ has the following properties for all $s, t\in\mathbb{R}$:
        \begin{itemize}
            \item $\sigma_0 = \mathbbm{1}_M$
            \item $\sigma_{s+t} = \sigma_s\circ\sigma_t$
            \item $\sigma_{-t} = (\sigma_t)^{-1}$
        \end{itemize}
        These three properties\footnote{The third property follows from the other two.}\ say that $\sigma_t$ is a bijective group action of the additive group of real numbers on $M$. This implies that $\sigma_t$ is indeed a \textbf{flow} in the general mathematical sense.
    \end{property}

    \newdef{Complete vector field}{\index{complete!vector field}\label{manifold:complete_vector_field}
        A vector field $X$ is called complete if the flow domain for every flow is all of $\mathbb{R}\times M$.
    }

    \begin{property}
        The flow $\sigma_t$ of a vector field is of class $C^\infty$. If $X$ is complete it follows from previous definition that every flow is a diffeomorphism from $M$ onto itself.
    \end{property}

    \begin{property}
        If the manifold $M$ is compact then every vector field $X\in\mathfrak{X}(M)$ is complete.
    \end{property}

\subsection{Lie derivative}

    \newformula{Lie derivative for smooth functions}{\index{Lie!derivative}
        Let $X\in\mathfrak{X}(M)$ and let $f\in C^\infty(M)$. The Lie derivative of $f$ with respect to $X$ at $p\in M$ is defined as
        \begin{gather}
            \label{manifolds:lie_derivative_functions}
            \mathcal{L}_Xf(p) := \lim_{t\rightarrow0}\stylefrac{f(\gamma_p(t)) - f(p)}{t}.
        \end{gather}
        This closely resembles the definition of the ordinary derivative on Euclidean space.
    }

    \begin{formula}[$\dag$]\label{manifolds:ex:lie_derivative_function}
        Working out the previous formula and rewriting it as an operator equality gives
        \begin{gather}
            \label{manifolds:lie_derivative_function_expansion}
            \mathcal{L}_X = \sum_kX_k\pderiv{}{x^k}.
        \end{gather}
        It is clear that this is just the vector field $X$ expanded in the basis \ref{diff:manifolds:tangent_vector_partial}. We also recover the behaviour of a tangent vector as a derivation. So, for smooth functions $f:M\rightarrow\mathbb{R}$ we obtain
        \begin{gather}
            \mathcal{L}_Xf(p) = X_p(f).
        \end{gather}
    \end{formula}

    \newformula{Lie derivative for vector fields$^\dag$}{\label{manifolds:ex:lie_derivative_vector_fields}
        Let $X, Y\in\mathfrak{X}(M)$.
        \begin{gather}
            \label{manifolds:lie_derivative_vector_field}
            \mathcal{L}_XY(p) := \left.\deriv{}{t}(\sigma_t^*X)(\gamma_p(t))\right|_{t=0}.
        \end{gather}
    }
    \begin{property}\index{Lie!bracket}
        Let $X, Y\in\mathfrak{X}(M)$ be vector fields of class $C^k$. The Lie derivative has the following properties:
        \begin{itemize}
            \item $\mathcal{L}_XY$ is a vector field.
            \item \textbf{Lie bracket}: The Lie derivative of vector fields coincides with the commutator:
                \begin{gather}
                    \label{manifolds:lie_bracket}
                    \mathcal{L}_XY = [X, Y].
                \end{gather}
                The fact this is indeed a derivation on $C^{k-1}(M, \mathbb{R})$ follows because the second-order derivatives cancel in a local representation (see theorem \ref{calculus:schwarz_theorem}). It follows that the Lie derivative on vector fields turns the space $\mathfrak{X}(M)$ into a real Lie algebra.
            \item The Lie derivative is antisymmetric:
                \begin{gather}
                    \label{diff:lie_derivative_antisymmetry}
                    \mathcal{L}_XY = -\mathcal{L}_YX.
                \end{gather}
                This clearly follows from the previous item.
        \end{itemize}
    \end{property}

    \newdef{Holonomic basis}{\index{holonomic!basis}
        A basis $\{e_i\}_{i\leq\dim(M)}$ of $T_pM$ is said to be holonomic (on a neighbourhood $U\subseteq M$) if all the Lie derivatives vanish on $U$:
        \begin{gather}
            \mathcal{L}_{e_i}e_j = 0.
        \end{gather}
        Equivalently, a basis is holonomic if the associated structure coefficients of the Lie algebra $\mathfrak{X}(M)$ vanish on $U$.
    }
    \begin{property}
        For every holonomic basis there exists a coordinate system for $M$ such that the basis coincides with coordinate-induced basis.
    \end{property}

\subsection{Frobenius' theorem}

    \newdef{Distribution}{\index{distribution!of $k$-planes}\label{manifolds:distribution}
        A smooth section of the Grassmann $k$-plane bundle\footnote{See definition \ref{manifolds:grassmann_bundle}.} is called a distribution of $k$-planes.
    }

    \begin{definition}[Integrable]\index{integrable!manifold}
        Let $M$ be a smooth manifold and let $W\in\Gamma(\text{Gr}(k, TM))$ be a distribution of $k$-planes. A submanifold $N\subseteq M$ is said to integrate $W$ with initial condition $p_0\in M$ if for every $p\in N$ we find that $W(p) = T_pN$ and $p_0\in N$. $W$ is said to be integrable if there exists such a submanifold $N$.
    \end{definition}

    \newdef{Frobenius' integrability condition}{
        A distribution $W$ over a smooth manifold $M$ is said to satisfy the Frobenius integrability condition on an open set $U\subseteq M$ if for every two vector fields $X, Y$ defined on $U$, such that $X(p)\in W(p)$ and $Y(p)\in W(p)$ for all $p\in U$, their Lie bracke $[X, Y](p)$ is also an element of $W(p)$ for all $p\in U$.
    }
    \begin{theorem}[Frobenius' integrability theorem]\index{Frobenius!integrability theorem}\label{manifolds:frobenius}
        Let $W$ be a distribution over a smooth manifold $M$. $W$ is integrable if and only if it satisfies the Frobenius integrability condition.
    \end{theorem}

\section{Differential \texorpdfstring{$k$}{k}-forms}\label{diff:section:forms}

    \newdef{Differential form}{\index{differential form}
        \nomenclature[S_zsymOmegak]{$\Omega^k(M)$}{$C^\infty(M)$-module of differential $k$-forms on the manifold $M$.}
        A differential $k$-form is a map
        \begin{gather}
            \omega: T^kM\rightarrow \mathbb{R}
        \end{gather}
        such that the restriction of $\omega$ to each fibre of the bundle $T^kM$ is multilinear and antisymmetric.

        The space of all differential $k$-forms on a manifold $M$ is denoted by $\Omega^k(M)$. Just like $\mathfrak{X}(M)$ it forms a $C^\infty(M)$-module. The set $\Omega^0(M)$ is defined as the space of smooth functions $C^\infty(M)$.
    }

    \begin{adefinition}
        An alternative definition goes as follows: Consider the representation \[\rho_k:\text{GL}(R^{m*})\rightarrow\text{GL}(\Lambda^k(\mathbb{R}^{m*})): T\mapsto T\wedge\cdots\wedge T.\] This representation induces an associated vector bundle\footnote{See definition \ref{manifolds:associated_vector_bundle}.} $\rho_k(\pi_{T^*M})$ of the cotangent bundle on $M$. A differential $k$-form is then given by a section of $\rho_k(\pi_{T^*M})$:
        \begin{gather}
            \Omega^k(M) := \Gamma(\rho_k(\pi_{T^*M})).
        \end{gather}
    \end{adefinition}

    \begin{construct}
        We can construct a Grassmann algebra\footnote{See also definition \ref{tensor:exterior_algebra}.} by equipping the graded vector space
        \begin{gather}
            \Omega(M) = \bigoplus_{k\geq0}\Omega^k(M)
        \end{gather}
        with the wedge product of differential forms (which is induced by the wedge product on $\Lambda^k(\mathbb{R}^m)$ through the alternative definition). This graded algebra is associative, graded-commutative and unital with the constant function $1\in C^{\infty}(M)$ as the identity element.
    \end{construct}

    \newdef{Pullback}{\index{pullback}
        Let $f:M\rightarrow N$ be a smooth function between smooth manifolds and let $\omega$ be a differential $k$-form on $N$. The pullback of $\omega$ by $f$ is defined as
        \begin{gather}
            \label{forms:pullback}
            f^*(\omega) = \omega\circ f_*:TM\rightarrow\mathbb{R}.
        \end{gather}
        So $f^*$ can be interpreted as a map pulling elements from $T^*N$ back to $T^*M$.
    }
    \newdef{Pushforward}{\index{pushforward}
        Let $f:M\rightarrow N$ be a diffeomorphism between smooth manifolds and let $\omega$ be a differential $k$-form on $M$. The pushforward $\omega$ by $f$ is defined as
        \begin{gather}
            \label{forms:pushforward}
            f_*(\omega): \omega\circ (f^{-1})_*: TN\rightarrow\mathbb{R}.
        \end{gather}
    }
    \begin{remark*}
        Note that the pushforward of differential $k$-forms is only defined for diffeomorphisms, in constrast to pullbacks which only require smooth functions. This also explains why differential forms are the most valuable elements in differential geomeotry. Vector fields cannot even be pulled back in general by smooth maps.
    \end{remark*}

    \newformula{Dual basis}{\index{basis}
        Consider the coordinate basis from definition \ref{diff:manifolds:tangent_vector_partial} for the tangent space $T_pM$. From this set we can construct\footnote{It should however be noted that $dx^i$ is not just a notation. These basis vectors are in fact constructed by applying the exterior derivative \ref{forms:def:exterior_derivative} to the coordinate maps $x^i$.} a natural dual basis for the cotangent space $T_p^*M$ using the natural pairing:
        \begin{gather}
            \label{forms:basis}
            \left\langle\pderiv{}{x^i}, dx^j\right\rangle = \delta_i^j.
        \end{gather}
    }

\subsection{Vector-valued differential forms}

    \newdef{Vector-valued form}{\index{differential form!vector-valued}
        Let $V$ be a vector space and $E$ a vector bundle with $V$ as typical fibre. A vector-valued differential form can be defined in two ways. First, we can define a vector-valued $k$-form as a map $\omega:\bigotimes^kTM\rightarrow V$. Secondly, a more general definition is based on sections of an associated tensor product bundle:
        \begin{gather}
            \Omega^k(M; E) := \Gamma(E\otimes\Lambda^kT^*M).
        \end{gather}
        The latter construction could also be called a ''vector bundle-valued differential form''.
    }

    \newformula{Wedge product}{\index{wedge!product}
        Let $\omega\in\Omega^k(M; E_1)$ and $\nu\in\Omega^p(M; E_2)$. The wedge product of these differential forms is defined as follows:
        \begin{gather}
            \label{forms:vector_valued_wedge}
            \omega\wedge\nu(v_1,\dots,v_{k+p}) := \stylefrac{1}{k!p!}\sum_{\sigma\in S_{k+p}}\sgn(\sigma)\omega(v_{\sigma(1)},\ldots, v_{\sigma(k)})\otimes\nu(v_{\sigma(k+1)},\ldots,v_{\sigma(p)}).
        \end{gather}
        This is a direct generalization of the formula for the wedge product of ordinary differential forms, where we replaced the scalar product (product in the algebra $\mathbb{R}$) by the tensor product (product in the tensor algebra). It should be noted that the result of this operation is not an element of any of the original bundles $E_1$ or $E_2$ but rather of the product bundle $E_1\otimes E_2$.
    }

    \newdef{Lie algebra-valued form}{\index{differential form!Lie algebra-valued}
        A vector-valued differential form where the vector space $V$ is equipped with a Lie algebra structure.
    }

    \newformula{Wedge product}{\index{wedge!product}
        Let $\omega\in\Omega^k(M; \mathfrak{g})$ and $\nu\in\Omega^p(M; \mathfrak{g})$. The wedge product of these differential forms is defined as follows:
        \begin{gather}
            \label{forms:lie_algebra_valued_wedge}
            [\omega\wedge\nu](v_1,\ldots,v_{k+p}) := \stylefrac{1}{k!p!}\sum_{\sigma\in S_{k+p}}\sgn(\sigma)[\omega(v_{\sigma(1)},\ldots, v_{\sigma(k)}),\nu(v_{\sigma(k+1)},\ldots,v_{\sigma(p)})]
        \end{gather}
        where $[\cdot, \cdot]$ is the Lie bracket on $\mathfrak{g}$.
    }

    \begin{formula}
        Let $\{e_a\}$ be a basis for the Lie algebra $\mathfrak{g}$. We can write the Lie algebra-valued differential forms as follows: $\phi = \phi^\mu \otimes e_\mu$ and $\psi = \psi^\nu \otimes e_\nu$, where $\phi^\mu$ and $\psi^\nu$ are ordinary differential forms. The above formula for their wedge product can now be rewritten more elegantly as
        \begin{gather}
            [\phi\wedge\psi] = (\phi^\mu\wedge\psi^\nu)\otimes[e_\mu, e_\nu]
        \end{gather}
        where $\wedge$ is the wedge product on $\Omega(M)$ and $[\cdot, \cdot]$ is the Lie bracket on $\mathfrak{g}$.
    \end{formula}
    \begin{result}\index{Jacobi!identity}\index{graded!commutativity}
        Using this formula it is easy to verify a number of properties similar to the ones of ordinary differential forms. As an example we give the analogue of the graded-commutativity property on $\Omega(M)$:
        \begin{gather}
            [\phi\wedge\psi] = (-1)^{pq+1}[\psi\wedge\phi]
        \end{gather}
        where $\phi\in\Omega^p(M; \mathfrak{g})$ and $\psi\in\Omega^q(M; \mathfrak{g})$. Here the extra factor $-1$ arises due to the antisymmetry of the Lie bracket.

        Analogously, one can prove that the Lie algebra-valued wedge product satisfies a graded Jacobi-type identity:
        \begin{gather}
            (-1)^{pr}[\phi\wedge[\psi\wedge\theta]] + (-1)^{pq}[\psi\wedge[\theta\wedge\phi]] + (-1)^{qr}[\theta\wedge[\phi\wedge\psi]] = 0
        \end{gather}
        where $\theta\in\Omega^r(M; \mathfrak{g})$.
    \end{result}

\subsection{Exterior derivative}

    \newdef{Exterior derivative}{\index{exterior!derivative}\index{differential}\label{forms:def:exterior_derivative}
        The exterior derivative $d_k$ is a map defined on the graded algebra of differential $k$-forms:
        \begin{gather}
            d_k:\Omega^k(M)\rightarrow\Omega^{k+1}(M).
        \end{gather}
        For $k=0$ it is given by\footnote{For $f\in\Omega^0(M)$, we call $df$ the \textbf{differential} of $f$.}
        \begin{gather}
            \label{forms:function_derivative}
            df := \sum_{i=1}^n\pderiv{f}{x_i}dx_i
        \end{gather}
        This formula can be generalized to higher dimensions as follows:
        \begin{gather}
            \label{forms:exterior_derivative}
            d(fdx_{i_1}\wedge\cdots\wedge dx_{i_k}) := df\wedge dx_{i_1}\wedge\cdots\wedge dx_{i_k}.
        \end{gather}
    }
    \remark{Formula \ref{forms:function_derivative} should be compared with the (informal) formula for the differential of a function, which is often used in physics courses. The main difference is that here the quantities $dx^i$ are not infinitesimal quantities but vectors of unit norm.}

    \begin{property}\index{Leibniz!rule}\label{forms:exterior_derivative_properties}
        The exterior derivatives have the following properties:
        \begin{itemize}
            \item For all $k\geq 0$ and for all $\omega\in\Omega^k(M)$: $d_k\circ d_{k+1} = 0$ and thus $\text{im}(d_k)\subseteq\text{ker}(d_{k+1})$.
            \item $d_k$ is an $\mathbb{R}$-linear map for all $k\in\mathbb{N}$.
        \end{itemize}
        These two points say that $(\Omega^\bullet(M),d)$ is not just a graded algebra but in fact a dg-algebra (see definition \ref{linalgebra:dg_algebra}).
        \begin{itemize}
            \item \textbf{Graded Leibniz rule} (hence $d$ is a graded derivation):
                \begin{gather}
                    d(\omega_1\wedge\omega_2) = d\omega_1\wedge\omega_2 + (-1)^j\omega_1\wedge d\omega_2
                \end{gather}
                where $\omega_1\in\Omega^j(M)$ and $\omega_2\in\Omega^k(M)$.
            \item Commutes with pullback: If $f\in C^\infty(M)$ then $f^*(d\omega) = d(f^*\omega)$.
        \end{itemize}
    \end{property}

    \begin{remark}[$\dag$]\index{gradient}\index{rotor}\index{divergence}\label{forms:vector_calculus}
        The gradient, rotor (curl) and divergence from standard vector calculus\footnote{See section \ref{vectorcalculus:nabla}.} can be rewritten using exterior derivatives as follows: Let $\mathbf{f} = (f_1, f_2, f_3)$ with $f_i$ smooth for every $i$ and let $f$ be a smooth function. Denote the canonical isomorphism between $\mathbb{R}^3$ and $\mathbb{R}^{3*}$ by $\sim$.
        \begin{align}
            \sim df &= \nabla f \\
            \sim (\ast d\alpha) &= \nabla\times\mathbf{f} \\
            \ast d\omega &= \nabla\cdot\mathbf{f}
        \end{align}
        The properties in section \ref{vectorcalculus:mixed_properties} now follow from the identity $d^2 = 0$.
    \end{remark}

    \begin{example}
        Let $f\in C^\infty(M, \mathbb{R})$ and let $\gamma$ be a curve on $M$. From the definition \ref{forms:basis} of the basis $\{dx_k\}_{k\leq n}$ we obtain following result:
        \begin{gather}
            \langle df(x), \gamma'(t) \rangle = \sum_k \pderiv{f}{x_k}(x)\gamma_k'(t) = (f\circ\gamma')(t).
        \end{gather}
    \end{example}

    \begin{example}
        An explicit formula for the exterior derivative of a k-form $\Phi$ is
        \begin{align}
            d\Phi(X_1,\ldots, X_{k+1}) = \sum_{i=0}^{k+1} &(-1)^{i+1} X_i(\Phi(X_1,\ldots, \hat{X}_i,\ldots, X_{k+1}))\nonumber\\
            \label{forms:k_form_exterior_derivative}
            &+\sum_{i<j} (-1)^{i+j}\Phi([X_i, X_j], X_1,\ldots, \hat{X}_i,\ldots, \hat{X}_j,\ldots, X_{k+1})
        \end{align}
        where $\hat{X}$ means that this argument is omitted.
    \end{example}

\subsection{Lie derivative}

    \newformula{Lie derivative of differential forms}{\index{Lie!derivative}
        \begin{gather}
            \label{manifolds:lie_derivative_forms}
            \mathcal{L}_X\omega(p) := \lim_{t\rightarrow0}\stylefrac{\sigma_t^*\omega - \omega}{t}(p)
        \end{gather}
    }

    \begin{formula}[Lie derivative of smooth functions]
        Using the definition of the exterior derivative of smooth functions \ref{forms:function_derivative} and the definition of the dual basis \ref{forms:basis} we can rewrite the Lie derivative \ref{manifolds:lie_derivative_function_expansion} as
        \begin{gather}
            Xf(p) = df_p(X(p)).
        \end{gather}
    \end{formula}

    \begin{property}
        The Lie derivative has the following Leibniz-type property with respect to differential forms (this also follows from equations \ref{forms:k_form_exterior_derivative} and \ref{manifolds:lie_bracket}):
        \begin{gather}
            \mathcal{L}_X(\omega (Y)) = (\mathcal{L}_X\omega)(Y) + \omega(\mathcal{L}_XY)
        \end{gather}
        where $X, Y$ are two vector fields and $\omega$ is a 1-form.
    \end{property}

\subsection{Interior product}

    \newdef{Interior product}{\index{interior!product}
        Aside from the differential (exterior derivative) we can also define another operation on the algebra of differential forms:
        \begin{gather}
            \label{forms:interior_derivative}
            \iota_X:(\iota_X\omega)(v_1,\ldots, v_{k-1})\mapsto\omega(X, v_1,\ldots, v_{k-1}).
        \end{gather}
        This antiderivation (of degree $-1$) from $\Omega^k(M)$ to $\Omega^{k-1}(M)$ is called the \textbf{interior product} or \textbf{interior derivative}. This can be seen as a generalization of the contraction map \ref{tensor:contraction}.
    }

    \newformula{Cartan's magic formula\footnotemark}{\index{Cartan!magic formula}
        \footnotetext{Sometimes called \textbf{Cartan's (infinitesimal) homotopy formula}.}
        Let $X$ be a vector field and let $\omega$ be a differential $k$-form. The Lie derivative of $\omega$ along $X$ is given by the following formula:
        \begin{gather}
            \label{forms:cartan_magic_formula}
            \mathcal{L}_X\omega = \iota_X(d\omega) + d(\iota_X\omega).
        \end{gather}
    }

\subsection{Lie derivative of tensor fields}

    \newformula{Lie derivative of tensor fields}{
        By comparing the definitions of the Lie derivatives of vector fields \ref{manifolds:lie_derivative_vector_field} and differential forms \ref{manifolds:lie_derivative_forms}, we can see that both definitions are identical upon replacing $X$ by $\omega$. This leads to the following definition of a Lie derivative of a general tensor field $\mathcal{T}\in\Gamma(T^{(k, l)}M)$:
        \begin{gather}
            \mathcal{L}_X\mathcal{T}(p) := \left.\deriv{}{t}\sigma_t^*\mathcal{T}(\gamma_p(t))\right|_{t=0}.
        \end{gather}
    }

    \newadef{Lie derivative of tensor fields}{
        The Lie derivative of tensor fields can also be defined as the unique differential operator satisfying thr following axioms:
        \begin{enumerate}
            \item $\mathcal{L}_X$ coincides with $X$ on $C^\infty(M)$.
            \item $\mathcal{L}_X$ satisfies the Leibniz rule with respect to the tensor product.
            \item $\mathcal{L}_X$ satisfies the Leibniz rule with respect to the contraction of forms and vector fields.
            \item $\mathcal{L}_X$ commutes with the exterior derivative.
        \end{enumerate}
    }

    \begin{property}
        Every derivation $D$ of the tensor algebra can be decomposed as
        \begin{gather}
            D = \mathcal{L}_X + S
        \end{gather}
        for some vector field $X\in TM$ and some endomorphism $S\in T^{1,1}M$.
    \end{property}

\section{Cohomology}
\subsection{de Rham complex}

    \newdef{Exact form}{\index{exact}
        If $\omega\in\Omega^k(M)$ can be written as $\omega = d\chi$ for some $\chi\in\Omega^{k-1}(M)$, it is said to be exact. We can conclude that
        \begin{gather}
            \text{im}(d_k) = \{\omega\in\Omega^{k+1}(M):\omega\text{ is exact}.\}
        \end{gather}
    }
    \newdef{Closed form}{\index{closed}
        Let $\omega\in\Omega^k(M)$. If $d\omega = 0$, it is said to be closed. We can conclude that
        \begin{gather}
            \{\omega\in\Omega^k(M):\omega\text{ is closed}\}\subseteq\text{ker}(d_k).
        \end{gather}
    }

    \begin{remark}\label{forms:remark:closed_exact}
        From the first item of property \ref{forms:exterior_derivative_properties} it follows that every exact form is closed. The converse however is not true\footnote{See result \ref{forms:theorem:poincare} below for more information.}.
    \end{remark}

    \newdef{de Rham complex}{\index{de Rham!complex}
        The sequence
        \begin{gather}
            0\rightarrow\Omega^0(M)\rightarrow\Omega^1(M)\rightarrow\cdots\rightarrow\Omega^{\dim(M)}(M)\rightarrow0
        \end{gather}
        together with the sequence of exterior derivatives $d_k$ forms a cochain complex. This complex is called the de Rham complex.
    }

    The relation between closed and exact forms can be used to define the de Rham cohomology groups:
    \newdef{de Rham cohomology}{\index{de Rham!cohomology}
        The $k^{th}$ de Rham cohomology group on $M$ is defined as the following quotient space:
        \begin{gather}
            \label{forms:de_rham_cohomology}
            H^k_{\text{dr}}(M) := \frac{\text{ker}(d_k)}{\text{im}(d_{k-1})}.
        \end{gather}
        This quotient space is a vector space. Two elements of the same equivalence class in $H^k_{dr}(M)$ are said to be \textbf{cohomologous}.
    }

    \newdef{Integral form}{\label{diff:integral_form}\index{integral!form}
        A differential $k$-form $\omega$ is said to be integral if it lies in the image of the inclusion $H^k(M, \mathbb{Z})\hookrightarrow H^k(M, \mathbb{R})$. Equivalently a differential $k$-form is integral if integrating\footnote{See chapter \ref{chapter:integration_manifolds}.} it over any $k$-cycle with integral coefficients gives an integer.
    }

    \newformula{Cup product}{\index{cup product}\label{forms:cup_product}
        Let $[\nu]\in H^k_{\text{dr}}$ and $[\omega]\in H^l_{\text{dr}}$. The cup product on de Rham cohomology is given by
        \begin{gather}
            [\nu]\smile[\omega] := [\nu\wedge\omega].
        \end{gather}
    }

    \begin{theorem}[de Rham]\index{de Rham}
        The de Rham cohomology over a smooth manifold $M$ is isomorphic to the singular cohomology\footnote{See section \ref{section:singular_homology}.} over $M$.
    \end{theorem}

    \begin{theorem}[Poincar\'e lemma\footnotemark]\index{Poincar\'e}\label{forms:theorem:poincare}
        \footnotetext{The original theorem states that on a contractible space (see definition \ref{topology:contractible_space}) every closed form is exact.}
         For every point $p\in M$ there exists a neighbourhood on which the de Rham cohomology is trivial:
        \begin{gather}
            \forall p\in M:\exists U\subseteq M: H^k_{\text{dr}}(U) = 0.
        \end{gather}
        This implies that every closed form is locally exact, i.e. if $d\omega=0$ at the point $p\in M$ then there exist a neighbourhood $x\in U\subseteq M$ and a differential form $\lambda$ such that
        \begin{gather}
            \omega = d\lambda
        \end{gather}
        at all points $p'\in U$. More generally, this lemma says that the following isomorphism exists for every smooth manifold $M$:
        \begin{gather}
            H^*_{\text{dr}}(M\times\mathbb{R}^n) \cong H^*_{\text{dr}}(M).
        \end{gather}
    \end{theorem}

\subsection{Cohomology with compact support}

    \begin{theorem}[Poincar\'e duality]\index{Poincar\'e!duality}
        Let $M$ be a smooth orientable $n$-dimensional manifold. The pairing $\int:H^k(M)\otimes H^{n-k}_c(M)\rightarrow\mathbb{R}$ induces an isomorphism on cohomology:
        \begin{gather}
            H^k(M)\cong\Big(H^{n-k}_c(M)\Big)^*.
        \end{gather}
        If $M$ is of finite type the converse also holds
        \begin{gather}
            H^k_c(M)\cong\Big(H^{n-k}(M)\Big)^*.
        \end{gather}
    \end{theorem}

    \newdef{Poincar\'e dual}{\index{dual!Poincar\'e|see{Poincar\'e duality}}
        Let $M$ be a smooth oriented $n$-dimensional manifold and let $i:S\rightarrow M$ be a closed\footnote{in the sense of topology} oriented $k$-dimensional submanifold. The Poincar\'e dual of $S$ in $M$ is the unique cohomology class $[\eta_S]\in H^{n-k}(M)$ such that
        \begin{gather}
            \int_Si^*\omega = \int_M\omega\wedge\eta_S
        \end{gather}
        for all compactly supported $\omega\in H^k_c(M)$.

        If $S$ is compact in $M$, two Poincar\'e duals exist:
        \begin{itemize}
            \item \textbf{Closed dual}: The Poincar\'e dual obtained by using the fact that $S$ is compact and hence closed in $M$.
            \item \textbf{Compact dual}: Because $S$ is compact, all forms $\omega\in H^k(M)$ (not only the compactly supported ones) can be integrated over $S$ and, assuming $M$ is of finite type, Poincar\'e duality implies that there exists a unique cohomology class with compact support $\eta_S'$ such that
            \begin{gather}
                \int_Si^*\omega = \int_M\omega\wedge\eta'_S
            \end{gather}
            for all $\omega\in H^k(M)$.
        \end{itemize}
    }
    \remark{Because the compact Poincar\'e dual induces a pairing on all closed forms $\omega$, which include the compactly supported ones, the compact dual is (as a form) equal to the closed Poincar\'e dual. However, as elements in cohomology these can be quite different.}

    \begin{property}[Localization principle]\index{localization}
        The support of the compact Poincar\'e dual of a submanifold $S$ may be shrunk to any neighbourhood of $S$. ?? WHAT DOES THIS MEAN ??
    \end{property}

    \begin{definition}
        Let $\pi:E\rightarrow M$ be a smooth vector bundle over $M$. A differential form $\omega\in\Omega^*(E)$ is an element of $\Omega^*_{cv}(E)$ if $\text{supp}(\omega)\cap\pi^{-1}(K)$ is compact for every compact subset $K\subset M$. The cohomology of this complex is called the \textbf{de Rham cohomology with compact support in the vertical direction}.
    \end{definition}

    \begin{result}
        This definition implies that $\omega\in\Omega^*_{cv}(E)$ is compactly supported on each fibre $\pi^{-1}(p),p\in M$. This observation explains the name of the cohomology theory.
    \end{result}

\section{Differential operators}

    In this section we generalize the notion of PDE's and ellipticity (see section \ref{pde:section:higher_dimensions}) to vector bundles.

    \newdef{Differential operator}{\index{differential!operator}\index{elliptic!operator}
        A (linear) differential operators between two vector bundels $E, F$ over the same base manifold $X$ is a linear map $C^\infty(E)\rightarrow C^\infty(F)$ that can locally be expressed as a system of partial differential equations.

        The (principal) symbol of this operator is then defined as the (principal) symbol of the associated PDE. By extension we call the differential operator \textbf{elliptic} if its associated PDE is elliptic.
    }

\subsection{Elliptic complexes}

    \newdef{Elliptic complexes}{
        Consider a collection of vector bundles $\{\pi_i:E_i\rightarrow M\}_{i\in\mathbb{N}}$ together with a collection of differential operators $\{D_i:C^\infty(E_i)\rightarrow C^\infty(E_{i+1})\}_{i\in\mathbb{N}}$. We call this system an elliptic complex if it is a cochain complex, i.e. $D_{i+1}\circ D_i = 0$, and if the induced sequence $\{\sigma_p(\xi)(D_i)\}_{i\in\mathbb{N}}$ is exact for all $x\in M$ and $\xi\neq0$.
    }

    ?? COMPLETE ??

\section{Linear connections}

    \newdef{Koszul connection}{\index{connection!Koszul}\label{manifolds:koszul_connection}
        Let $\pi: E\rightarrow M$ be a vector bundle over a smooth manifold $M$. A Koszul connection (or \textbf{linear connection)} on $E$ is a (smooth) linear map $\nabla:\Gamma(E)\rightarrow\Gamma(T^*M\otimes E)$ satisfying the Leibniz property
        \begin{gather}
            \nabla(f\sigma) = f\nabla\sigma + df\otimes\sigma
        \end{gather}
        for all $f\in C^\infty(M)$.
    }
    \begin{property}
        Because $\nabla\sigma$ takes a vector field as input, which is a $C^\infty(M)$-linear operation, we obtain
        \begin{gather}
            \nabla_{fX + Y}\sigma = f\nabla_X\sigma + \nabla_Y\sigma.
        \end{gather}
    \end{property}

    \begin{formula}
        Let $E, E'$ be two vector bundles over the same manifold $M$. Koszul connections on $E$ and $E'$ induce a connection on the tensor product bundle $E\otimes E'$ as follows:
        \begin{gather}
            \nabla(X\otimes Y) := \nabla X\otimes Y + X\otimes\nabla Y
        \end{gather}
        for $X\in\Gamma(E), Y\in\Gamma(E')$.
    \end{formula}

    \begin{example}[Affine connection]\index{connection!affine}
        Let $M$ be a smooth manifold. An affine connection $\nabla:\mathfrak{X}(M)\times\mathfrak{X}(M)\rightarrow \mathfrak{X}(M)$ is a Koszul connection on the tangent bundle.
    \end{example}

    \begin{property}[Local behaviour]
        Consider a vector $v\in T_pM$. If two vector fields $X, Y\in \Gamma(TM)$ are equal on some neighbourhood $U$ of $p$ then $\nabla_vX = \nabla_vY$ on $U$. Furthermore, given a curve $c:[0, 1]\rightarrow M$ and two vector fields $X, Y\in\Gamma(TM)$ such that $X\circ c = Y\circ c$ we find that $\nabla_{\dot c}X = \nabla_{\dot c}Y$. Hence we see that an affine connection only depends on the local behaviour of the given section.
    \end{property}
    \begin{remark}
        The above property shows the major difference between the Lie derivative and the covariant derivative when acting on sections of the tangent bundle $\sigma$. Lie derivatives depend on the local behaviour of both $X$ and $\sigma$. The covariant derivative on the other hand only depends on the value of $X$ at $p\in M$ and on the local behaviour of $\sigma$.
    \end{remark}

    \begin{property}[Affinity]
        Consider two affine connections $\nabla, \overline\nabla$ on a smooth manifold $M$. The operator $\nabla-\overline\nabla$ is an endormorphism of $E$, i.e. $\nabla-\overline\nabla\in\Omega^1(M;\text{End}(E))$. It follows that the set of affine connections forms an affine space (hence the name).
    \end{property}

    \newdef{Parallel tensor fields}{\index{parallel}
        A tensor field $T$ is said to be parallel with respect to a connection $\nabla$ if it satisfies $\nabla T = 0$.
    }
    \begin{example}
        Important examples in the case of the Levi-Civita connection on a Riemannian manifold are the volume form Vol and the metric $g$ (see chapter \ref{chapter:riemann}).
    \end{example}

    \newdef{Connection coefficients}{\index{Christoffel symbols}
        Let $E$ be smooth vector bundle. Consider a Koszul connection $\nabla$ and a (local) frame $\{e_i\}$ and coframe $\{f^i\}$ of $E$. For every vector field $e_i$ one can write
        \begin{gather}
            \nabla e_i = \Gamma^k_{\ ji}e_k\otimes f^j.
        \end{gather}
        The quantities $\Gamma^k_{\ ji}$ are called the connection coefficients or \textbf{Christoffel symbols} of $\nabla$. For a general vector field $\sigma = \sigma^ie_i$ one then obtains (if $\{e_i\}$ and $\{f^i\}$ are coordinate-induced):
        \begin{align}
            \nabla\sigma &= (\nabla\sigma^i)\otimes e_i + \sigma^i(\nabla e_i)\nonumber\\
            &= (\partial_j\sigma^k)e_k\otimes f^j + \sigma^i(\Gamma^k_{\ ji}e_k\otimes f^j)\nonumber\\
            &= (\partial_j\sigma^k + \Gamma^k_{\ ji}\sigma^i)e_k\otimes f^j.
        \end{align}
    }

\subsection{Induced connections}

    \begin{formula}[Connection on tensors]
        Applying the Leibniz property of a Koszul connection to tensor contractions gives us the following form of the induced connection on the $(s, k)$-tensor bundle:
        \begin{align}
            \nabla_YT(\omega^1,\ldots, \omega^s, X_1,\ldots, X_k) := Y\Big(&T(\omega^1,\ldots, \omega^s, X_1,\ldots, X_k)\Big)\nonumber\\
            &- \sum_{i=1}^sT(\omega^1,\ldots, \nabla_Y\omega^i,\ldots, \omega^s, X_1,\ldots, X_k)\nonumber\\
            &- \sum_{i=1}^kT(\omega^1,\ldots, \omega^s, X_1,\ldots, \nabla_YX_i,\ldots, X_k)
        \end{align}
        where $Y, X_1,\ldots, X_k\in\mathfrak{X}(M)$ and $\omega^1,\ldots,\omega^s\in\Omega^1(M)$.
    \end{formula}

    \begin{result}
        By noting that the covariant derivative of a vector field is a vector-valued differential form, we can use the previous formula to compute the covariant derivative of the covariant derivative:
        \begin{gather}
            (\nabla_X\nabla)_YZ = \nabla_X(\nabla_YZ) - \nabla_{\nabla_XY}Z - \nabla_Y(\nabla_XZ).
        \end{gather}
        We added parentheses to make it clear that the outer covariant derivatives act on the result of the inner derivatives. If we would not have added these parentheses, we could have confused these terms with the second covariant derivative (whose definition also follows from a Leibniz-type argument):
        \begin{gather}
            \nabla^2_{X, Y}S : = \nabla_X(\nabla_YS) - \nabla_{\nabla_XY}S.
        \end{gather}
    \end{result}

    As an example of the second covariant derivative we give the definition of the Hessian on arbitrary smooth manifolds:
    \newdef{Hessian}{\index{Hessian}
        Consider a smooth manifold with connection $\nabla$. The Hessian of a function $f\in C^\infty(M)$ is defined as the iterated covariant derivative:
        \begin{gather}
            \text{Hess}(f) := \nabla^2f
        \end{gather}
        where one should note that by the above definition the first covariant derivative also acts on the second one, i.e\mnote{\dbend}
        \begin{gather}
            \nabla\nabla f(X, Y) = \nabla_X(\nabla_Yf) - \nabla_{\nabla_XY}f.
        \end{gather}
        For a scalar function we know that $\nabla f = df$ and for covector fields we know that (in local coordinates) \[\nabla_i\sigma_j = \partial_i\sigma_j - \Gamma^k_{ij}\sigma_k\] where $\Gamma^k_{ij}$ are the connection coefficients. Combining these facts we obtain the following local formula for the Hessian of $f$:
        \begin{gather}
            \text{Hess}(f) = \left(\frac{\partial^2f}{\partial x_i\partial x_j} - \Gamma^k_{ij}\pderiv{f}{x_k}\right)dx^i\otimes dx^j.
        \end{gather}
    }

    \newdef{Pullback connection}{\index{connection!pullback}
        Let $E\rightarrow M$ be a vector bundle with Koszul connection $\nabla$ and let $f:M'\rightarrow M$ be a smooth map. On the pullback bundle\footnote{See definition \ref{manifolds:pullback_bundle}.} $f^*E$ there exists a unique Koszul connection $\nabla'$ satisfying
        \begin{gather}
            \nabla'(f^*\chi) = f^*(\nabla\chi)
        \end{gather}
        for any section of $E$.
    }
    \newdef{Invariant connection}{\index{connection!invariant}
        Let $G$ be a Lie group acting on a vector bundle $E\rightarrow M$. A Koszul connection $\nabla$ on $E$ is said to be invariant with respect to the $G$-action if it satisfies:
        \begin{gather}
            g^*\nabla = \nabla
        \end{gather}
        for all $g\in G$.
    }
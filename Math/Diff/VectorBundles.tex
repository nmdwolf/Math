\chapter{Vector Bundles}\label{chapter:vector_bundles}

    The main reference for this chapter is \cite{bott_tu}.

\section{Tangent bundle}

    The tangent space, as introduced in Section \ref{section:tangent_space}, can also be introduced in a more abstract/general way. Because it is the most important example of a vector bundle, tangent bundles are introduced first.
    \begin{construct}[Tangent bundle]\index{tangent!bundle}
        Let $M$ be an $n$-dimensional manifold with atlas $\{(U_i,\varphi_i)\}_{i\leq n}$. Construct for every open set $U$ an associated set $TU := U\times\mathbb{R}^n$ and construct for every smooth function $f$ an associated smooth function on $TU$, called the \textbf{differential} or \textbf{derivative} of $f$, by
        \begin{gather}
            \label{bundle:T_function}
            Tf:U\times\mathbb{R}^n\rightarrow f(U)\times\mathbb{R}^n:(p,v)\mapsto(f(p),Df(p)v),
        \end{gather}
        where $Df(p):\mathbb{R}^n\rightarrow\mathbb{R}^n$ is the Jacobian of $f$ at $p$.

        By applying this definition to the transition functions $\psi_{ji}$ one obtains a new set of functions \[\widetilde{\psi}_{ji}:=T\psi_{ji}:TU_i\rightarrow TU_j\] given by
        \begin{gather}
            \widetilde{\psi}_{ji}(\varphi_i(p),v) := \left(\varphi_j(p), D(\varphi_j\circ\varphi_i^{-1})(\varphi_i(p))v\right).
        \end{gather}
        Because the transition functions are diffeomorphisms, the associated Jacobians are invertible. This implies that the maps $\widetilde\psi_{ji}$ are elements of $\GL(\mathbb{R}^n)$. The tangent bundle is then obtained by applying the fibre bundle construction theorem \ref{bundle:fibre_bundle_construction_theorem} to the triple $(M,\mathbb{R}^n,\GL(\mathbb{R}^n))$ together with the cover $\{U_i\}_{i\leq n}$ and the cocycle $\{\widetilde\psi_{ji}\}_{i,j\leq n}$.
    \end{construct}

    \newdef{Natural chart}{\index{natural!chart}\index{adapted!chart|see{natural chart}}
        The charts in the atlas of this bundle are sometimes called natural charts or \textbf{adapted charts} because the first $n$ coordinates are equal to the coordinates on the base manifold.
    }

    \newdef{Tangent space}{\index{tangent!space}
        Consider a point $p\in M$. The definition of the tangent space in the above setting is given by the fibre
        \begin{gather}
            T_pM := \pi_{TM}^{-1}(p).
        \end{gather}
        If one uses the natural charts to map $T_pM$ to the set $\varphi_i(p)\times\mathbb{R}^n$, it can be seen that $T_pM$ is isomorphic to $\mathbb{R}^n$ (as a vector space).
    }

    \begin{property}[Smooth structure]
        An atlas on $TM$ is given by the charts $(TU_i,\theta)$ with
        \begin{gather}
            \theta:TM\rightarrow\mathbb{R}^{2n}:(p, X)\mapsto(\varphi_i\circ\pi(p),X^1,\ldots,X^n),
        \end{gather}
        where $(U_i,\varphi_i)$ is a chart around $p\in M$ such that $X$ can be expressed as $X^i\partial_i\in T_pM$.
    \end{property}

    \begin{property}[Dimension]
        Let $M$ be an $n$-dimensional manifold. Using the charts on $M$ and the adapted charts on $TM$, one can see that $TM$ is locally isomorphic to $\mathbb{R}^{2n}$. This implies that
        \begin{gather}
            \dim(TM) = 2\dim(M).
        \end{gather}
    \end{property}

    \begin{remark}[Physics]
        Now, it should be clear that the statement ``\textit{a vector is something that transforms like a vector}'', which one often hears in introductory physics courses, comes from the fact that \[\text{a vector }v\in T_pM\text{ is tangent to }\varphi_i(p)\text{ in a chart }(U_i,\varphi_i)\] if and only if \[D(\varphi_j\circ\varphi_i^{-1})(\varphi_i(p))v\text{ is tangent to }\varphi_j(p)\text{ in a chart }(U_j,\varphi_j).\]
    \end{remark}

    \newdef{Differential}{\index{differential}\label{bundle:differential}
        The map $T$ defined in Equation \eqref{bundle:T_function} can be generalized to arbitrary smooth manifolds as the map $Tf:TM\rightarrow TN$, where the Jacobian now acts on the (linear) fibres. Furthermore, let $p\in U\subseteq M$ and let $V = f(U)$. By looking at the restriction of $Tf$ to $T_pM$, one can see that it maps $T_pU$ to $T_{f(p)}V$ linearly.
    }

    \begin{property}
        The map $Tf:TM\rightarrow TN$ has the following properties:
        \begin{itemize}
            \item $T$ preserves identities: $T\mathbbm{1}_M = \mathbbm{1}_{TM}$.
            \item Let $f,g$ be two smooth functions on smooth manifolds, then $T(f\circ g) = Tf\circ Tg$.
        \end{itemize}
        This turns the map $T$ into an endofunctor on the category of smooth manifolds. One can view $T$ as a ``functorial derivative''.
    \end{property}

    \newdef{Rank}{\index{rank!of a function}\label{bundle:rank}
        Let $f:M\rightarrow N$ be a differentiable function between smooth manifolds. Using the fact that $Tf$ is fibrewise linear, the rank of $f$ at $p\in M$ is defined as the rank of the differential $Tf:T_pM\rightarrow T_{f(p)}N$ in the sense of Definition \ref{linalgebra:image_rank}.
    }

    \begin{theorem}[Inverse function theorem]\index{inverse function theorem}\label{bundle:inverse_function_theorem}
        A smooth function $f:M\rightarrow N$ between smooth manifolds is a local diffeomorphism at $p\in M$ if and only if its differential $Tf:T_pM\rightarrow T_{f(p)}N$ is an isomorphism at $p$.
    \end{theorem}

    \newdef{Parallelizable manifold}{\index{parallelizable}
        A manifold with a trivial tangent bundle.
    }

    \newdef{Normal bundle}{\index{normal!bundle}
        Consider a smooth manifold $M$ with a submanifold $S$ and consider for every point $p\in S$ the tangent spaces $T_pS$ and $T_pM$. Since $T_pS$ is a subspace of $T_pM$, one can construct the quotient space $N_pS := T_pM/T_pS$. The normal bundle of $S$ in $M$ is defined as the vector bundle with fibres $N_pS$.
    }
    \newdef{Tubular neighbourhood}{\index{tubular neighbourhood}\label{bundle:tubular_neighbourhood}
        Consider a smooth manifold $M$ with an embedded submanifold $S$. A tubular neighbourhood of $S$ in $M$ is a vector bundle $\pi:E\rightarrow S$ such that (an open neighbourhood of the \textit{zero section} of) $E$ is diffeomorphic to an open neighbourhood of $S$ in $M$.
    }
    \begin{theorem}[Tubular neighbourhood theorem]\label{bundle:tubular_neighbourhood_theorem}
        Every embedded submanifold admits a tubular neighbourhood, namely its normal bundle. Furthermore, all tubular neighbourhoods are diffeomorphic.
    \end{theorem}
    \begin{result}[Submanifolds and NDR pairs]\label{bundle:ndr_submanifold}
        Consider a smooth manifold $M$ with a submanifold $S$. The pair $(M,S)$ is an NDR pair \ref{topology:ndr_pair_homology}. In particular, consider a smooth fibre bundle $\pi:E\rightarrow B$. If $\pi$ admits a global section, one can embed $B$ in $E$ as a submanifold and, hence, the pair $(E,B)$ is an NDR pair.
    \end{result}

\section{Vector bundles}

    Instead of restricting the typical fibre to be a Euclidean space with the same dimension as the base manifold, one can generalize the construction of the tangent bundle in the following way:
    \begin{construct}[Vector bundle]\index{vector!bundle}\index{rank!of a vector bundle}\label{bundle:vector_bundle_construction}
        \nomenclature[S_Vect]{$\mathbf{Vect}(X)$}{category of vector bundles over a manifold $X$}
        Consider a manifold $B$ with atlas $\{(U_i,\varphi_i)\}_{i\in I}$ together with a cocycle $\{g_{ji}:U_i\cap U_j\rightarrow G\}_{i,j\in I}$ with values in a group $G$ and a representation $\rho:G\rightarrow\GL(V)$ on a (finite-dimensional) vector space $V$. This data can be used to construct a fibre bundle through Construction \ref{bundle:fibre_bundle_construction_theorem}. The dimension of the typical fibre $V$ is called the \textbf{rank} of the vector bundle.
    \end{construct}
    \begin{remark}
        As was also the case for tangent bundles, the choice of charts on $E$ is not random. To preserve the linear structure of fibres, the use of the natural charts is imperative.
    \end{remark}

    \begin{example}[Line bundle]\index{line!bundle}\index{wave!function}
        A vector bundle with a one-dimensional fibre. A common example in quantum mechanics is the $\mathbb{C}$-line bundle over some smooth manifold whose sections correspond to the wave functions of a given system. (See Section \ref{section:geometric_quantization} on geometric quantization for more information.)
    \end{example}

    \begin{property}[Vector bundles over a sphere]\label{bundle:vector_bundles_over_sphere}
        The clutching theorem \ref{bundle:clutching_theorem} and the homotopy invariance imply that vector bundles over the sphere are determined by homotopy classes of functions $S^{n-1}\rightarrow\GL_p(K)$, i.e. they are classified by the homotopy group $\pi_{n-1}(\GL_p(K))$.
    \end{property}

\subsection{Sections}

    \newdef{Frame}{\index{frame}\label{bundle:frame}
        A frame of a vector bundle $E$ is a tuple $(s_1,\ldots,s_n)$ of sections such that $(s_1(b),\ldots,s_n(b))$ is a basis for the fibre $\pi^{-1}(b)$ for all $b\in B$.
    }
    \begin{property}[Trivial bundles]\label{bundle:trivial_vector_bundle}
        A vector bundle is trivial if and only if there exists a global frame.
    \end{property}

    \begin{theorem}[Serre \& Swan]\index{Serre-Swan}\label{bundle:serre_swan}
        The set of smooth sections of a smooth vector bundle over a smooth manifold $M$ is a finitely-generated projective $C^\infty(M)$-module. More generally, the set of sections of a vector bundle over a compact Hausdorff manifold $B$ is a finitely-generated projective $C(B)$-module.
    \end{theorem}

    \begin{property}[Zero section]\label{bundle:zero_section}
        The zero section $s_0$ of a vector bundle $E\rightarrow B$ is the map that assigns to every point $b\in B$ the zero vector of the associated vector space $E_b$. For every vector bundle $\pi:E\rightarrow B$ one can embed the base manifold $B$ in the bundle $E$ through the zero section $s_0:B\rightarrow E$. The complement of the image of this section is often denoted by $E_0$.
    \end{property}

\subsection{Whitney sums}

    \newdef{Whitney sum}{\index{Whitney!sum}\index{direct!sum}
        Consider two vector bundles $E,E'$ with typical fibres $W,W'$ over the same base manifold. One can construct a new vector bundle $E\oplus E'$ by taking the typical fibre to be the direct sum $W\oplus W'$, i.e. the fibre over $p$ is given by $W_p\oplus W_p'$. This operation is called the Whitney sum or \textbf{direct sum} of vector bundles.
    }

    The existence property for complements \ref{linalgebra:complement} from linear algebra can be generalized in the following way:
    \begin{property}
        Let $B$ be a paracompact Hausdorff manifold and let $E$ be a vector bundle over $B$. Every vector subbundle $F$ of $E$ admits an orthogonal complement $F^\perp$.
    \end{property}
    \begin{property}\label{bundle:hausdorff}
        Let $B$ be a compact Hausdorff manifold. Every vector bundle $E$ over $B$ admits a complementary vector bundle $E^c$ such that $E\oplus E^c\cong B\times\mathbb{R}^n$ for some $n\in\mathbb{N}$.
    \end{property}

    \newdef{Stable isomorphism}{\index{stable!isomorphism}\label{bundle:stable_isomorphism}
        Two vector bundles $E,E'$ over a base manifold $B$ are said to be stably isomorphic if there exist integers $m,n\in\mathbb{N}$ such that
        \begin{gather}
            E\oplus(B\times\mathbb{R}^m)\cong E'\oplus(B\times\mathbb{R}^n).
        \end{gather}
    }

\subsection{Associated vector bundles}

    \begin{construct}[Associated vector bundle]\index{associated!vector bundle}\label{bundle:associated_vector_bundle}
        Consider a representation \[\rho:\GL(\mathbb{R}^n)\rightarrow\GL(\mathbb{R}^l)\] together with the tangent bundle cocycle $\{t_{ji} := D(\psi_{ji})\circ\varphi_i\}_{i,j\leq n}$. The composite \[\rho\circ t_{ji}:U_i\cap U_j\overset{t_{ji}}{\rightarrow}\GL(\mathbb{R}^n)\overset{\rho}{\rightarrow}\GL(\mathbb{R}^l)\] is again a cocycle and can thus be used to define a new vector bundle on $M$ through the fibre bundle construction theorem. The vector bundle $E\equiv\rho(TM)$ is called the associated (vector) bundle of the tangent bundle induced by $\rho$.
    \end{construct}

    \begin{example}[Contravariant vectors]\index{contra-!variant}
        By noting that the $k^{th}$ tensor power $\otimes^k$ induces a representation given by the tensor product of representations, one can construct the bundle of order-$k$ (contravariant) tensors $\otimes^k(TM)$.
    \end{example}
    \begin{example}[Cotangent bundle]\index{covariant}\index{co-!vector}\label{bundle:cotangent_bundle}
        Another useful construction is given by the contragredient representation $A\mapsto (\rho^T)^{-1}=(\rho^{-1})^T$. The vector bundle constructed this way, where the cocycle is given by $(t_{ji}^T)^{-1}$, is called the cotangent bundle on $M$ and is denoted by $T^*M$. Elements of the fibres are called \textbf{covariant vectors} or \textbf{covectors}.
    \end{example}
    \begin{notation}
        A combination of the cocycle $t_{ji}$ and its dual $(t_{ji}^T)^{-1}$ can also be used to define the bundle of $(k,l)$-tensors on $M$. This bundle is denoted by $T^{(k,l)}M$.
    \end{notation}

    \newdef{Twisted bundle}{\index{twisting}
        Given a vector bundle $\pi:E\rightarrow B$ and a line bundle $\psi:L\rightarrow B$, one calls the tensor product $E\otimes L$ the ``$L$-twisted'' version of $E$.
    }

    For every vector bundle one can define a canonical line bundle:
    \begin{construct}[Determinant line bundle]\index{bundle!determinant}\index{determinant!line bundle|see{bundle, determinant}}\index{density}
        Consider a rank-$n$ vector bundle $\pi:E\rightarrow B$. The determinant map induces an associated line bundle $\det(\pi):\det(E):=\bigwedge^nE\rightarrow B$ where the transition functions on the fibres are given by the determinant of the transition functions of $E$. Bundles twisted by a determinant line bundle are called \textbf{densitized bundles}.
    \end{construct}
    \begin{example}[Canonical bundle]\index{bundle!canonical}\label{bundle:canonical_bundle}
        Consider a smooth $n$-dimensional manifold $M$. The canonical (line) bundle of $M$ is given by $\det(T^*M)\equiv\bigwedge^nT^*M$, i.e. the determinant line bundle of the cotangent bundle of $M$.
    \end{example}

\subsection{Grassmann bundle}

    Looking at Property \ref{linalgebra:grassmannian_construction} and noting that $\GL_n(\mathbb{R})$ is a Lie group, it is clear that one can endow the Grassmannian $\mathrm{Gr}(k,\mathbb{R}^n)$ from Definition \ref{linalgebra:grassmannian} with a differentiable structure, thereby turning it into a smooth manifold. This allows the construction of a new bundle by applying the fibre bundle construction theorem. Because the Grassmannian is not a vector space, the resulting bundle will be a general fibre bundle and not a vector bundle.

    \begin{construct}[Grassmann bundle]\index{Grassmann!bundle}\label{bundle:grassmann_bundle}
        Define a new set of transition functions
        \begin{gather}
            \psi_{ji}:(\varphi_i(p),V)\mapsto(\varphi_j(p),t_{ji}(p)\cdot V),
        \end{gather}
        where $\{t_{ji}\}_{i,j\leq n}$ is the tangent bundle cocycle. These transition functions can be used to create a new fibre bundle with typical fibre $\mathrm{Gr}(k,\mathbb{R}^n)$. The fibre over a point $p\in M$ is the Grassmannian $\mathrm{Gr}(k,T_pM)$ associated to the tangent space over $p$.

        By replacing the tangent bundle $TM$ by an arbitrary vector bundle $E$ (and accordingly replacing the cocycle $t$ with the cocycle of $E$) one can define the Grassmann bundle of a general vector bundle.
    \end{construct}
    \begin{notation}
        The Grassmann $k$-plane bundle of a vector bundle $E$ is denoted by $\mathrm{Gr}(k,E)$.
    \end{notation}

    \newdef{Tautological bundle}{\index{tautological!bundle}\label{bundle:tautological_bundle}
        Consider the Grassmannian $\mathrm{Gr}(n,V)$ of an $(n+k)$-dimensional vector space $V$. The total space of the tautological $k$-bundle $\gamma_{n,k}$ is defined as the set of points $(W,w)$ where $W\in\mathrm{Gr}(n,V)$ and $w\in W$. Local trivializations are constructed as follows:
        \begin{gather}
            \varphi_Z:\pi^{-1}(U)\rightarrow\mathrm{Gr}(n,V)\times Z:(W,w)\mapsto(W,\pr_Z(w)),
        \end{gather}
        where $\pr_Z$ is the orthogonal projection onto the subspace $Z\in\mathrm{Gr}(n,V)$. This bundle inherits a natural vector bundle structure from $V$.
    }

    \begin{definition}\index{Serre!twisting sheaf}
        Consider the tautological line bundle $J$ over a projective space $\mathbb{C}\mathbb{P}^n\cong\mathrm{Gr}(1,\mathbb{C}^n)$. The dual line bundle $\hom(J,\mathbb{C})$ is often denoted by $\mathcal{O}_{\mathbb{CP}^n}(1)$ or $\mathcal{O}(1)$ and is sometimes called \textbf{Serre's twisting sheaf}. Tensor powers of this bundle are accordingly denoted by $\mathcal{O}_{\mathbb{CP}^n}(k)$. To also allow for factors of $J$ one can extend the notation to negative indices: $\mathcal{O}_{\mathbb{CP}^n}(-k)$, e.g. the tautological bundle is denoted by $\mathcal{O}_{\mathbb{CP}^n}(-1)$.
    \end{definition}

    \begin{property}[Euler sequence]\index{Euler!sequence}
        The twisting sheaf $\mathcal{O}_{\mathbb{CP}^n}(1)$ fits in a short exact sequence
        \begin{gather}
            0\longrightarrow\underline{\mathbb{C}}\longrightarrow\mathcal{O}_{\mathbb{CP}^n}(1)^{\oplus(n+1)}\longrightarrow T\mathbb{CP}^n\longrightarrow0,
        \end{gather}
        where $\underline{\mathbb{C}}$ denotes the trivial line bundle.
        \begin{proof}[Sketch of proof]
            Note that vector fields on $\mathbb{CP}^n$ can be obtained by pairing (coordinate-induced) basis vectors $\partial_i$ on $\mathbb{C}^{n+1}$ with linear functions on $\mathbb{C}^{n+1}$, i.e. with sections of $\mathcal{O}_{\mathbb{CP}^n}(1)$. The kernel of this map is given by the Euler vector field $\mathbb{E}:=x^i\partial_i$ and its scalar multiples (Definition \ref{calculus:euler_operator}).
        \end{proof}
    \end{property}

\section{Vector fields}

    From here on the theory will be specialized to the smooth setting, i.e. all manifolds will be assumed to be smooth and all morphism will be required to be smooth (unless stated otherwise).

    \newdef{Vector field}{\index{vector field}
        A section $s\in\Gamma(TM)$ of the tangent bundle. By the Serre-Swan theorem \ref{bundle:serre_swan} the set of vector fields forms a $C^\infty(M)$-module.
    }
    \begin{notation}
        \nomenclature[S_zsymXM]{$\mathfrak{X}(M)$}{$C^\infty(M)$-module of vector fields on the manifold $M$}
        The set of all vector fields on a manifold $M$ is often denoted by $\mathfrak{X}(M)$.
    \end{notation}

    \newdef{Index}{\index{index}
        Consider a vector field $X$ on an $n$-dimensional manifold $M$ and let $p\in M$ be an isolated zero of $X$. Because $p$ is isolated, one can find a small $(n-1)$-sphere around $p$ that does not contain any other zeroes of $X$. The index $\text{ind}_X(p)$ of $X$ at $p$ is defined as the degree \ref{topology:degree} of the function \[f:S^{n-1}\rightarrow S^{n-1}:m\mapsto\frac{X(m)}{\|X(m)\|}.\]
    }
    \begin{property}[Winding number]\index{winding number}
        The winding number of a vector field $X$ along a curve $\gamma$ (where it is assumed that $X$ does not vanish on $\gamma$) is equal to the sum of indices of zeroes of $X$ lying inside $\gamma$.
    \end{property}

    \begin{theorem}[Poincar\'e-Hopf]\index{Poincar\'e-Hopf}
        Let $M$ be a compact manifold and consider a vector field $X$ having only isolated zeroes.
        \begin{gather}
            \sum_{p:X(p)=0}\mathrm{ind}_X(p) = \chi(M),
        \end{gather}
        where $\chi$ denotes the Euler characteristic \ref{topology:euler_characteristic}.
    \end{theorem}

    An immediate consequence of the Poincar\'e-Hopf theorem is the following well-known result:
    \begin{theorem}[Hairy ball theorem]\index{hairy ball theorem}
        There exists no nowhere-vanishing vector field on an even-dimensional sphere $S^{2n}$.
    \end{theorem}

    \newdef{Pullback}{\index{pullback!of a vector field}
        Let $X$ be vector field on $N$ and let $\varphi:M\rightarrow N$ be a diffeomorphism. The pullback of $X$ along $\varphi$ is defined as
        \begin{gather}
            \label{bundle:pullback}
            (\varphi^*X)_p := T\varphi^{-1}(X_{\varphi(p)}).
        \end{gather}
    }
    \newdef{Pushforward}{\index{pushforward!of a vector field}
        Let $X$ be a vector field on $M$ and let $\varphi:M\rightarrow N$ be a diffeomorphism. The pushforward of $X$ along $\varphi$ is defined as follows:
        \begin{gather}
            \label{bundle:pushforward}
            (\varphi_*X)_{\varphi(p)} := T\varphi(X_p).
        \end{gather}
        This can be rewritten using the pullback as follows:
        \begin{gather}
            \label{bundle:pullback_pushforward}
            \varphi_*X = (\varphi^{-1})^*X.
        \end{gather}
        Equivalently, one can define a vector field on $N$ by
        \begin{gather}
            (\varphi_*X)_q(f) := X_{\varphi^{-1}(q)}(f\circ\varphi)
        \end{gather}
        for all smooth functions $f:N\rightarrow\mathbb{R}$ and points $q\in N$.
    }

\subsection{Integral curves}

    \newdef{Integral curve}{\index{integral!curve}\label{bundle:integral_curve}
        Let $X\in\mathfrak{X}(M)$ and let $\gamma:\ ]a,b[\ \rightarrow M$ be a curve on $M$. $\gamma$ is called an integral curve of $X$ if
        \begin{gather}
            \gamma'(t) = X(\gamma(t))
        \end{gather}
        for all $t\in\ ]a,b[$, where $\gamma'(t) := T\gamma(t,1)$.

        This equation can be viewed as a system of ordinary differential equations. Using the Picard-Lindel\"of existence theorem \ref{ode:picard_lindelof}, together with the initial value condition $\gamma(0)=p$, one can find a unique maximal curve satisfying the above equation. This solution, denoted by $\gamma_p$, is called the \textbf{integral curve of $X$ through $p$}.
    }

    \newdef{Flow}{\index{flow}\label{bundle:flow}
        Let $X\in\mathfrak{X}(M)$ and consider its integral curve $\gamma_p$ through a point $p\in M$. The function $\sigma_t$ defined by
        \begin{gather}
            \sigma_t(p) := \gamma_p(t),
        \end{gather}
        is called the flow of $X$ at time $t$. The \textbf{flow domain} is defined as the set
        \begin{gather}
            D(X) := \big\{(t,p)\in\mathbb{R}\times M\,\big\vert\,p\in M,t\in\ ]a_p,b_p[\ \big\},
        \end{gather}
        where $]a_p,b_p[$ is the maximal interval on which $\gamma_p$ is defined.
    }
    \begin{property}
        Suppose that $D(X) = \mathbb{R}\times M$. The flow $\sigma_t$ has the following properties for all $s,t\in\mathbb{R}$:
        \begin{itemize}
            \item $\sigma_t$ is smooth,
            \item $\sigma_0 = \mathbbm{1}_M$,
            \item $\sigma_{s+t} = \sigma_s\circ\sigma_t$, and as a consequence
            \item $\sigma_{-t} = (\sigma_t)^{-1}$.
        \end{itemize}
        These properties say that $\sigma_t$ is a smooth, bijective group action of the additive group of real numbers on $M$. This implies that $\sigma_t$ is a (smooth) \textbf{flow} in the general mathematical sense.
    \end{property}

    \newdef{Complete vector field}{\index{complete!vector field}\label{bundle:complete_vector_field}
        A vector field on a manifold $M$ for which the flow domain for every flow is all of $\mathbb{R}\times M$.
    }

    \begin{property}
        If the manifold $M$ is compact, every vector field $X\in\mathfrak{X}(M)$ is complete.
    \end{property}

    \begin{property}[Winding number]\index{winding number}
        The winding number of a vector field along a closed integral curve is 1.
    \end{property}

\subsection{Lie derivative}

    \newformula{Lie derivative for smooth functions}{\index{Lie!derivative}\label{bundle:lie_derivative_functions}
        Let $X\in\mathfrak{X}(M)$ and let $f\in C^\infty(M)$. The Lie derivative of $f$ with respect to $X$ at $p\in M$ is defined as
        \begin{gather}
            \mathcal{L}_Xf(p) := \lim_{t\rightarrow0}\frac{f(\gamma_p(t)) - f(p)}{t}.
        \end{gather}
    }
    The definition of the Lie derivative closely resembles the definition of the ordinary derivative on Euclidean space. This is not a coincidence:
    \begin{formula}[$\dag$]\label{bundle:lie_derivative_function}
        Working out the definition of the Lie derivative and rewriting it as an operator equality gives
        \begin{gather}
            \label{bundle:lie_derivative_function_expansion}
            \mathcal{L}_X = \sum_kX_k\pderiv{}{x^k}.
        \end{gather}
        It is clear that this is just the vector field $X$ expanded in the basis \ref{manifold:tangent_vector_partial}. This way, one also recovers the behaviour of a tangent vector as a derivation. For smooth functions $f:M\rightarrow\mathbb{R}$ this gives
        \begin{gather}
            \mathcal{L}_Xf(p) = X_p(f).
        \end{gather}
    \end{formula}

    \newformula{Lie derivative for vector fields$^\dag$}{\label{bundle:lie_derivative_vector_field}
        Let $X,Y\in\mathfrak{X}(M)$.
        \begin{gather}
            \mathcal{L}_XY(p) := \left.\deriv{}{t}(\sigma_t^*X)(\gamma_p(t))\right|_{t=0}.
        \end{gather}
    }
    \begin{property}\index{Lie!bracket}
        Let $X,Y\in\mathfrak{X}(M)$ be vector fields of class $C^k$. The Lie derivative has the following properties:
        \begin{itemize}
            \item $\mathcal{L}_XY$ is a vector field.
            \item\textbf{Lie bracket}: The Lie derivative of vector fields coincides with the commutator:
                \begin{gather}
                    \label{bundle:lie_bracket}
                    \mathcal{L}_XY = [X,Y].
                \end{gather}
                The fact that this is indeed a derivation on $C^{k-1}(M,\mathbb{R})$ follows from Schwarz's theorem \ref{calculus:schwarz_theorem}. This result shows that the Lie derivative on vector fields turns the space $\mathfrak{X}(M)$ into a (real) Lie algebra.
            \item The previous point also implies that the Lie derivative is antisymmetric:
                \begin{gather}
                    \label{bundle:lie_derivative_antisymmetry}
                    \mathcal{L}_XY = -\mathcal{L}_YX.
                \end{gather}
        \end{itemize}
    \end{property}

    \newdef{Holonomic basis}{\index{holonomic!basis}
        Consider a smooth manifold $M$ and an open subset $U\subseteq M$. A local frame $\{e_i\}_{i\leq\dim(M)}$ for $TU$ is said to be holonomic if all the Lie derivatives vanish on $U$:
        \begin{gather}
            \mathcal{L}_{e_i}e_j = 0.
        \end{gather}
        Equivalently, a basis is holonomic if the associated structure coefficients of the Lie algebra $\mathfrak{X}(M)$ vanish on $U$.
    }
    \begin{property}
        For every holonomic basis there exists a coordinate system on $M$ such that the basis coincides with the coordinate-induced basis.
    \end{property}

\section{Differential \texorpdfstring{$k$}{k}-forms}\label{section:forms}

    \newdef{Differential form}{\index{differential form}
        \nomenclature[S_zsymOmegak]{$\Omega^k(M)$}{$C^\infty(M)$-module of differential $k$-forms on the manifold $M$}
        A differential $k$-form is a map
        \begin{gather}
            \omega:T^kM\rightarrow\mathbb{R}
        \end{gather}
        such that the restriction of $\omega$ to each fibre of the bundle $T^kM$ is multilinear and antisymmetric. The space of all differential $k$-forms on a manifold $M$ is denoted by $\Omega^k(M)$. Just like $\mathfrak{X}(M)$, it forms a $C^\infty(M)$-module. The space $\Omega^0(M)$ is defined as the space of smooth functions $C^\infty(M)$.
    }
    Differential forms can also be constructed as sections of an associated vector bundle:
    \begin{adefinition}
        Consider the representation \[\rho_k:\GL(\mathbb{R}^{m*})\rightarrow\GL(\Lambda^k\mathbb{R}^{m*}): A\mapsto A\wedge\cdots\wedge A.\] This representation induces an associated vector bundle $\rho_k(\pi_{T^*M})$ of the cotangent bundle on $M$. A differential $k$-form is given by a section of $\rho_k(\pi_{T^*M})$:
        \begin{gather}
            \Omega^k(M) := \Gamma(\rho_k(\pi_{T^*M})).
        \end{gather}
    \end{adefinition}

    \begin{construct}[Exterior algebra]
        One can construct a Grassmann algebra \ref{vector:exterior_algebra} by equipping the graded vector space
        \begin{gather}
            \Omega^\bullet(M) := \bigoplus_{k\geq0}\Omega^k(M)
        \end{gather}
        with the wedge product of differential forms that is induced by the wedge product on $\Lambda^k\mathbb{R}^m$. This graded algebra is associative, graded-commutative and unital with the constant function $1\in C^{\infty}(M)$ as the identity element.
    \end{construct}

    \newdef{Pullback}{\index{pullback!of a differential form}\label{bundle:forms_pullback}
        Let $f:M\rightarrow N$ be a smooth function between manifolds and let $\omega$ be a differential $k$-form on $N$. The pullback of $\omega$ by $f$ is defined as
        \begin{gather}
            f^*(\omega) := \omega\circ f_*.
        \end{gather}
        This defines a map $f^*:\Omega^\bullet(N)\rightarrow\Omega^\bullet(M)$.
    }
    \newdef{Pushforward}{\index{pushforward!of a differential form}\label{bundle:forms_pushforward}
        Let $f:M\rightarrow N$ be a diffeomorphism between manifolds and let $\omega$ be a differential $k$-form on $M$. The pushforward of $\omega$ by $f$ is defined as
        \begin{gather}
            f_*(\omega) := \omega\circ(f^{-1})_*.
        \end{gather}
    }
    \begin{remark*}
        Note that the pushforward of differential $k$-forms is only defined for diffeomorphisms, in contrast to pullbacks which only require smooth functions. This also explains why differential forms are the most valuable elements in differential geometry. (Vector fields cannot even be pulled back by general smooth maps.)
    \end{remark*}

    \newformula{Dual basis}{\label{bundle:dual_basis}
        Consider the coordinate basis from Definition \ref{manifold:tangent_vector_partial} for the tangent space $T_pM$. From this set one can construct a natural dual basis for the cotangent space $T_p^*M$ using the natural pairing:
        \begin{gather}
            \left\langle\pderiv{}{x^i},dx^j\right\rangle = \delta_i^j.
        \end{gather}
        It should be noted that $dx^i$ is not just a notation. In the next section it will be shown that these basis vectors can be obtained by applying the \textit{exterior derivative} to the coordinate functions $x^i$.
    }

\subsection{Exterior derivative}

    \newdef{Exterior derivative}{\index{exterior!derivative}\index{differential}\label{bundle:exterior_derivative}
        The exterior derivative $d_k$ is a morphism constructed on the graded algebra of differential $k$-forms:
        \begin{gather}
            d_k:\Omega^k(M)\rightarrow\Omega^{k+1}(M).
        \end{gather}
        For $k=0$ it is defined by
        \begin{gather}
            \label{bundle:function_derivative}
            df := \sum_{i=1}^n\pderiv{f}{x_i}dx_i
        \end{gather}
        The object $df\in\Omega^1(M)$ is often called the \textbf{differential} of $f$. This formula can be generalized to higher degree forms as follows:
        \begin{gather}
            d(fdx_{i_1}\wedge\cdots\wedge dx_{i_k}) := df\wedge dx_{i_1}\wedge\cdots\wedge dx_{i_k}.
        \end{gather}
    }
    \remark{Equation \eqref{bundle:function_derivative} should be compared with the (informal) formula for the differential of a function that is often used in physics. The main difference is that here the quantities $dx^i$ are not infinitesimal quantities but vectors of unit norm.}

    \begin{property}\index{Leibniz!rule}\label{bundle:exterior_derivative_properties}
        The exterior derivatives satisfy the following properties for all $k\geq0$:
        \begin{itemize}
            \item\textbf{Nilpotency}: For all $\omega\in\Omega^k(M)$:
                \begin{gather}
                    d_k\circ d_{k+1} = 0.
                \end{gather}
            \item\textbf{Linearity}: $d_k$ is an $\mathbb{R}$-linear map.
        \end{itemize}
        These two items say that $(\Omega^\bullet(M),d)$ is not just a graded algebra, but in fact a dg-algebra \ref{homalg:dg_algebra}.
        \begin{itemize}
            \item\textbf{Graded Leibniz rule}: (hence $d$ is a graded derivation):
                \begin{gather}
                    d(\omega_1\wedge\omega_2) = d\omega_1\wedge\omega_2 + (-1)^j\omega_1\wedge d\omega_2,
                \end{gather}
                where $\omega_1\in\Omega^j(M)$ and $\omega_2\in\Omega^k(M)$.
            \item\textbf{Naturality}: If $f\in C^\infty(M)$, then $f^*(d\omega) = d(f^*\omega)$.
        \end{itemize}
    \end{property}

    \begin{remark}[$\dag$]\label{bundle:vector_calculus}
        The gradient, rotor (curl) and divergence from standard vector calculus (Section \ref{section:nabla}) can be rewritten using exterior derivatives as follows. Consider $\mathbf{f} := (f_1,f_2,f_3)$ with $f_i$ smooth for every $i$ and let $f$ be a smooth function. Denote the canonical isomorphism between $\mathbb{R}^3$ and $\mathbb{R}^{3*}$ by $\sim$.
        \begin{align}
            \sim df &= \nabla f \\
            \sim (\ast d\alpha) &= \nabla\times\mathbf{f} \\
            \ast d\omega &= \nabla\cdot\mathbf{f}
        \end{align}
        Property \ref{vector:mixed_properties} now follow from the nilpotency $d^2=0$.
    \end{remark}

    \begin{example}
        Let $f\in C^\infty(M,\mathbb{R})$ and let $\gamma$ be a curve on $M$. From Definition \ref{bundle:dual_basis} of the basis $\{dx_k\}_{k\leq n}$ one obtains the following result:
        \begin{gather}
            \langle df(x),\gamma'(t) \rangle = \sum_k\pderiv{f}{x_k}(x)\gamma_k'(t) = (f\circ\gamma')(t).
        \end{gather}
    \end{example}

    \begin{example}
        An explicit formula for the exterior derivative of a k-form $\Phi$ is
        \begin{align}
            d\Phi(X_1,\ldots,X_{k+1}) = \sum_{i=1}^{k+1} &(-1)^{i+1}X_i(\Phi(X_1,\ldots,\hat{X}_i,\ldots,X_{k+1}))\\
            \label{bundle:k_form_exterior_derivative}
            &+\sum_{i<j}(-1)^{i+j}\Phi([X_i,X_j],X_1,\ldots,\hat{X}_i,\ldots,\hat{X}_j,\ldots,X_{k+1}),\nonumber
        \end{align}
        where $\hat{X}$ indicates that this argument is omitted.
    \end{example}

\subsection{Lie derivative}

    \begin{formula}[Lie derivative of smooth functions]
        Using the definition of the exterior derivative of smooth functions \eqref{bundle:function_derivative} and the definition of the dual basis \ref{bundle:dual_basis}, one can rewrite the Lie derivative \ref{bundle:lie_derivative_functions} as
        \begin{gather}
            Xf(p) = df_p(X(p)).
        \end{gather}
    \end{formula}

    \newformula{Lie derivative of differential forms}{\index{Lie!derivative}\label{bundle:lie_derivative_forms}
        \begin{gather}
            \mathcal{L}_X\omega(p) := \lim_{t\rightarrow0}\frac{\sigma_t^*\omega - \omega}{t}(p)
        \end{gather}
    }

    \begin{property}
        The Lie derivative has the following Leibniz-type property with respect to differential forms:
        \begin{gather}
            \mathcal{L}_X(\omega (Y)) = (\mathcal{L}_X\omega)(Y) + \omega(\mathcal{L}_XY),
        \end{gather}
        where $X,Y$ are two vector fields and $\omega$ is a one-form.
    \end{property}

\subsection{Interior product}

    \newdef{Interior product}{\index{interior!product}\label{bundle:interior_derivative}
        Aside from the exterior derivative one can also define another operation on the algebra of differential forms:
        \begin{gather}
            \iota_X:(\iota_X\omega)(v_1,\ldots,v_{k-1})\mapsto\omega(X,v_1,\ldots,v_{k-1}).
        \end{gather}
        This antiderivation of degree $-1$ is called the \textbf{interior product} or \textbf{interior derivative}. It can be seen as a generalization of the contraction map \ref{vector:contraction}.
    }
    \begin{notation}
        In certain situations the above notation might become cumbersome. For this reason the notation $X\intmul\omega$ is frequently used.
    \end{notation}

    \newformula{Cartan's magic formula\footnotemark}{\index{Cartan!magic formula}\label{bundle:cartan_magic_formula}
        \footnotetext{Sometimes called \textbf{Cartan's (infinitesimal) homotopy formula}.}
        Let $X$ be a vector field and let $\omega$ be a differential $k$-form. The Lie derivative of $\omega$ along $X$ is given by the following formula:
        \begin{gather}
            \mathcal{L}_X\omega = \iota_X(d\omega) + d(\iota_X\omega).
        \end{gather}
    }

\subsection{Lie derivative of tensor fields}

    \newformula{Lie derivative of tensor fields}{
        By comparing the definitions of the Lie derivatives of vector fields \ref{bundle:lie_derivative_vector_field} and differential forms \ref{bundle:lie_derivative_forms}, one can see that both definitions are identical upon replacing $X$ by $\omega$. This leads to the following definition of the Lie derivative of a general tensor field $\mathcal{T}\in\Gamma(T^{(k,l)}M)$:
        \begin{gather}
            \mathcal{L}_X\mathcal{T}(p) := \left.\deriv{}{t}\sigma_t^*\mathcal{T}(\gamma_p(t))\right|_{t=0}.
        \end{gather}
    }
    \newadef{Lie derivative of tensor fields}{
        The Lie derivative of tensor fields can also be defined as the unique differential operator satisfying the following axioms:
        \begin{enumerate}
            \item $\mathcal{L}_X$ coincides with $X$ on $C^\infty(M)$.
            \item $\mathcal{L}_X$ satisfies the Leibniz rule with respect to tensor products.
            \item $\mathcal{L}_X$ satisfies the Leibniz rule with respect to the contraction of forms and vector fields.
            \item $\mathcal{L}_X$ commutes with the exterior derivative.
        \end{enumerate}
    }

    \begin{property}[Derivations]
        Every derivation $D$ of the tensor algebra can be decomposed as
        \begin{gather}
            D = \mathcal{L}_X + S
        \end{gather}
        for some vector field $X$ and some endomorphism $S$.
    \end{property}

\subsection{Vector-valued differential forms}\label{section:vector_valued_forms}

    \newdef{Vector-valued form}{\index{differential form!vector-valued}
        Consider a vector space $V$ and let $E\rightarrow M$ be a vector bundle with typical fibre $V$. A vector-valued differential form on $M$ can be defined in two ways. A vector-valued $k$-form can be defined as a map $\omega:\Gamma(T^kM)\rightarrow V$ or, more generally, as a section of the following associated bundle:
        \begin{gather}
            \Omega^k(M;E) := \Gamma(E\otimes\Lambda^kT^*M).
        \end{gather}
        The latter construction could also be called a \textbf{vector bundle-valued differential form}.
    }

    \begin{construct}[Wedge product]\index{wedge!product}\label{bundle:vector_valued_wedge}
        Let $\omega\in\Omega^p(M;E_1)$ and $\nu\in\Omega^q(M;E_2)$. The wedge product of these differential forms is defined as follows:
        \begin{gather}
            \omega\wedge\nu(v_1,\dots,v_{p+q}) := \frac{1}{p!q!}\sum_{\sigma\in S_{p+q}}\sgn(\sigma)\omega(v_{\sigma(1)},\ldots, v_{\sigma(p)})\otimes\nu(v_{\sigma(p+1)},\ldots,v_{\sigma(q)}).
        \end{gather}
        This is a direct generalization of the formula for the wedge product of ordinary differential forms, where the scalar product (product in the algebra $\mathbb{R}$) is replaced by the tensor product (product in the tensor algebra). It should be noted that the result of this operation is not a section of any of the original bundles $E_1$ or $E_2$, but rather of the tensor product bundle $E_1\otimes E_2$.
    \end{construct}

    \begin{construct}[Exterior derivative]\label{bundle:twisted_differential}
        The definition of an exterior derivative on $E$-valued differential forms is more involved than in the case of ordinary forms. The naive thing to do would be defining a derivative through the Leibniz formula. However, without further structure on $E$ there is no natural way of differentiating sections of $E$.

        If $E$ is \textit{flat}, i.e. if its transition functions are locally constant, one can choose a frame of sections $e^i:U\rightarrow E|_U$ induced by the trivializing maps $E|_U\rightarrow U\times\mathbb{R}^n$. Locally, one can then express any $E$-valued differential form as $\omega|_U=\sum_i\omega_i\otimes e^i$, where the $\omega_i$ are ordinary differential forms. After defining $de^i:=0$ one can again construct an exterior derivative through the Leibniz formula.
    \end{construct}
    \begin{remark}
        It should be noted that the definition of $d$ depends on the choice of trivialization since the sections $e^i$ depend on this choice.
    \end{remark}

    \newdef{Lie algebra-valued form}{\index{differential form!Lie algebra-valued}
        A vector-valued differential form where the vector space $V$ is equipped with a Lie algebra structure.
    }
    \newformula{Wedge product}{\index{wedge!product}\label{bundle:lie_algebra_valued_wedge}
        Let $\omega\in\Omega^p(M;\mathfrak{g})$ and $\nu\in\Omega^q(M; \mathfrak{g})$ where $\mathfrak{g}$ is a Lie algebra. The wedge product of these differential forms is defined as follows:
        \begin{gather}
            [\omega\wedge\nu](v_1,\ldots,v_{p+q}) := \frac{1}{p!q!}\sum_{\sigma\in S_{p+q}}\sgn(\sigma)[\omega(v_{\sigma(1)},\ldots, v_{\sigma(p)}),\nu(v_{\sigma(p+1)},\ldots,v_{\sigma(q)})],
        \end{gather}
        where $[\cdot,\cdot]$ denotes the Lie bracket on $\mathfrak{g}$.
    }

    \begin{formula}
        Let $\{e_a\}_{a\leq\dim(\mathfrak{g})}$ be a basis for the Lie algebra $\mathfrak{g}$. One can write any Lie algebra-valued differential forms as $\phi = \phi^a\otimes e_a$ and $\psi = \psi^b\otimes eb$, where $\phi^a$ and $\psi^b$ are ordinary differential forms. The above formula for the wedge product can now be rewritten more elegantly as
        \begin{gather}
            [\phi\wedge\psi] = (\phi^a\wedge\psi^b)\otimes[e_a,e_b],
        \end{gather}
        where $\wedge$ is the wedge product on $\Omega^\bullet(M)$.
    \end{formula}
    \begin{result}[Graded algebra]
        Using the above formula it is easy to verify a number of properties similar to the ones of ordinary differential forms. As an example the analogue of the graded-commutativity property on $\Omega^\bullet(M)$ is given:
        \begin{gather}
            [\phi\wedge\psi] = (-1)^{pq+1}[\psi\wedge\phi],
        \end{gather}
        where $\phi\in\Omega^p(M;\mathfrak{g})$ and $\psi\in\Omega^q(M;\mathfrak{g})$. Here, the extra factor $-1$ comes from the antisymmetry of the Lie bracket.

        Analogously, one can prove that the Lie algebra-valued wedge product satisfies a graded Jacobi-type identity:
        \begin{gather}
            (-1)^{pr}[\phi\wedge[\psi\wedge\theta]] + (-1)^{pq}[\psi\wedge[\theta\wedge\phi]] + (-1)^{qr}[\theta\wedge[\phi\wedge\psi]] = 0,
        \end{gather}
        where $\theta\in\Omega^r(M;\mathfrak{g})$.
    \end{result}

\section{Frobenius's theorem}

    \newdef{Distribution}{\index{distribution!of $k$-planes}\label{bundle:distribution}
        A section of the Grassmann $k$-plane bundle \ref{bundle:grassmann_bundle}.
    }

    \newdef{Integrable distribution}{\index{integrable!distribution}\index{manifold!integral}
        Let $M$ be a manifold and consider a distribution of $k$-planes $W\in\Gamma(\mathrm{Gr}(k,TM))$. A submanifold $N\subseteq M$ is said to integrate $W$ (or to be \textbf{integral}) with initial condition $p_0\in M$ if $p_0\in N$ and if $\forall p\in N:W(p) = T_pN$. $W$ is said to be integrable if there exists such a submanifold $N$.
    }
    \begin{property}\index{leaf}\index{foliation}
        If a distribution on $M$ is integrable, $M$ can be written as the (disjoint) union of maximal connected, integrable manifolds. These submanifolds are also called the \textbf{leaves} of the distribution (the decomposition in leaves defines a \textit{foliation}).
    \end{property}

    \newdef{Frobenius's integrability condition}{
        A distribution $W$ on a manifold $M$ is said to satisfy the Frobenius integrability condition on an open set $U\subseteq M$ if for every two vector fields $X, Y$ defined on $U$, such that $X(p)\in W(p)$ and $Y(p)\in W(p)$ for all $p\in U$, the Lie bracket $[X,Y](p)$ is also an element of $W(p)$ for all $p\in U$.
    }
    \begin{theorem}[Frobenius's integrability theorem]\index{Frobenius!integrability theorem}\label{bundle:frobenius}
        Let $W$ be a distribution over a manifold $M$. $W$ is integrable if and only if it satisfies the Frobenius integrability condition.
    \end{theorem}

    This theorem also admits a formulation in terms of differential forms.
    \begin{property}[Differential formulation]\label{bundle:differential_frobenius}
        Consider a rank-$r$ distribution $D$. The annihilator $I(D)$ is the ideal containing all differential forms satisfying
        \begin{gather}
            \omega(X_1,\ldots,X_k) = 0
        \end{gather}
        whenever all $X_i\in D$. The Frobenius theorem says that the following conditions are equivalent:
        \begin{itemize}
            \item $D$ is integrable.
            \item $I(D)$ is a differential ideal.
        \end{itemize}
    \end{property}

    \begin{property}[Pfaffian system]\index{Pfaffian system}\label{bundle:pfaff}
        The fact that $D$ is a distribution implies that locally there exists a set of $\dim(M)-r$ linearly independent, annihilating one-forms that generate $I(D)$. These one-forms are said to form a Pfaffian system. Furthermore, every ideal that is locally generated by linearly independent one-forms defines a smooth distribution.

        Given a Pfaffian system $\{\theta^\alpha\}_{\alpha\leq\dim(M)-r}$, a third equivalent condition for (\textbf{complete}) integrability is that
        \begin{gather}
            \label{bundle:integrable_wedge_condition}
            d\theta^1\wedge\theta^2\wedge\cdots = 0.
        \end{gather}
    \end{property}

    \begin{property}[Integral manifold]\index{manifold!integral}
        An integral manifold of a rank-$r$ Pfaffian system $\{\theta^\alpha\}_{\alpha\leq\dim(M)-r}$ is a smooth function $f:N\rightarrow M$ such that
        \begin{gather}
            f^*\theta^\alpha=0
        \end{gather}
        for all $1\leq\alpha\leq\dim(M)-r$. Often $f$ will be a submanifold inclusion.

        If the system is integrable, there exist $\dim(M)-r$ independent functions $y^\alpha$ such that $\{dy^\alpha\}_{\alpha\leq\dim(M)-r}$ generates the same differential ideal as the Pfaffian system. The integral submanifolds of the distribution are given by the systems
        \begin{gather}
            \begin{cases}
                y^1 = c^1,\\
                y^2 = c^2,\\
                \phantom{y^i\ \ }\vdots
            \end{cases}
        \end{gather}
        for constants $c^\alpha$.
    \end{property}

    \newdef{Characteristic system}{\index{characteristic!system}\label{bundle:characteristic_system}
        Consider a system $P$ of exterior differential equations $\{\omega^\alpha=0\}$ where the degree of all forms is nonzero. As for a smooth distribution, one can locally find a set of one-forms that generate the same ideal. This is again called the \textbf{Pfaffian system}. The characteristic system of $P$ is defined as the Pfaffian system of the differential closure of $P$.

        If $P$ also contained functions, i.e. degree-zero forms, the characteristic system is that of $\{\omega^\alpha,df^\beta\}$ extended by the functions $f^\beta$ themselves.
    }

    \newdef{Integral invariant}{\index{integral!invariant}\label{bundle:integral_invariant}
        Consider a Pfaffian system $P\equiv\{\theta^\alpha\}$. A differential form $\omega$ is called an invariant of $P$ if
        \begin{gather}
            \mathcal{L}_X\omega = 0
        \end{gather}
        whenever $\theta(X)=0$ for al $\theta\in P$. These forms are also called absolute integral invariants because the integral of $\omega$ over every chain is invariant under the transformations generated by these $X$. If $d\varphi$ is an (absolute integral) invariant of $P$, then $\varphi$ is called a relative integral invariant.
    }

\section{Linear connections}\label{section:linear_connections}
\subsection{Koszul connections}

    \newdef{Koszul connection}{\index{connection!Koszul}\index{covariant!derivative}\label{bundle:koszul_connection}
        Let $\pi:E\rightarrow M$ be a vector bundle over a manifold $M$. A Koszul connection (or \textbf{linear connection)} on $E$ is a (smooth) linear map $\nabla:\Gamma(E)\rightarrow\Gamma(T^*M\otimes E)$ satisfying the Leibniz property
        \begin{gather}
            \nabla(f\sigma) = f\nabla\sigma + df\otimes\sigma
        \end{gather}
        for all $f\in C^\infty(M)$. When evaluated on a vector field $X$, $\nabla_X$ is often called a \textbf{covariant derivative}.
    }
    \begin{property}
        Because $\nabla\sigma$ takes a vector field as input, which is a $C^\infty(M)$-linear operation, the connection satisfies the following linearity property:
        \begin{gather}
            \nabla_{fX+Y}\sigma = f\nabla_X\sigma + \nabla_Y\sigma.
        \end{gather}
    \end{property}

    \begin{formula}
        Let $E,E'$ be two vector bundles over the same manifold $M$. Koszul connections on $E$ and $E'$ induce a connection on the tensor product bundle $E\otimes E'$ as follows:
        \begin{gather}
            \nabla(X\otimes Y) := \nabla X\otimes Y + X\otimes\nabla Y
        \end{gather}
        for $X\in\Gamma(E),Y\in\Gamma(E')$.
    \end{formula}

    \begin{example}[Affine connection]\index{connection!affine}
        Let $M$ be a manifold. An affine connection $\nabla:\mathfrak{X}(M)\times\mathfrak{X}(M)\rightarrow\mathfrak{X}(M)$ is a Koszul connection on the tangent bundle.
    \end{example}

    \begin{property}[Local behaviour]
        Consider a vector $v\in T_pM$. If two vector fields $X,Y\in\Gamma(TM)$ coincide on some neighbourhood $U$ of $p$, then $\nabla_vX = \nabla_vY$ at $p$. Furthermore, given a curve $c:[0,1]\rightarrow M$ and two vector fields $X,Y\in\Gamma(TM)$ such that $X\circ c = Y\circ c$, one finds that $\nabla_{\dot c}X = \nabla_{\dot c}Y$. This implies that an affine connection only depends on the local behaviour of the given section.
    \end{property}
    \begin{remark}
        The above property shows the major difference between the Lie derivative and the covariant derivative when acting on sections of the tangent bundle $\sigma$. Lie derivatives depend on the local behaviour of both $X$ and $\sigma$. The covariant derivative on the other hand only depends on the value of $X$ at $p\in M$ and on the local behaviour of $\sigma$.
    \end{remark}

    \newdef{Parallel tensor fields}{\index{parallel}
        A tensor field $T$ is said to be parallel with respect to a connection $\nabla$ if it satisfies $\nabla T = 0$. It is said to be parallel with respect to a vector field $X$ if $\nabla_XT = 0$.
    }
    \begin{example}
        Important examples in the case of the Levi-Civita connection on a Riemannian manifold are the volume form $\vol$ and the metric $g$ (see Chapter \ref{chapter:riemann}).
    \end{example}

    \begin{property}[Affinity]
        Consider two affine connections $\nabla,\overline\nabla$ on a smooth manifold $M$. The operator $\nabla-\overline\nabla$ is an endormorphism of $E$, i.e. $\nabla-\overline\nabla\in\Omega^1(M;\End(E))$. It follows that the set of affine connections forms an affine space (hence the name).
    \end{property}

    \newdef{Connection coefficients}{\index{Christoffel symbols}\label{bundle:christoffel_symbol}
        Let $E$ be a smooth rank-$k$ vector bundle. Consider a Koszul connection $\nabla$, a (local) frame $\{e_i\}_{1\leq i\leq k}$ and a (local) coframe $\{f^i\}_{1\leq i\leq k}$ on $E$. For every vector field $e_i$ one can (locally) write
        \begin{gather}
            \nabla e_i = \Gamma^k_{\ ji}e_k\otimes f^j.
        \end{gather}
        The quantities $\Gamma^k_{\ ji}$ are called the connection coefficients or \textbf{Christoffel symbols} of $\nabla$. For a general vector field $\sigma = \sigma^ie_i$ one then obtains (if $\{e_i,f^i\}_{1\leq i\leq k}$ are coordinate-induced):
        \begin{align}
            \nabla\sigma &= (\nabla\sigma^i)\otimes e_i + \sigma^i(\nabla e_i)\nonumber\\
            &= (\partial_j\sigma^k)e_k\otimes f^j + \sigma^i(\Gamma^k_{\ ji}e_k\otimes f^j)\nonumber\\
            &= (\partial_j\sigma^k + \Gamma^k_{\ ji}\sigma^i)e_k\otimes f^j.
        \end{align}
    }

\subsection{Induced connections}

    \begin{formula}[Connection on tensors]
        Applying the Leibniz property of a Koszul connection to tensor contractions gives the following form of the induced connection on the $(k,l)$-tensor bundle:
        \begin{align}
            \nabla_YT(\omega^1,\ldots,\omega^k,X_1,\ldots,X_l) := Y\Big(&T(\omega^1,\ldots,\omega^k,X_1,\ldots,X_l)\Big)\nonumber\\
            &- \sum_{i=1}^kT(\omega^1,\ldots,\nabla_Y\omega^i,\ldots,\omega^k,X_1,\ldots,X_l)\nonumber\\
            &- \sum_{i=1}^lT(\omega^1,\ldots,\omega^l,X_1,\ldots,\nabla_YX_i,\ldots,X_l),
        \end{align}
        where $Y,X_1,\ldots,X_l\in\mathfrak{X}(M)$ and $\omega^1,\ldots,\omega^k\in\Omega^1(M)$.
    \end{formula}

    \begin{result}[Iterated derivatives]
        By noting that the covariant derivative of a vector field is a vector-valued differential form, one can use the previous formula to compute the covariant derivative of the covariant derivative:
        \begin{gather}
            (\nabla_X\nabla)_YZ = \nabla_X(\nabla_YZ) - \nabla_{\nabla_XY}Z - \nabla_Y(\nabla_XZ).
        \end{gather}
        Parentheses were added to make it clear that the outer covariant derivatives act on the result of the inner derivatives. If these parentheses would not have been added, these terms could have been confused with the second covariant derivative (whose definition also follows from a Leibniz-type argument):
        \begin{gather}
            \nabla^2_{X,Y}S : = \nabla_X(\nabla_YS) - \nabla_{\nabla_XY}S.
        \end{gather}
    \end{result}

    As an example of the second covariant derivative the definition of the Hessian on arbitrary smooth manifolds is given:
    \newdef{Hessian}{\index{Hessian}
        Consider a manifold with connection $\nabla$. The Hessian of a function $f\in C^\infty(M)$ is defined as the iterated covariant derivative:
        \begin{gather}
            \mathrm{Hess}(f) := \nabla^2f,
        \end{gather}
        where one should note that by the above definition the first covariant derivative also acts on the second one, i.e\mnote{\dbend}
        \begin{gather}
            \nabla^2f(X,Y) = \nabla_X(\nabla_Yf) - \nabla_{\nabla_XY}f.
        \end{gather}
        For a scalar function one knows that $\nabla f = df$ and for covector fields one knows that (in local coordinates) \[\nabla_i\sigma_j = \partial_i\sigma_j - \Gamma^k_{ij}\sigma_k,\] where $\Gamma^k_{ij}$ are the connection coefficients. Combining these facts one obtains the following local expression for the Hessian of $f$:
        \begin{gather}
            \mathrm{Hess}(f) = \left(\frac{\partial^2f}{\partial x_i\partial x_j} - \Gamma^k_{ij}\pderiv{f}{x_k}\right)dx^i\otimes dx^j.
        \end{gather}
    }

    \newdef{Pullback connection}{\index{connection!pullback}
        Let $E\rightarrow N$ be a vector bundle with Koszul connection $\nabla$ and let $f:M\rightarrow N$ be a smooth function. On the pullback bundle \ref{bundle:pullback_bundle} there exists a unique Koszul connection $\nabla'$ satisfying
        \begin{gather}
            \nabla'(f^*\chi) = f^*(\nabla\chi)
        \end{gather}
        for any section $\chi$ of $E$.
    }
    \newdef{Invariant connection}{\index{connection!invariant}
        Let $G$ be a Lie group acting on a vector bundle $E\rightarrow M$. A Koszul connection $\nabla$ on $E$ is said to be invariant with respect to the $G$-action if it satisfies:
        \begin{gather}
            g^*\nabla = \nabla
        \end{gather}
        for all $g\in G$.
    }

\input{Math/Diff/Integration}
\input{Math/Diff/Cohomology}

\section{Differential operators}

    In this section the study of PDEs is generalized to vector bundles. The case of PDEs on $\mathbb{R}^n$ was treated in Chapter \ref{chapter:pde}.

    \newdef{Differential operator}{\index{differential!operator}\index{elliptic!operator}\label{bundle:differential_operator}
        A (linear) differential operators between two vector bundels $E,F$ over the same base manifold $X$ is a linear map $\Gamma(E)\rightarrow\Gamma(F)$ that can locally be expressed as a system of partial differential equations.

        The principal symbol of this operator is defined as the principal symbol \ref{pde:principal_symbol} of the associated PDE. By extension one says the differential operator is \textbf{elliptic} (hyperbolic, \ldots) if its associated PDE is elliptic (hyperbolic, \ldots).
    }

    \newdef{Normally hyperbolic operators}{\index{hyper-!bolic operator}
        Consider a (pseudo)Riemannian vector bundle $E$ (see Chapter \ref{chapter:riemann}). A linear differential operator on $E$ is said to be normally hyperbolic if its principal symbol is proportional to the given metric.
    }

\subsection{Elliptic complexes}

    \newdef{Elliptic complex}{\index{elliptic!complex}
        Consider a collection of vector bundles $\{\pi_n:E_n\rightarrow M\}_{n\in\mathbb{N}}$ together with a sequence of differential operators $\big(D_n:C^\infty(E_n)\rightarrow C^\infty(E_{n+1})\big)_{n\in\mathbb{N}}$. This system is called an elliptic complex if it is a cochain complex, i.e. $D_{n+1}\circ D_n = 0$, and if the induced sequence $\big(\sigma_p(\xi)(D_n)\big)_{n\in\mathbb{N}}$ is exact for all $x\in M$ and $\xi\neq0$.
    }

    ?? COMPLETE ??
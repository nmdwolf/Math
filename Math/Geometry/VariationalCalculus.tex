\chapter{Calculus of Variations}\label{chapter:variation}

    The standard references for (global) variational calculus are~\citet{takens_global_1979,anderson_variational_1992}.

    \minitoc

\section{Constrained systems}\label{section:variational_calculus}

    \newdef{Holonomic constraint}{\index{holonomic!constraint}
        A constraint $f(q,t) = 0$ that only depends on the coordinates $q^i$ and $t$ and not on the derivatives.
    }
    \begin{method}[Holonomic constraints]\index{Lagrange!multiplier}
        The Euler--Lagrange equations of a system with $k\in\mathbb{N}$ holonomic constraints $f_k(q,t)=0$ can be obtained from the generalized action functional
        \begin{gather}
            I_{\text{ext}}[q,\lambda]:=\Int_a^b\left[L(q,\dot{q},t) + \sum_{i=1}^k\lambda_i(t)f_i(q,t)\right]\,dt\,,
        \end{gather}
        where the $\lambda_i$ are are called \textbf{Lagrange multipliers}. Extremizing with respect to these multipliers induces the constraints:
        \begin{gather}
            \frac{\delta I_{\text{ext}}}{\delta\lambda_i}=0\,.
        \end{gather}
    \end{method}

\section{Introduction}

    \newdef{Variational symmetry}{\index{symmetry!varaitional}
        Consider an integral quantity $I$ defined by a Lagrangian function:
        \begin{gather}
            I_M = \Int_ML(q,u,u_I)\,dq\,,
        \end{gather}
        where $u$ are (analytic) functions of the variables $q$. A transformation $(q,u)\longrightarrow(q',u')$ of the variables\footnote{The transformations of the derivatives $\partial u$ are induced by the ones for $u$.} is called a variational (or Noether) symmetry if it satisfies
        \begin{gather}
            \Int_{M'}L(q',u',u'_I)\,dq' = \Int_ML(q,u,u_I)\,dq
        \end{gather}
        for arbitrary $M$.
    }

    Following \textit{Lie}, the notion of a group of transformations is introduced.
    \newdef{Finite continuous group}{
        A collection of analytic functions, closed under inverses and composition, such that every function depends analytically on a finite number of parameters. In this chapter, these groups will be denoted by $\mathfrak{G}_k$, where $k\in\mathbb{N}$ is the number of independent parameters.
    }
    \remark{It should be clear that this is the same as a finite-dimensional Lie group (\cref{lie:lie_group}).}

    Instead of parameters, one can also generalize to functions.
    \newdef{Infinite continuous group}{
        A collection of analytic functions, closed under inverses and composition, such that every function depends analytically on a finite number of arbitrary (analytic) functions. In this chapter, these groups will be denoted by $\mathfrak{G}_{\infty,k}$, where $k\mathbb{N}$ is the number of independent functions.
    }
    \remark{In physics terminology, the infinite groups would be obtained by `gauging' a global symmetry group $\mathfrak{G}_k$.}

    \begin{theorem}[Noether]\index{Noether}\label{var:noether}
        Consider an integral quantity $I$ that is invariant under a continuous group $\mathfrak{G}$.
        \begin{itemize}
            \item If $\mathfrak{G}$ is finite continuous of the form $\mathfrak{G}_k$, there exist $k\in\mathbb{N}$ independent (linear) combinations among the Lagrangian expressions that are equal to divergences. Conversely, if there exist $k$ independent combinations among the Lagrangian expressions that are divergences, then $I$ is invariant under a group of the form $\mathfrak{G}_k$.
            \item If $\mathfrak{G}$ is infinite continuous of the form $\mathfrak{G}_{\infty,k}$, there exist $k\in\mathbb{N}$ independent relations among the Lagrangian expressions and their derivatives\footnote{The order up to which the derivatives occur is equal to the order of derivatives up to which the transformations depend on the $k$ arbitrary functions.}. Conversely, if $k$ such relations exist, then $I$ is invariant under a group of the form $\mathfrak{G}_{\infty,k}$.
        \end{itemize}
    \end{theorem}
    \remark{In fact, the first theorem is also valid in the limit of an infinite number of parameters.}

    \newprop{Improper relations}{\label{var:improper_relations}
        Divergence relations $\sum_i\psi_i\overline\delta u_i = \nabla\cdot B$ obtained in a variational problem with symmetry group $\mathfrak{G}_k$ can be classified into two groups:
        \begin{itemize}
            \item If the quantities $B$ are linear combinations of Lagrangian expressions (and their derivatives) and divergence-free quantities, the divergence relations are said to be improper.
            \item In all other cases, the divergence relations are said to be proper.
        \end{itemize}
    }
    \begin{theorem}[Noether's third theorem]\label{var:noether_third_theorem}
        A finite continuous symmetry group $\mathfrak{G}_k$ of an integral quantity is a subgroup of an infinite continuous symmetry group $\mathfrak{G}_{\infty,k}$ if and only if the divergence relations are improper.
    \end{theorem}

    For Lagrangians describing `point particles', where $M\subseteq\mathbb{R}$, the following result is obtained.
    \begin{example}[One dimension]\index{prolongation}\index{Rund--Trautman identity}
        Consider the following infinitesimal transformations
        \begin{gather}
            \begin{aligned}
                q^i\longrightarrow q^i& + \varepsilon\xi^i(q^k,t)\,,\\
                t\longrightarrow t& + \varepsilon\tau(q^k,t)\,,\label{var:transformations}\\
                \dot{q}^i\longrightarrow\dot{q}^i& + \varepsilon(\dot{\xi}^i - \dot{q}^i\dot{\tau})\,,
            \end{aligned}
        \end{gather}
        where the transformation of the `velocities' on the last line, induced by the coordinate transformations, is called a \textbf{prolongation} (see also \cref{var:prolongation} further below). These transformations generate Noether symmetries if they leave the Lagrangian invariant up to a total derivative (at first order) for every subinterval $[t_0,t_1]\subseteq[a,b]$ and for some function $f(q,t)$:
        \begin{gather}
            \Int_{\tilde{t}_0}^{\tilde{t}_1}L(\tilde{q},\dot{\tilde{q}},\tilde{t})\,d\tilde{t} = \Int_{t_0}^{t_1}L(q,\dot{q},t)\,dt + \varepsilon\Int_{t_0}^{t_1}\deriv{f}{t}\,dt + O(\varepsilon^2)\,.
        \end{gather}
        This is equivalent to requiring that the transformation is a solution of the following differential equation (sometimes called the \textbf{Rund--Trautman identity}):
        \begin{gather}
            \label{var:transformed_lagrangian}
            \pderiv{L}{t}\tau + \pderiv{L}{q^i}\xi^i + \pderiv{L}{\dot{q}^i}(\dot{\xi}^i - \dot{q}^i\dot{\tau}) + L\dot{\tau} = \dot{f}\,.
        \end{gather}
        By Noether's (first) theorem one obtains, for every such symmetry, a conserved quantity of the following form
        \begin{gather}
            F := f - \left[L\tau + \pderiv{L}{\dot{q}^i}(\xi^i - \dot{q}^i\tau)\right]\,.
        \end{gather}
        It is important to note that the left-hand side of \cref{var:transformed_lagrangian} is simply the Lie derivative of the Lagrangian form $L\dr t$ with respect to the vector field that generates the transformations~\eqref{var:transformations}. (This will turn out to be an important concept in the calculus of variations. See \cref{var:bessel_hagen} further on.)
    \end{example}

\section{Jet bundles}\index{jet}\label{section:jet_bundles}
\subsection{Topology}

    Although the following constructions can be defined in the general context of fibred manifolds, they will only be considered in the case of smooth fibre bundles. Only the notion of a jet will be defined in general for functions between smooth manifolds.

    \newdef{Jet}{\index{order!of a jet}
        Consider two smooth manifolds $M,N$ and let $r\in\mathbb{N}$. Smooth functions $f,g\in C^\infty(M,N)$ with local coordinates $(f^i)$ and $(g^i)$ are said to define the same $r$-jet at a point $p\in M$ if and only if
        \begin{gather}
            \left.\mpderiv{\alpha}{f^i}{x}\right|_p = \left.\mpderiv{\alpha}{g^i}{x}\right|_p
        \end{gather}
        for all $0\leq i\leq\dim(M)$ and every multi-index $\alpha$ with $0\leq|\alpha|\leq r$. It is clear that this defines an equivalence relation. The $r$-jet at $p\in M$ of a representative $f$ is denoted by $j_p^rf$. The integer $r$ is called the \textbf{order} of the jet. The set of all $r$-jets of functions between manifolds $M$ and $N$ is denoted by $J^r(M,N)$.
    }
    \newdef{Jet projections}{
        Let $M,N$ be smooth manifolds and consider the jet space $J^r(M,N)$. The \textbf{source} and \textbf{target projections} are defined as follows:
        \begin{gather}
            \begin{aligned}
                \pi_r&:J^r(M,N)\rightarrow M:j_p^rf\mapsto p\,,\\
                \pi_{r,0}&:J^r(M,N)\rightarrow N:j_p^rf\mapsto f(p)\,.
            \end{aligned}
        \end{gather}
        One can also define a \textbf{$k$-jet projection} $\pi_{r,k}$ as the map
        \begin{gather}
            \pi_{r,k}:J^r(M,N)\rightarrow J^k(M,N):j_p^rf\mapsto j_p^kf\,,
        \end{gather}
        where $k\leq r$. The $k$-jet projections satisfy the transitivity property $j_{k,m} = j_{r,m}\circ j_{k,r}$.
    }

    \newdef{Prolongation}{\index{prolongation}
        Let $f:M\rightarrow N$ be a smooth function. The $r$-jet prolongation $j^rf$ is defined as the following map:
        \begin{gather}
            j^rf:M\rightarrow J^r(M,N):p\mapsto j_p^rf\,.
        \end{gather}
    }

    \begin{property}[Topology]
        Every diffeomorphism $f:M\rightarrow M'$ induces a morphism of jet spaces $J^r(g,N):J^r(M',N)\rightarrow J^r(M,N)$ by pullback. Similarly, every smooth function $g:N\rightarrow N'$ induces a morphism of jet spaces $J^r(M,g):J^r(M,N)\rightarrow J^r(M,N')$ by pushforward.

        Now, consider two charts $(U,\varphi)$ and $(V,\psi)$ of $M$ and $N$, respectively. Construct the morphism
        \begin{gather}
            J^r(\varphi^{-1},\psi):=J^r(\varphi^{-1},V)\circ J^r(\varphi(U),\psi):J^r(U,V)\rightarrow J^r\bigl(\varphi(U),\psi(V)\bigr)\,.
        \end{gather}
        This morphism is invertible and, hence, can be used as a local chart. The topology on $J^r(M,N)$ is induced by the manifold topology corresponding to the maximal atlas of all such charts.
    \end{property}
    \newdef{Whitney $C^k$-topology}{\index{Whitney!$C^k$-topology}
        Let $M,N$ be two smooth manifolds and consider the manifold of $k$-jets $J^k(M,N)$. A basis for the Whitney $C^k$-topology on $C^\infty(M,N)$ is given by the sets
        \begin{gather}
            S^k(U) := \{f\in C^\infty(M,N)\mid j^kf\in U\}\,,
        \end{gather}
        where $U$ is open in $J^k(M,N)$.
    }
    \begin{property}
        When the manifold $M$ is compact, the Whitney and compact-open topologies on $C^\infty(M,N)$ coincide. In general, the Whitney topology is the topology of global uniform convergence.
    \end{property}

    \begin{remark}[Fibre bundles]
        The above definitions can also be used to define jet manifolds of (local) sections of bundles. One just sets $M=B$ and $N=E$ and restricts to the subset satisfying
        \begin{gather}
            j^r_{\sigma(p)}\pi\circ j^r_p\sigma=j^r_p\mathbbm{1}_M\,.
        \end{gather}
        This is just the prolongation of the definition of sections $\pi\circ\sigma=\mathbbm{1}_M$.

        The $r$-jet bundle corresponding to the projection $\pi$ is defined as the triple $(J^r(E),B,\pi_r)$. The bundle charts $(U_i,\varphi_i)$ on $E$ define induced bundle charts on $J^r(E)$ in the following way:
        \begin{align}
            U_i^r &:= \{j_p^r\sigma\mid\sigma(p)\in U_i\}\,\\
            \nonumber\\
            \varphi_i^r &:= \left(x^k,u^\alpha,\left.\mpderiv{I}{u^\alpha}{x}\right|_p\right)\,,
        \end{align}
        where $I$ is a multi-index such that $0\leq|I|\leq r$. The partial derivatives \[\left.\mpderiv{I}{u^\alpha}{x}\right|_p\] are called the \textbf{derivative coordinates} on $J^r(E)$.
    \end{remark}

    \newdef{Holonomic section}{\index{holonomic!section}
        Consider a fibre bundle $\pi:E\rightarrow M$. A (local) section $\sigma$ of $\pi$ gives rise to a (local) section of $\pi_r$ given by the $r$-jet prolongation of $\sigma$. Sections of $J^r(E)$ that lie in the image of $j^r$ are said to be holonomic.
    }

    \newdef{Infinite jet bundle}{
        The inverse limit (\cref{set:inverse_limit}) of the projections $\pi_{k,k-1}:J^k(E)\rightarrow J^{k-1}(E)$. It can be shown (in an algebro-geometric fashion) that the smooth functions on the infinite jet bundle $J^\infty(E)$ are (at least locally) given by smooth functions on some finite jet bundle. This just means that the infinite jet bundle is defined by taking its algebra of smooth functions to be the direct limit of those on the finite jet bundles. By extension, it can be shown that any smooth morphism $J^\infty(E)\rightarrow E'$ into a finite-dimensional manifold factorizes through a finite jet bundle. Furthermore, a map $Q\rightarrow J^\infty(E)$ or $J^\infty(E)\rightarrow J^\infty(E')$ is said to be smooth if the composition with any smooth map is again smooth.
    }

    \begin{property}[Jet comonad]\index{jet!comonad}
        The assignment of jet bundles constitutes a comonad: $J^\infty:\symbfsf{Bundle}(X)\rightarrow\symbfsf{Bundle}(X)$. The counit sends the prolongation of a section to the section evaluated at a point. The comultiplication reshuffles derivatives.
    \end{property}

\subsection{Contact structure}

    Every jet manifold $J^k$ carries a natural constact structure (\cref{contact:contact_structure}).
    \newdef{Contact form}{\index{contact!form}\index{Cartan!distribution}
        Given a fibre bundle $\pi:E\rightarrow M$ and one of its jet bundles $J^k(E)$, a differential form $\omega\in\Omega^\bullet(J^k(E))$ is called a contact form if it is annihilated by all jet prolongations, i.e.~$(j^{k+1}\sigma)^*\omega=0$ for all sections $\sigma\in\Gamma(E)$.

        The space of such contact forms generates a differential ideal and, in turn, defines a distribution, called the \textbf{Cartan distribution}. For finite-order jet spaces, this distribution is completely nonintegrable. However, for infinite jet bundles (where Frobenius's theorem need not hold), the distribution becomes involutive and integrable.

        Locally, the differential ideal is generated by the following contact forms:
        \begin{gather}
            \theta^\alpha_I := \symbfup{d}u^\alpha_I - \sum_\mu u^\alpha_{I,\mu}\symbfup{d}x^\mu\,,
        \end{gather}
        where the $x^\mu$ and $u^\alpha_I$ are the independent and dependent variables, respectively.
    }
    \begin{property}[Cartan connection]\index{Cartan!connection}
        There exists a connection on the infinite jet bundle $J^\infty(E)$ where the horizontal subbundle is exactly given by the Cartan distribution. This connection can be shown to be flat.
    \end{property}

\subsection{Differential operators}

    \newadef{Differential operator}{\index{differential!operator}\label{var:differential_operator}
        Let $E_1,E_2$ be smooth fibre bundles over the same base manifold $M$. A differential operator $\widetilde{D}:E_1\rightarrow E_2$ is a bundle morphism $J^\infty(E_1)\rightarrow E_2$. This induces a map of sections $D:\Gamma(E_1)\rightarrow\Gamma(E_2)$ such that $D=\widetilde{D}\circ j^\infty$. It is said to be of \textbf{order} $k\in\mathbb{N}$ if it factors through the $k$-jet bundle, i.e.~if $j^\infty$ can be replaced by $j^k$. If the bundle morphism $\widetilde{D}$ is a vector bundle morphism, the differential operator is said to be \textbf{linear}.

        This definition can easily be phrased in terms of the jet comonad. The category of differential operators is equivalent to the (co)Kleisli category (\cref{cat:kleisli_category}) of the jet comonad $J^\infty$.
    }

    \begin{property}[Formal adjoints]\index{adjoint!operator}\label{var:formal_adjoint}
        Consider two differential operators
        \begin{gather}
            D,D^\dagger:\Gamma(E)\rightarrow\Gamma\bigl(E^*\otimes\Lambda^{\dim(M)}(M)\bigr)\,.
        \end{gather}
        These operators are said to be formally adjoint if there exists a bilinear differential operator $K:\Gamma(E)\otimes\Gamma(E)\rightarrow\Omega^{\dim(M)}(M)$ such that the following condition is satisfied for all sections $\sigma_1,\sigma_2$ of $E$:
        \begin{gather}
            \langle D(\sigma_1),\sigma_2 \rangle - \langle\sigma_1,D^\dagger(\sigma_2)\rangle = \dr K(\sigma_1,\sigma_2)\,.
        \end{gather}
        This formula can be interpreted as a generalization of Green's identities. In the case where $M$ is compact, Stokes' theorem~\ref{bundle:stokes_theorem} shows that $D$ and $D^\dagger$ are related through integration by parts.
    \end{property}

    \newdef{Generalized vector field}{\index{vector field!generalized}
        Consider a vector bundle $\pi:E\rightarrow M$. A generalized vector field on $M$ is a `vector field' whose components are, locally, given by smooth functions on the infinite jet bundle $J^\infty(E)$, i.e.~it is a smooth map $X:J^\infty(E)\rightarrow TM$ and, hence, a smooth map $X:J^k(E)\rightarrow TM$ for some $k\in\mathbb{N}$ such that $X(\sigma)\in T_{\pi_k(\sigma)}M$.
    }

\section{\difficult{Variational bicomplex}}\label{section:variational_bicomplex}

    In this section, the language of jet bundles, as introduced in the previous section, will be used to rephrase the classical theory of variational calculus in more general geometric terms. A smooth function on the infinite jet bundle will be denoted by $f[u]$, i.e.~the arguments will be written inside square brackets.

\subsection{Differential structure}

    A smooth fibre bundle $\pi:E\rightarrow M$ over a base manifold $M$ will be considered.\footnote{In fact, the fibre bundle can be replaced with any fibred manifold.} First, the de Rham operator $\symbfup{d}$ on the infinite jet bundle $J^\infty(E)$ is decomposed in a horizontal and a vertical part:
    \begin{gather}
        \symbfup{d} = \dr+\delta\,.
    \end{gather}
    The \textbf{horizontal derivative} $\dr$ lifts the de Rham differential on $M$ to $E$ (hence the name). On smooth functions in $C^\infty(J^\infty(E))$, it acts as follows:
    \begin{gather}
        \dr f := (D_\mu f)\drx^\mu\,,
    \end{gather}
    where the \textbf{total derivative}\footnote{In fact, this formula is virtually the same as the one for the true total derivative. However, partial derivatives are replaced by jet coordinates.}\index{total!derivative}
    \begin{gather}
        D_\mu f := \pderiv{f}{x^\mu} + \pderiv{f}{u^\alpha}u^\alpha_{,\mu} + \pderiv{f}{u^\alpha_{,\nu}}u^\alpha_{,\nu\mu} + \cdots
    \end{gather}
    is introduced. The horizontal de Rham operator can be extended to all of $\Omega^\bullet(J^\infty(E))$ through the Leibniz property and the condition
    \begin{gather}
        \dr\circ\delta = -\delta\circ\dr\,,
    \end{gather}
    which follows from the nilpotency of the differentials. The differentials $\dr,\delta$ turn $\Omega^\bullet(J^\infty(E))$ into a bigraded complex, called the \textbf{variational bicomplex}.
    \begin{remark}
        Some authors use the term variational bicomplex for the bicomplex of \textbf{local forms} $\Omega^\bullet_\mathrm{loc}(M\times\Gamma(E))$, which is defined as the image of $\Omega^\bullet(J^\infty(E))$ under the prolongation map $M\times\Gamma(E)\rightarrow J^\infty(E)$. This way, they can work with forms over the (trivial) field bundle, while maintaining the property that all objects only depend on finite-order jets. Furthermore, when working in full generality the de Rham complex over $M$ is twisted by the orientation bundle (\cref{bundle:honest_density}).
    \end{remark}

    \newdef{Local Lagrangian}{\index{Lagrange!function}\index{local!functional}\label{var:local_lagrangian}
        A top-degree horizontal form on $J^\infty(E)$. Because $\Omega^{\dim(M),0}(J^\infty(E))$ is one-dimensional, such forms are proportional to the volume form:
        \begin{gather}
            \symbfsf{L} = L\vol\,,
        \end{gather}
        where $L$ is a smooth function on the infinite jet bundle. The function $L$ is called the \textbf{Lagrangian density}. By its very nature, this implies that $L$ locally only depends on partial derivatives up to some finite order.

        For any such horizontal form, one can define a functional on $\Gamma_c(M)$ as follows:
        \begin{gather}
            S:\phi\mapsto\Int_M(j^\infty\phi)^*\symbfsf{L}\,.
        \end{gather}
        Functions of this form are called \textbf{local functionals}.
    }

    Now, consider a (generalized) vector field $X$ on the total space $E$. This vector field can be lifted to $J^k(E)$ in a canonical way.
    \newdef{Prolongation of vector fields}{\index{prolongation}\label{var:prolongation}
        Given a generalized vector field $X$ on a fibre bundle $\pi:E\rightarrow M$, there exists a unique vector field $j^kE$ on the jet bundle $J^k(E)$ defined by the following conditions:
        \begin{enumerate}
            \item $X$ and $j^kX$ coincide on $C^\infty(E)$.
            \item $j^kX$ preserves the contact ideal, i.e.~if $\theta$ is a contact form, then $\mathcal{L}_{j^kX}\theta$ is also a contact form.
        \end{enumerate}
        Locally, the prolongation of a vector field
        \begin{gather}
            X = X^\mu\partial_\mu + X^\alpha\partial_\alpha
        \end{gather}
        is given by
        \begin{gather}
            (j^k X)^\alpha_I = D_I(X^\alpha - u^\alpha_\mu X^\mu) + u^\alpha_{\mu I}X^\mu
        \end{gather}
        for all $|I|\leq k$.
    }
    A similar definitions exists for vector fields on the base manifold.
    \newdef{Total vector field}{\index{total!vector field}
        Given a generalized vector field $X$ on $M$, its total vector field $\mathrm{tot}X$ is defined by the following conditions:
        \begin{enumerate}
            \item $X$ and $\mathrm{tot}X$ coincide on $C^\infty(M)$, and
            \item $\mathrm{tot}X\intmul\omega = 0$ if $\omega$ is a contact form.
        \end{enumerate}
        An explicit formula can be obtained by replacing partial derivatives by total derivatives:
        \begin{gather}
            X = X^\mu\partial_\mu\longrightarrow\mathrm{tot}X = X^\mu D_\mu\,.
        \end{gather}
        In particular, the total vector fields associated to a coordinate-induced basis $\partial_\mu$ are exactly the total derivatives $D_\mu$.
    }

    \newdef{Evolutionary vector field}{\index{evolutionary vector field}
        A generalized vector field that projects to 0 on the base manifold, i.e.~a $\pi$-vertical (generalized) vector field. The space of evolutionary vector fields on $E$ is denoted by $\mathrm{Ev}(J^\infty(E))$.

        The prolongation of an evolutionary vector field to $J^\infty(E)$ still projects to 0 on $M$. By extension, all vector fields on $J^\infty(E)$ that preserve the contact ideal and project to 0 on $M$ are called evolutionary vector fields. Such vector fields are of the form
        \begin{gather}
            X = X^\alpha_I[u]\partial^I_\alpha\,.
        \end{gather}
        The name stems from the fact that these vector fields define PDEs that (locally) describe the evolution of the fibres.

        The prolongation of an evolutionary vector field can be written as follows:
        \begin{gather}
            j^\infty X = \sum_{|I|=0}^{+\infty}(D_IX^\alpha)\partial^I_\alpha\,.
        \end{gather}
    }


    \begin{property}
        By writing out Cartan's magic formula \ref{bundle:cartan_magic_formula} with respect to $\symbfup{d}$, one can prove that the prolongation of an evolutionary vector field also satisfies this formula with respect to $\delta$ and that $\iota_{j^\infty X}$ and $\dr$ anticommute.
    \end{property}

    \begin{property}[Evolutionary decomposition]\index{characteristic}
        Consider a generalized vector field
        \begin{gather}
            X = X^\mu\partial_\mu + X^\alpha\partial_\alpha
        \end{gather}
        on $E$. By extending the $\mathrm{tot}$-construction to generalized vector fields as
        \begin{gather}
            \mathrm{tot}X:=\mathrm{tot}(\pi_*X)\,,
        \end{gather}
        one can define the evolutionary part of $X$ as follows:
        \begin{gather}
            X_\mathrm{ev}:=X-(\pi_{\infty,0})_*(\mathrm{tot}X)\,.
        \end{gather}
        Locally, this can be written as
        \begin{gather}
            X_\mathrm{ev} = \left(X^\alpha - u^\alpha_\mu X^\mu\right)\partial_\alpha\,.
        \end{gather}
        Using this definition, the prolongation of $X$ can be decomposed as follows:
        \begin{gather}
            j^\infty X = j ^\infty X_\mathrm{ev} + \mathrm{tot}X\,.
        \end{gather}
        The evolutionary part is sometimes also called the \textbf{characteristic} of $X$.
    \end{property}

    To close this section, the Cartan calculus of the variational bicomplex is summarized.
    \begin{formula}[Cartan calculus]
        Let $X,Y$ denote a generalized vector field and an evolutionary vector field, respectively.
        \begin{enumerate}
            \item Exterior derivatives:
                \begin{align}
                    \drx^\mu &= \symbfup{d}x^\mu\,,\\
                    \delta u^\alpha_I &= \symbfup{d}u^\alpha_I - u^\alpha_{I\mu}\drx^\mu\,.
                \end{align}
            \item Interior product:
                \begin{gather}
                    \{\dr,\iota_{j^\infty Y}\}_+ = 0\,.
                \end{gather}
            \item Lie derivatives:
                \begin{align}
                    \mathcal{L}_{j^\infty X} &= \symbfup{d}\iota_{j^\infty X} + \iota_{j^\infty X}\symbfup{d}\,,\\
                    \mathcal{L}_{j^\infty Y} &= \delta\iota_{j^\infty Y} + \iota_{j^\infty Y}\delta\,,\\
                    [\dr,\mathcal{L}_{j^\infty Y}] &= [\delta,\mathcal{L}_{j^\infty Y}] = 0\,.
                \end{align}
        \end{enumerate}
    \end{formula}

\subsection{Euler operators}

    \begin{property}[Total differential operators]\index{differential!operator}\index{Euler!operator}
        A differential operator $P:\mathrm{Ev}(J^\infty(E))\rightarrow\Omega^\bullet(J^\infty(E))$ that can locally be written as
        \begin{gather}
            P(X) = \sum_{|I|=0}^k\left(D_IX^\alpha\right)P^I_\alpha
        \end{gather}
        for some differential forms $P^I_\alpha$. By (formally) integrating by parts, this can locally be written as
        \begin{gather}
            P(X) = \sum_{|I|=0}^kD_I\left(X^\alpha Q^I_\alpha\right)\,,
        \end{gather}
        where the smooth forms $Q^I_\alpha$ can be expressed as follows:
        \begin{gather}
            \label{var:Q_forms}
            Q^I_\alpha = \sum_{|J|=0}^{k-|I|}\binom{|I|+|J|}{|J|}(-1)^{|J|}D_JP^{IJ}_\alpha\,.
        \end{gather}
        The zeroth-order part $Q_\alpha$ also defines a total differential operator:
        \begin{gather}
            E_P(X) := X^\alpha Q_\alpha\,.
        \end{gather}
        This operator is called the \textbf{Euler operator} (associated to $P$).
    \end{property}

    \begin{property}[Decomposition of total differential operators]\label{var:differential_operator_decomposition}
        Consider a total differential operator $P:\mathrm{Ev}(J^\infty(E))\rightarrow\Omega^{\dim(M),k}(J^\infty(E))$. The Euler operator $E_P$ is the unique globally defined (zeroth order) operator such that, on each chart $U$, one can find a total differential operator $R_U$ that satisfies the following equation:
        \begin{gather}
            P(X) = E_P(X) + \dr R_U(X)\,.
        \end{gather}
        The operator $R_U$ can locally be expressed as follows:
        \begin{gather}
            R_U(X) = \sum_{|I|=0}^{k-1}D_I\left(X^\alpha D_\mu\intmul Q^{\mu I}_\alpha\right)\,.
        \end{gather}
        The decomposition above can, in fact, be shown to hold globally. However, in that case, the expression of $R$ cannot be expressed easily in terms of the coefficients of $P$ (only for $P$ of order 2 does a canonical expression exist).
    \end{property}

    \begin{example}[Euler--Lagrange operator]\index{Euler--Lagrange!operator}\index{Lie--Euler operator}\index{on-shell}
        Consider a local Lagrangian $\symbfsf{L}$. This form induces a total differential operator as follows:
        \begin{gather}
            P_{\symbfsf{L}}(X) := \mathcal{L}_{j^\infty X}\symbfsf{L} = \sum_{|I|=0}^k(D_IX^\alpha)(\partial^I_\alpha L)\vol\,.
        \end{gather}
        The coefficients~\eqref{var:Q_forms} associated to this operator are given by the following formula (to turn these coefficients into true differential forms, one should multiple them by the volume form):
        \begin{gather}
            \label{var:lie_euler_operator}
            E^I_\alpha(L) := \sum_{|J|=0}^{k-|I|}\binom{|I|+|J|}{|J|}(-1)^{|J|}D_J\left(\partial^{IJ}_\alpha L\right)\,.
        \end{gather}
        The induced Euler operator is exactly the Euler--Lagrange operator associated to variational problems. For this reason, and the fact that they are induced by a Lie derivative, the coefficients $E^I_\alpha$ are called \textbf{Lie--Euler operators}.

        Given a local Lagrangian $\symbfsf{L}$, its \textbf{Euler--Lagrange form} is defined as
        \begin{gather}
            \delta_{\text{EL}}\symbfsf{L} := E_\alpha(L)\delta u^\alpha\wedge\vol\,.
        \end{gather}
        An explicit formula for the Euler--Lagrange derivative is given by the following formula (this is just \cref{var:lie_euler_operator} for $|I|=0$):
        \begin{gather}
            \label{var:euler_lagrange_derivative}
            \delta_{\text{EL}}L := \left(\pderiv{L}{u^\alpha} - D_\mu\pderiv{L}{u^\alpha_\mu} + \cdots\right)\delta u^\alpha\,.
        \end{gather}
        The set of functions that satisfy $\delta_{\text{EL}}L=0$ is called the \textbf{shell}. The functions for which also all higher-order derivatives vanish, i.e.~the elements of $\{x\in J^\infty(E)\mid\forall I:D_I\delta_{\text{EL}}L(x) = 0\}$, are said to be \textbf{on-shell}.
    \end{example}

    \begin{property}[Naturality]
        The Euler--Lagrange operators are natural operators in the following sense:
        \begin{itemize}
            \item $\delta_{\text{EL}}|_p$ only depends on the germ at $p\in J^\infty(E)$.
            \item If $\phi:E\rightarrow E'$ is fibre-preserving, then
                \begin{gather}
                    \label{var:naturality}
                    \delta_{\text{EL}}((j^\infty\phi)^*\symbfsf{L}) = (j^\infty\phi)^*(\delta_{\text{EL}}(\symbfsf{L}))\,.
                \end{gather}
        \end{itemize}
        It can be shown that $\delta_{\text{EL}}$ is the unique (up to scaling) linear, natural differential operator from $\Omega^{\dim(M),0}(J^\infty(E))$ to $\Omega^{\dim(M),1}(J^\infty(E))$.
    \end{property}

    The following property generalizes the property that the Euler--Lagrange equations remain invariant under addition of a divergence to the Lagrangian.
    \begin{property}[Divergences]\label{var:EL_operator_divergences}
        If a smooth function is locally an order-$k$ divergence, i.e.~$f=D_IA^I$ for smooth functions $A^I$ and $|I|=k$, the Lie--Euler operators $E^J_\alpha$ vanish on $f$ for all $|J|<k$.
    \end{property}

    \begin{property}[Local variational formula]\index{variational!formula}\label{var:local_variational_formula}
        Decomposition \ref{var:differential_operator_decomposition} shows that the Euler--Lagrange operator is the unique operator such that locally, for all local Lagrangians $\symbfsf{L}$ and all evolutionary vector fields $X$, the following equation holds
        \begin{gather}
            \mathcal{L}_{j^\infty X}\symbfsf{L} = j^\infty X\intmul\delta_\mathrm{EL}(\symbfsf{L}) + \dr(j^\infty X\intmul\gamma)
        \end{gather}
        for some $\gamma\in\Omega^{\dim(M)-1,1}(J^\infty(E))$.
    \end{property}

\subsection{Functional complex}

    \begin{example}[Interior Euler operator]\index{Euler!operator}\index{functional!form}
        For every smooth form $\omega\in\Omega^{p,q}(J^\infty(E))$, one can define a total differential operator as follows:
        \begin{gather}
            P_\omega(X) := j^\infty X\intmul\omega\,.
        \end{gather}
        As for the previous example, this operator induces (higher) Euler operators:
        \begin{gather}
            \label{var:interior_euler_operators}
            F^I_\alpha(\omega) := \sum_{|J|=0}^{k-|I|}\binom{|I|+|J|}{|J|}(-1)^{|J|}D_J\left(\partial^{IJ}_\alpha\intmul\omega\right)\,.
        \end{gather}
        Since, in this case, they arise from interior multiplication, they are called interior Euler operators. For $p=\dim(M)$, one again obtains a globally defined Euler operator (also called the interior Euler operator):
        \begin{gather}
            I(\omega) := \frac{1}{q}\delta u^\alpha\wedge F_\alpha(\omega)\,.
        \end{gather}
        The interior Euler operator defines a sequence of spaces, the so-called spaces of \textbf{functional forms}, as follows:
        \begin{gather}
            \label{var:functional_complex}
            \mathcal{F}^q(J^\infty(E)) := \left\{\omega\in\Omega^{\dim(M),q}(J^\infty(E))\,\middle\vert\,I(\omega)=\omega\right\}\,.
        \end{gather}
    \end{example}
    \begin{property}\label{var:I_properties}\index{Helmholtz!operator}
        The interior Euler operator has the following important properties:
        \begin{itemize}
            \item $I$ is a projection $I^2=I$.
            \item $I$ vanishes on (locally) $\dr$-exact forms.
            \item $\delta_V := I\circ\delta$ endows $\mathcal{F}^\bullet(J^\infty(E))$ with the structure of a cochain complex. It is sometimes called the \textbf{Helmholtz operator}.
            \item $\delta_{\text{EL}}\symbfsf{L} = \delta_V\symbfsf{L}$ for all local Lagrangians $\symbfsf{L}$.
        \end{itemize}
    \end{property}
    \begin{result}\label{var:EL_operator_properties}
        The Euler--Lagrange operator $\delta_{\text{EL}}$ vanishes on locally $\dr$-exact forms and commutes with the Lie derivative of projectable vector fields.
    \end{result}

    The degree-$2$ functional forms also admit a local characterization:
    \begin{property}[Local expression for $\mathcal{F}^2$]
        Consider a collection of smooth functions $A^I_{\alpha\beta}\in C^\infty(J^\infty(U))$ on some chart $U\subset E$ that satisfy
        \begin{gather}
            A^I_{\alpha\beta} = (-1)^{|I|+1}A^I_{\beta\alpha}\,.
        \end{gather}
        The local $(\dim(M),2)$-form
        \begin{gather}
            w^{|I|} := \delta u^\alpha\wedge\left(A^I_{\alpha\beta}\delta u^\beta_I + D_I(A^I_{\beta\alpha}\delta u^\beta)\right)\wedge\vol
        \end{gather}
        is an element of $\mathcal{F}^2(J^\infty(U))$. Furthermore, every degree-$2$ functional form can locally be expressed as a sum of the form
        \begin{gather}
            \omega = w^0 + w^1 + w^2 + \cdots\,.
        \end{gather}
    \end{property}

    Although local characterizations for functional forms $\omega\in\mathcal{F}^q(J^\infty(E))$ with $q\geq2$ are still not well understood, there exists a more high-level characterization.
    \begin{property}[General characterization]
        A form $\omega\in\Omega^{\dim(M),q}(J^\infty(E))$ is functional if and only if there exists a linear, \textbf{formally skew-adjoint}\footnotemark\ differential operator \[P:\mathrm{Ev}(J^\infty(E))\rightarrow\Omega^{\dim(M),q-1}(J^\infty(E))\] such that
        \begin{gather}
            \omega = \delta u^\alpha\wedge P_\alpha\,.
        \end{gather}
        This representation is unique if it exists.
        \footnotetext{This is a generalization of \cref{var:formal_adjoint}. $P$ is said to be formally skew-adjoint if there exists an $(m-1,q-1)$-form $K$ such that
        \begin{gather}
            j^\infty X\intmul P(Y) + j^\infty Y\intmul P(X) = \dr K
        \end{gather}
        for all $X,Y\in\mathrm{Ev}(J^\infty(E))$.}
    \end{property}

    The forms in $\mathcal{F}^q$ are said to be functional due to the following property.
    \begin{property}[Functionals]\index{degree!functional}\label{var:functionals}
        To every smooth $k$-form $\omega\in\Omega^\bullet(J^\infty(E))$, compact subset $K\subset E$ and $q:=k-\dim(M)$ generalized vector fields on $E$, one can assign a functional on $\Gamma(U)$, where $U$ is a chart containing $K$, by the following formula:
        \begin{gather}
            W_\omega(X_1,\ldots,X_q)[\sigma] := \Int_K(j^\infty\sigma)^*\omega(j^\infty X_1,\ldots,j^\infty X_q)\,.
        \end{gather}
        The integer $q$ is called the \textbf{degree} of $W_\omega$. In general, these functionals are invariant under the addition of a $\dr$-exact form. However, the assignment $\omega\mapsto W_\omega$ is a bijection for fixed $K$ and $X_i$.
    \end{property}
    \begin{construct}
        The differential $\delta_V$ on $\mathcal{F}^\bullet$ induces a differential on the space of functionals of the above form:
        \begin{gather}
            \delta W_\omega := W_{\delta_V\omega}\,.
        \end{gather}
        An equivalent definition can be given by a formula similar to \cref{bundle:k_form_exterior_derivative}, where an evolutionary vector field $X$ acts on a degree-$0$ functional by Lie derivation:
        \begin{gather}
            X(W_\omega[\sigma]) := \int_V(j^\infty\sigma)^*(\mathcal{L}_{j^\infty X}\omega)\,.
        \end{gather}
    \end{construct}

\subsection{Structure of the bicomplex}

    A well-defined morphism of variational bicomplexes should preserve the bigrading of forms, but this will clearly not be the case in general. Therefore, a `projected pullback' can be introduced:
    \begin{gather}
        \Phi^\sharp:\Omega^{p,q}(J^\infty(E'))\rightarrow\Omega^{p,q}(J^\infty(E)):\omega\mapsto\pi^{p,q}(\Phi^*\omega)\,.
    \end{gather}
    Here, the projection $\pi^{p,q}$ is the projection of the variational bicomplex, not the one of jet bundles (which is denoted by subscripts).
    \begin{remark}\label{var:degree_raise_remark}
        The projection $\pi^{p,q}:\Omega^{p+q}(J^\infty(E))\rightarrow\Omega^{p,q}(J^\infty(E))$ is defined by substituting $\symbfup{d}u^\alpha_I\longrightarrow\delta u^\alpha_I + u^\alpha_{\mu I}\drx^\mu$ and then projecting onto the correct horizontal and vertical degrees. Note that this does not preserve the order of forms due to the presence of the factor $u^\alpha_{\mu I}$.
    \end{remark}

    The main argument for introducing the projected pullback is that functionals of the form of \cref{var:functionals} only care about $(m,q)$-forms for a specific $q$ (in particular \textbf{action functionals}, i.e.~$q=0$).\index{action}

    \begin{formula}[Local Lagrangians]
        For local Lagrangians $\symbfsf{L}\equiv L\vol_{E'}$, the projected pullback acts as follows:
        \begin{gather}
            \Phi^\sharp\symbfsf{L} = (L\circ\Phi)\det(D_\mu f^\mu)\vol_E\,,
        \end{gather}
        where $\pi'(\Phi[u])=(f^\mu)$. So, one obtains the usual formula for pullbacks of top-dimensional forms, but with partial derivatives replaced by total derivatives.
    \end{formula}

    An important property of the de Rham differential is its naturality (\cref{bundle:exterior_derivative_properties}). The following property states the `naturality' of the different operators on the variational bicomplex with respect to the projected pullback.
    \begin{property}
        Consider a morphism $\Phi:J^\infty(E)\rightarrow J^\infty(E')$.
        \begin{itemize}
            \item $\Phi^\sharp$ and $\delta$ commute if and only if $\Phi$ covers a morphism of the base manifolds.
            \item $\Phi^\sharp$ and $\dr$ commute if and only if $\Phi^*$ is a contact transformation.
            \item $\Phi^\sharp$ commutes with both differentials if and only if it coincides with $\Phi^*$
        \end{itemize}
        Furthermore, the projected pullback defines a contravariant functor on the subcategory on morphisms that satisfy at least one of the above properties.
    \end{property}

    The following property gives an infinitesimal analogue of the above considerations.
    \begin{property}
        Consider a vector field $X$ on $J^\infty(E)$. Its Lie derivative will, in general, not respect the bigrading of the variational bicomplex (unless $X$ is evolutionary) and, therefore, the `projected Lie derivative' is introduced:
        \begin{gather}
            \mathcal{L}^\sharp_X:\Omega^{p,q}(J^\infty(E))\rightarrow\Omega^{p,q}(J^\infty(E)):\omega\mapsto\pi^{p,q}(\mathcal{L}_X\omega)\,.
        \end{gather}
        This operator satisfies the following properties:
        \begin{itemize}
            \item It commutes with $\delta$ if and only if $X$ is $\pi_\infty$-related to a vector field on $M$.
            \item It commutes with $\dr$ if and only if $X$ is the prolongation of a generalized vector field on $E$.
        \end{itemize}
        Note that this does not simply follow from the previous property since $X$ does not necessarily define a flow on $J^\infty(E)$.
    \end{property}

    Aside from the differentials on the variational bicomplex, one should also look at the structure of the functional complex $(\mathcal{F}^\bullet,\delta_V)$ in~\eqref{var:functional_complex}. It can be shown that requiring both $[I,\Phi^\sharp]=0$ and $[\delta,\Phi^\sharp]=0$ is very restrictive. Furthermore, a complete characterization of those morphisms $\Phi$ that satisfy only $[I,\Phi^\sharp]=0$ is not fully understood. However, the infinitesimal version is easier to handle since it only involves linear equations:
    \begin{property}
        Let $n\in\mathbb{N}$ be the rank of $E$ and consider a vector field $X$ on $J^\infty(E)$.
        \begin{itemize}
            \item If $n=1$, then $\mathcal{L}^\sharp_X$ commutes with $I$ if and only if $X$ is locally the prolongation of a generalized vector field on $E$ of the form
            \begin{gather}
                Y = -\pderiv{S}{u_\mu}\partial_\mu + \left(S - u_\mu\pderiv{S}{u_\mu}\right)\partial_u\,,
            \end{gather}
            where $S$ is a function on the first jet bundle $J^1(U)$.
            \item If $n>1$, then $\mathcal{L}^\sharp_X$ commutes with $I$ if and only if $X$ is the prolongation of a vector field on $E$.
        \end{itemize}
    \end{property}

    The next step is to define operators that do preserve the functional complex. To this end, the projection property of $I$ is used:
    \begin{gather}
        \begin{aligned}
            \Phi^\natural &: \Omega^{m,q}(J^\infty(E))\rightarrow\mathcal{F}^q(J^\infty(E')):\omega\mapsto(I\circ\Phi^\sharp)\omega\,,\\
            \mathcal{L}^\natural_X &: \Omega^{m,q}(J^\infty(E))\rightarrow\mathcal{F}^q(J^\infty(E)):\omega\mapsto(I\circ\mathcal{L}^\sharp_X)\omega\,.
        \end{aligned}
    \end{gather}

    \begin{property}
        These operators satisfy the following properties:
        \begin{itemize}
            \item If $\Phi$ is a contact transformation, then $\Phi^\natural$ commutes with both $I$ and $\delta_V$.
            \item If $X$ is a generalized vector field on $E$, then $\mathcal{L}^\natural_{j^\infty X}$ commutes with both $I$ and $\delta_V$.
            \item $\Phi^\natural$ preserves locally variational forms.
        \end{itemize}
    \end{property}
    The projected and functionally projected operators also satisfy the following relations.
    \begin{property}[Euler--Lagrange operator]\index{Euler--Lagrange!operator}\label{var:projected_derivative_EL_operator}
        Consider a local Lagrangian $\symbfsf{L}$. If $\Phi$ is a contact transformation, then
        \begin{gather}
            \delta_{\text{EL}}(\Phi^\sharp\symbfsf{L}) = \Phi^\natural(\delta_{\text{EL}}\symbfsf{L})\,.
        \end{gather}
        If $X$ is a generalized vector field, then
        \begin{gather}
            \delta_{\text{EL}}(\mathcal{L}^\sharp_{j^\infty X}\symbfsf{L}) = \mathcal{L}^\natural_{j^\infty X}(\delta_{\text{EL}}\symbfsf{L})\,.
        \end{gather}
    \end{property}

    \begin{formula}[Functionally projected Lie derivative]
        Let $X$ be a generalized vector field on $E$ and let $\omega\in\mathcal{F}^\bullet(J^\infty(E))$ be a functional form.
        \begin{gather}
            \mathcal{L}^\natural_{j^\infty X}\omega = \delta_V(j^\infty X_\mathrm{ev}\intmul\omega) + I(j^\infty X_\mathrm{ev}\intmul\delta_V\omega)
        \end{gather}
        For projectable vector fields, one can replace the left-hand side by the ordinary Lie derivative $\mathcal{L}_{j^\infty X}\omega$.
    \end{formula}

    In the remainder of this section, the homological properties of the variational bicomplex over a local chart (or equivalently, over a trivial bundle) will be studied. To prove the acyclicity of the various subcomplexes, the usual approach of finding a null-homotopy (\cref{homalg:null_acyclic}) will be followed, i.e.~a cochain map will be found $h:C_\bullet\rightarrow C_\bullet$ such that
    \begin{gather}
        \mathbbm{1} = \dr\circ h + h\circ\dr\,.
    \end{gather}

    \begin{property}[Vertical complex is exact]
        Homotopy operators $h^{p,q}_V:\Omega^{p,q}\rightarrow\Omega^{p,q-1}$ for the vertical complex
        \begin{gather}
            0\longrightarrow\Omega^p(M)\overset{\pi_\infty^*}{\longrightarrow}\Omega^{p,0}\overset{\delta}{\longrightarrow}\Omega^{p,1}\overset{\delta}{\longrightarrow}\cdots
        \end{gather}
        are given by the following formula
        \begin{gather}
            h^{p,q}_V(\omega) = \Int_0^1\frac{1}{t}\Phi^*_{\log t}(j^\infty R\intmul\omega)\,dt\,,
        \end{gather}
        where $R:=u^\alpha\partial_\alpha$ is the (vertically) radial vector field and $\Phi_\varepsilon:(x,u)\mapsto(x,e^\varepsilon u)$. It is not too difficult to check that, for source forms, this gives rise to \cref{var:trivial_helmholtz}.
    \end{property}
    The analogous statement for the horizontal complex is a bit more involved.
    \begin{property}[Augmented horizontal complex is exact]
        Homotopy operators $h^{p,q}_H:\Omega^{p,q}\rightarrow\Omega^{p-1,q}$ for the augmented horizontal complex
        \begin{gather}
            0\longrightarrow\Omega^{0,q}\overset{\dr}{\longrightarrow}\Omega^{1,q}\overset{\dr}{\longrightarrow}\cdots\overset{\dr}{\longrightarrow}\Omega^{\dim(M),q}\overset{I}{\longrightarrow}\mathcal{F}^q\overset{I}{\longrightarrow}0
        \end{gather}
        are given by the following formula
        \begin{gather}
            h^{p,q}_H(\omega) = \frac{1}{q}\sum_{|I|=0}^{k-1}\frac{|I|+1}{m-p+|I|+1}D_I\left(\delta u^\alpha\wedge F^{I\mu}_\alpha(D_\mu\intmul\omega)\right)\,,
        \end{gather}
        where the $F^I_\alpha$ are the interior Euler operators~\eqref{var:interior_euler_operators}.
    \end{property}
    \begin{result}[Functional decomposition]\label{var:functional_decomposition}
        The de Rham spaces on $J^\infty(E)$ admit the following decomposition:
        \begin{gather}
            \Omega^{p,q}(J^\infty(E)) = \dr\Omega^{p-1,q}(J^\infty(E))\oplus\mathcal{F}^q(J^\infty(E))\,,
        \end{gather}
        where the functional part is obtained by applying $I$ to a form.
    \end{result}

    Using the above properties, one can prove the acyclicity of the \textbf{Euler--Lagrange complex} $\mathcal{E}$ (again, over a local chart):
    \begin{gather}
        0\longrightarrow\mathbb{R}\longrightarrow\Omega^{0,0}\overset{\dr}{\longrightarrow}\Omega^{1,0}\overset{\dr}{\longrightarrow}\cdots\overset{\dr}{\longrightarrow}\Omega^{\dim(M),0}\overset{\delta_\mathrm{EL}}{\longrightarrow}\mathcal{F}^1\overset{\delta_V}{\longrightarrow}\mathcal{F}^2\overset{\delta_V}{\longrightarrow}\cdots\,.
    \end{gather}
    Explicit formulas are not shown since these are too complicated for the current objective. See~\cite{anderson_variational_1992} for a full account.

    \begin{remark}[Minimal solutions]
        Although the (local) exactness of the variational bicomplex is stated, it should be noted that this is not an optimal solution. Consider the example of locally variational source forms (see the next two sections), i.e.~differential forms of the form $\delta_{\text{EL}}\symbfsf{L}$. From the form of the homotopy operator $\mathcal{F}^1\rightarrow\Omega^{m,0}$, it should be clear that an order-$k$ source form is mapped to an order-$k$ Lagrangian. However, the Euler--Lagrange operator $\delta_{\text{EL}}$ will, in general, map order-$l$ Lagrangians to order-$2l$ source forms. Hence, it can be seen that the homotopy operator will, in general, not give Lagrangians of minimal order.
    \end{remark}

\subsection{Variational problems}

    The forms in $\mathcal{F}^1$ admit the following characterization.
    \newdef{Source form}{\index{source!form}
        A differential form $\omega\in\Omega^{\dim(M),1}(J^\infty(E))$ such that the evaluation on a vector field only depends on the projection $(\pi_{\infty,0})_*X\in TE$. After pulling back along the prolongation map $j^\infty$, this can be written as follows:
        \begin{gather}
            \Omega^{\dim(M),1}_{\text{source}}(E) := \delta C^\infty(E)\wedge\Omega^{\dim(M),0}(E)\,.
        \end{gather}
        Locally, it can be written as
        \begin{gather}
            \omega = \omega_\alpha(x,u,u_I)\delta u^\alpha\wedge\vol\,.
        \end{gather}
        The PDEs associated to the source form $\omega$ are called \textbf{source equations}.
    }
    \begin{remark*}
        In fact, one can extend the above definition to all of $\Omega^{\bullet,1}(J^\infty(E))$. So, in general, $\mathcal{F}^1$ is only a subspace of the space of source forms.
    \end{remark*}

    \begin{property}[First variational formula]\index{variational!formula}
        In \cref{var:local_variational_formula}, it was shown that the Euler--Lagrange operator locally satisfies
        \begin{gather}
            \mathcal{L}_{j^\infty X}\symbfsf{L} = j^\infty X\intmul\delta_{\text{EL}}\symbfsf{L} + \dr(j^\infty X\intmul\gamma)
        \end{gather}
        for some locally defined form $\gamma$ that can be constructed from the Lie--Euler operators of $\symbfsf{L}$. Using Cartan's magic formula and the fact that $\symbfsf{L}$ is horizontal, this can be rewritten in terms of differentials. Moreover, using \cref{var:functional_decomposition}, one can find a globally defined form that still satisfies the same formula (with the disadvantage that it does not admit a canonical expression):
        \begin{gather}
            \label{var:first_variational_formula}
            \delta\symbfsf{L} = \delta_{\text{EL}}\symbfsf{L} + \dr\sigma\,.
        \end{gather}
        This formula is often called the first variational formula for the following reason. Given a local Lagrangian $\symbfsf{L}$, one can look at solutions of the associated variational principle obtained by extremizing over perturbations of a field configuration. Such perturbations are generated by evolutionary vector fields and, hence, one can write the extremality condition as
        \begin{gather}
            \forall X\in\mathrm{Ev}(J^\infty(E)):\mathcal{L}_{j^\infty X}\symbfsf{L} = 0\,.
        \end{gather}
        \Cref{var:first_variational_formula} then becomes:
        \begin{gather}
            \delta_\mathrm{EL}\symbfsf{L} + \dr\sigma = 0\,.
        \end{gather}
        So, up to boundary contributions, the first variational formula says that extremality of the local Lagrangian (globally) corresponds to the vanishing of the Euler--Lagrange operator.
    \end{property}
    \begin{result}[Global variational formula]\label{var:general_variational_formula}
        The variational formula can also be extended to all generalized vector fields:
        \begin{gather}
            \mathcal{L}^\sharp_{j^\infty X}\symbfsf{L} = X_{\text{ev}}\intmul\delta_{\text{EL}}(\symbfsf{L}) + \dr\sigma
        \end{gather}
        for some $\sigma\in\Omega^{\dim(M),0}(J^\infty(E))$.
    \end{result}

    \newdef{Lepage form}{\index{Lepage equivalent}
        A $\dim(M)$-form $\rho\in\Omega^\bullet(J^\infty(E))$ such that
        \begin{gather}
            \pi^{\dim(M),0}(X\intmul\symbfup{d}\rho)=0
        \end{gather}
        for all $\pi_{\infty,0}$-vertical vector fields $X$. Given a local Lagrangian $\symbfsf{L}\in\Omega^{\dim(M),0}(J^\infty(E))$, $\symbfsf{L}$ and $\rho$ are said to be Lepage equivalent if $\pi^{\dim(M),0}\rho = \symbfsf{L}$.
    }
    \begin{property}[Lepage equivalent]
        Consider the first variational formula for a local Lagrangian $\symbfsf{L}$. A Lepage equivalent is given by the form $\symbfsf{L}+\gamma$.
    \end{property}

    \newdef{Distinguished symmetry}{\index{symmetry!distinguished}
        A distinguished (generalized) symmetry of a source form $\Delta\in\mathcal{F}^1(J^\infty(E))$ is a generalized vector field $X$ on $E$ such that
        \begin{gather}
            \mathcal{L}^\natural_{j^\infty X}\Delta = 0\,.
        \end{gather}
        As with the formula above, one can replace the projected Lie derivative by an ordinary Lie derivative when $X$ is projectable.
    }
    If the source form comes from a local Lagrangian, the above definition admits a specific case by \cref{var:projected_derivative_EL_operator} and the fact that $\delta_\mathrm{EL}$ annihilates $\dr$-exact forms (\cref{var:EL_operator_properties}).
    \newdef{Bessel-Hagen symmetry}{\index{symmetry!Bessel-Hagen}\index{divergence!symmetry}\label{var:bessel_hagen}
        A Bessel-Hagen or \textbf{divergence} symmetry of a Euler--Lagrange form $\delta_{\text{EL}}(\symbfsf{L})$ is a generalized vector field $X$ such that
        \begin{gather}
            \mathcal{L}^\sharp_{j^\infty X}\symbfsf{L} = \dr\eta
        \end{gather}
        for some $\eta\in\Omega^{\dim(M),0}(J^\infty(E))$.

        If this condition holds locally, distinguished symmetries and Bessel-Hagen symmetries coincide. However, if the Bessel-Hagen condition is required to hold globally, the Bessel-Hagen symmetries form only a subset of the distinguished symmetries.
    }

    \newdef{Local conservation law}{\index{conservation law}
        A generator of a local conservation law of a source form $\Delta\in\mathcal{F}^1(J^\infty(E))$ is an evolutionary vector field $X$ such that
        \begin{gather}
            \delta_{\text{EL}}(j^\infty X\intmul\Delta) = 0
        \end{gather}
        or, again by \ref{var:EL_operator_properties},
        \begin{gather}
            X\intmul\Delta = \dr\eta
        \end{gather}
        for some local $\eta\in\Omega^{\dim(M),0}(J^\infty(E))$. \Cref{var:general_variational_formula} shows that to every \underline{global} (generalized) symmetry, there corresponds a \underline{global} conservation law.
    }
    \begin{remark}
        Note that the Bessel-Hagen/divergence symmetries are symmetries of the source form, while the local symmetries coming from the first variational formula exist on the level of local Lagrangians.
    \end{remark}

    \begin{property}[Lie algebra of symmetries]
        Given a source form $\Delta\in\mathcal{F}^1(J^\infty(E))$, one can equip the vector space of generalized vector fields satisfying the following two conditions with the structure of a Lie algebra:
        \begin{itemize}
            \item They are distinguished symmetries.
            \item Their evolutionary part is a generator of local conservation laws.
        \end{itemize}
    \end{property}
    \begin{theorem}[Noether]\index{Noether}
        If $\Delta\in\mathcal{F}^1(J^\infty(E))$ is locally variational, a generalized vector field on $E$ is a distinguished symmetry if and only if its evolutionary part is a generator of local conservation laws.
    \end{theorem}

\subsection{Inverse problem}\label{section:inverse_problem}

    The inverse problem in the calculus of variations consists of determining when a given system of PDEs can be obtained from a variational problem, i.e.~when a source form $\Delta$ can be written in the form $\delta_{\text{EL}}\symbfsf{L}$, these are said to be \textbf{locally variational}.

    \textit{Helmholtz} was the first to study the inverse problem, so the following sufficient conditions are named after him.
    \begin{property}[Helmholtz conditions]\index{Helmholtz!conditions}\index{variational!form}
        By applying the Euler--Lagrange operator $\delta_{\text{EL}}$ to its defining variational formula (\cref{var:local_variational_formula}) and using the (infinitesimal) naturality condition~\eqref{var:naturality} and the fact that it annihilates $\dr$-exact forms (\cref{var:EL_operator_properties}), it can be seen that a source form $\Delta$ can be obtained from a local Lagrangian if
        \begin{gather}
            \mathcal{L}_{j^\infty X}\Delta = \delta_{\text{EL}}(X\intmul\Delta)
        \end{gather}
        is satisfied for all evolutionary vector fields $X$. This can also be rewritten in terms of the Helmholtz operator $\delta_V$ (hence its name):\footnote{This expression also immediately follows from \cref{var:I_properties}.}
        \begin{gather}
            \delta_V\Delta = 0\,.
        \end{gather}
    \end{property}
    \begin{formula}[Local expression]
        Consider a source form that admits the local expression \[\Delta=P_\alpha\delta u^\alpha\wedge\vol\,.\] The Helmholtz conditions can locally be expressed as follows:
        \begin{gather}
            (-1)^{|I|}\partial^I_\alpha P_\beta = E^I_\beta(P_\alpha)\,,
        \end{gather}
        where the $E^I_\beta$ are the Lie--Euler operators~\eqref{var:lie_euler_operator}.
    \end{formula}

    \begin{example}[Volterra--Vainberg formula]\index{Volterra--Vainberg formula}
        If $E$ is trivial and $\Delta=F_\alpha\delta u^\alpha\wedge\vol$ satisfies the Helmholtz conditions, then
        \begin{gather}
            \label{var:trivial_helmholtz}
            L := \Int_0^1 u^\alpha F_\alpha[tu]\,dt
        \end{gather}
        satisfies $\Delta=\delta_\mathrm{EL}\symbfsf{L}$. If $\Delta$ is homogeneous of degree $k\in\mathbb{N}$ in $u$, this can be expressed as
        \begin{gather}
            \symbfsf{L} = \frac{1}{k+1}\iota_R\Delta\,,
        \end{gather}
        where $R:=u^\alpha\partial_\alpha$ is the (vertically) radial vector field on $E$.
    \end{example}

\subsection{Finite jet bundles}

    A last subject that will be considered in this section is the restriction of the variational bicomplex to finite jet bundles. However, as is clear from the definition of the horizontal differential, forms of order $k\in\mathbb{N}$ are mapped to forms of order $k+1$. Therefore, attention will have to be restricted to a specific subcomplex of $\Omega^\bullet(J^\infty(E))$:
    \begin{gather}
        \Omega^\bullet_k(E)\subset\Omega^\bullet(J^{k+1}(E)) := \delta\text{-closure of }\Omega^\bullet(J^k(E))\,.
    \end{gather}
    From the basic definitions and properties of the two differentials, it follows that $\Omega^\bullet_k$ is generated by $C^\infty(J^k(E))$, the horizontal basis $\{\drx^\mu\}_{\mu\leq\dim(M)}$ and the contact basis $\{\delta u^\alpha_I\}_{\mu\leq\dim(M)}^{|I|\leq k}$.
    The next step is to further restrict to a horizontally closed subcomplex. To this end, consider forms $\omega\in\Omega^{p,q}_k(E)$ of the form
    \begin{gather}
        \omega = \left[\dr u^{\alpha_1}_{I_1}\wedge\ldots\wedge \dr u^{\alpha_r}_{I_r}\wedge\dr\delta u^{\beta_1}_{J_1}\wedge\ldots\wedge\dr\delta u^{\beta_s}_{J_s}\right]\wedge f\drx^{\kappa_1}\wedge\ldots\wedge \drx^{\kappa_{p-r-s}}\,,
    \end{gather}
    where $|I_i|=|J_i|=k-1$ and $f\in C^\infty(J^{k-1}(E))$. It is immediately clear that the subcomplex of such forms is also horizontally closed. The factor in between square brackets can also be rewritten as follows:
    \begin{gather}
        J = \frac{1}{(r+s)!}\frac{D(u^{\alpha_1}_{I_1},\ldots,u^{\alpha_r}_{I_r},\delta u^{\beta_1}_{J_1},\ldots,\delta u^{\beta_s}_{J_s})}{D(x^{\mu_1},\ldots,x^{\mu_r},x^{\nu_1},\ldots,x^{\nu_s})}\drx^{\mu_1}\wedge\ldots\wedge\drx^{\mu_r}\wedge\drx^{\nu_1}\wedge\ldots\wedge\drx^{\nu_s}\,.
    \end{gather}
    This factor has the form of a Jacobian determinant (with respect to total derivatives) and, as such, the subcomplex spanned by the above forms is called the \textbf{Jacobian complex} $\mathcal{J}^\bullet_k(E)$.

    \begin{property}[Alternative characterizations]
        The Jacobian complex can also be characterized as follows:
        \begin{itemize}
            \item Consider the projection $\pi^{\bullet,0}:\Omega^\bullet\rightarrow\Omega^{\bullet,0}$ (note that this maps forms in $\Omega^r(J^k(E))$ to forms in $\Omega^{r,0}_{k+1}(E)$ due to \cref{var:degree_raise_remark}).
            \begin{gather}
                \mathcal{J}^{p,q}_k(E) = \Omega^{p,q}(J^\infty(E))\cap\delta\text{-closure of }\pi^{\bullet,0}\left(\Omega^\bullet(J^{k-1}(E))\right)\,.
            \end{gather}
            \item For $p<m$, the Jacobian complex contains those forms for which $\dr$ does not increase the order:
            \begin{gather}
                \mathcal{J}^{p,q}_k(E) = \{\omega\in\Omega^{p,q}_k\mid\dr\omega\in\Omega^{p+1,q}_k(E)\}\,.
            \end{gather}
            \item If $\omega\in\mathcal{J}^{p,q}_k(E)$, then $\omega$ is a polynomial in $u^\alpha_i$'s and $\delta u^\alpha_I$'s of degree $\leq r$ with $|I|=k$.
        \end{itemize}
    \end{property}

    It can be shown that the Jacobian subcomplex is (locally) exact and that it respects the structure of the Euler--Lagrange complex.
    \begin{property}[Exactness]
        Let $E$ be trivial. If $\delta_{\text{EL}}\omega=0$ for $\omega\in\Omega^{m,q=0}_k(E)$ or $I(\omega)=0$ for $\omega\in\Omega^{m,q\geq1}_k(E)$, then $\omega\in\mathcal{J}^{m,q}_k(E)$ and $\omega=\dr\eta$ for $\eta\in\mathcal{J}^{m-1,q}_k(E)$.
    \end{property}

    \begin{property}[Functional dependence of Lagrangians]
        If $\Delta$ is a locally variational source form of order $k\in\mathbb{N}$, it is polynomial of degree $m$ in $k^{\text{th}}$-order derivatives of the $u^\alpha$.
    \end{property}

\section{Partial differential equations}\index{PDE}

    In this section, the content of \cref{chapter:pde} is generalized using the language of differential geometry.

\subsection{Algebraic formulation}

    In this section, partial differential equations of the form
    \begin{gather}
        \label{var:pde_jet}
        f(x,u,u_I) = 0
    \end{gather}
    are considered, where $f$ is a smooth function. A partial differential equation is regarded as an algebraic equation involving derivatives and, hence, $f$ can be interpreted as a function on the jet bundle $J^k(\mathbb{R}^m)$, where $k\in\mathbb{N}$ is the order of the PDE and $m\in\mathbb{N}$ is the number of independent variables.

    In this framework, one can define a solution of the above PDE as a function $\phi$ satisfying $f\circ j^k\phi=0$. This can be rephrased in a geometric way. Every PDE of order $k\in\mathbb{N}$ defines a subbundle $\Sigma^0$ of the finite jet bundle $J^k(E)$ and a solution is simply a section of $\Sigma^0$.

    \begin{remark}
        For every $l\in\mathbb{N}$, define the subspace
        \begin{gather}
            \Sigma^l:=\{(x,u,u_I)\in J^{k+l}(E)\mid\forall|J|\leq l:D_Jf(x,u,u_I)= 0\} = J^l(\Sigma^0)\cap J^{k+l}(E)\,,
        \end{gather}
        i.e.~the set of holonomic sections of $J^{k+l}(E)$ that are $l^{\text{th}}$-order tangent to $\Sigma^0$. A function $\phi\in\Gamma(E)$ is a solution if there exists some $l\in\mathbb{N}$ such that the image of $j^{k+l}\phi$ lies in $\Sigma^l$ and, conversely, $j^{k+l}\phi$ lies in $\Sigma^l$ for all $l\in\mathbb{N}$ if $\phi$ is a solution.
    \end{remark}
    \newdef{Formal integrability}{
        A PDE $f:\Sigma^0\hookrightarrow J^k(E)$ is called formally integrable if
        \begin{enumerate}
            \item all prolongations $\Sigma^l$ are smooth manifolds.
            \item all projections $\Sigma^{l+1}\rightarrow\Sigma^l$ are smooth fibre bundles.
        \end{enumerate}
    }

    \begin{property}[Diffiety]\index{diffiety}\label{var:diffiety}
        The leaves of the Cartan distribution on $J^\infty(E)$ are the graphs of infinity-prolongations $j^\infty\phi$ for local sections $\phi\in\Gamma(E)$. When restricting the distribution to the PDE $\Sigma^0$, the leaves are given by the graphs of the infinity-prolongations of (local) solutions.

        A pair $(\Sigma,\mathcal{C}(\Sigma))$ consisting of a smooth manifold $\Sigma$ and a finite-dimensional distribution $\mathcal{C}(\Sigma)$, such that $\Sigma$ is locally isomorphic to the infinity-prolongation of a PDE and $\mathcal{C}(\Sigma)$ is locally isomorphic to the associated Cartan distribution, is called a \textbf{diffiety} (short for \textbf{differential variety}).
    \end{property}
    \begin{remark}
        The reason for this terminology stems from the apparent similarity with algebraic varieties. A variety is (locally) defined by a set of algebraic equations together with all algebraic consequences, i.e.~it is defined by the ideal generated by the algebraic equations. Similarly, a diffiety is (locally) defined by a set of differential equations together with all differential consequences, i.e.~it is defined by the differential ideal generated by the differential equations.
    \end{remark}

    \newdef{Exterior system}{\index{exterior!system}
        Consider a general PDE of the form~\eqref{var:pde_jet}. This PDE can be turned into a set of differential forms on the zero locus of $f$, i.e.~$\Sigma_0$:
        \begin{align}
            \theta &:= \dr u - u_\mu\drx^\mu\,,\\
            &\ \ \vdots\nonumber
        \end{align}
        These differential one-forms generate an ideal in $\Omega^\bullet(\Sigma^0)$ that represents the differential equation in that it relates the variables in the algebraic condition $f=0$ by a set of differential relations. It is a Pfaffian system (\cref{bundle:pfaff}) or, combined with the PDE $f=0$ and its differential consequences, it gives a characteristic system (\cref{bundle:characteristic_system}). The associated distribution becomes integrable (sometimes called \textbf{completely integrable}) if and only if the ideal is a differential ideal by Frobrenius's theorem~\ref{bundle:differential_frobenius}. The integral manifolds of the distribution then give a solution of the PDE.\index{integrable!completely}
    }

    \begin{formula}[Lagrange--Charpit equations]\index{Lagrange--Charpit equations}
        Let $f=0$ be a first-order PDE on a smooth manifold and consider the differential closure of the exterior system of $f=0$:
        \begin{gather}
            \begin{cases}
                f&=0\,,\\
                \dr f&=\left(\pderiv{f}{x^\mu}+u_\mu\pderiv{f}{u}\right)\drx^\mu + \pderiv{f}{u_\mu}\dr u_\mu=0\,,\\
                \theta&=0\,,\\
                \dr\theta&=0\,.
            \end{cases}
        \end{gather}
        The characteristic system of these equations is given by the PDE itself, together with the Lagrange--Charpit equations:
        \begin{gather}
            \frac{\drx^1}{\smallpderiv{f}{u_1}}=\cdots=\frac{\drx^n}{\smallpderiv{f}{u_n}}=\frac{-\dr u_1}{\smallpderiv{f}{x^1}+u_1(\smallpderiv{f}{u})}\hspace{0.2\textwidth}\\
            \hspace{0.3\textwidth}=\cdots=\frac{\dr u_n}{\smallpderiv{f}{x^n}+u_n(\smallpderiv{f}{u})}=\frac{\dr u}{\sum_\mu u_\mu(\smallpderiv{f}{u_\mu})}\,.\nonumber
        \end{gather}
    \end{formula}

    \newdef{Monge cone}{\index{Monge!cone}\index{characteristic}
        Consider the characteristic system above. The rank of the Pfaffian system is $2\dim(M)$. At every point $(x^\mu,u)\in M\times\mathbb{R}$, the solutions $(x^\mu,u,u_\mu)$ of the PDE determine a tangent plane to $M$. The $\dim(M)$-parameter family of tangent planes obtained by varying the derivative coordinates $u_\mu$ gives rise to the Monge cone with apex $(x^\mu,u)$. A solution to the PDE is a hypersurface that is everywhere tangent to the Monge cones. This approach to finding a solution is called the \textbf{method of the characteristics}.
    }

\subsection{Symmetries}

    \begin{property}
        A Lie group $G$ with Lie algebra $\mathfrak{g}$ is the symmetry group of a (nondegenerate) system $F$ of PDEs if and only if
        \begin{gather}
            F=0\implies j^\infty X(F)=0
        \end{gather}
        for all generators $X\in\mathfrak{g}$.
    \end{property}

     \todo{COMPLETE}

\subsection{\texorpdfstring{Pseudogroups $\clubsuit$}{Pseudogroups}}\index{pseudo-!group}

    \begin{example}[Diffeomorphism jet]\index{Fa\'a di Bruno formula}
        Let $M$ be a smooth manifold. Consider the set $\mathcal{D}^\omega(M)$ of local analytic diffeomorphisms $\phi:M\rightarrow M:z\mapsto\phi(z)$. The locality property turns this set into a (smooth) pseudogroup (\cref{topology:pseudogroup}).

        By the Inverse Function Theorem~\ref{bundle:inverse_function_theorem}, one can define the diffeomorphism jet bundle $\mathcal{D}^r(M)$ as the subbundle of $J^r(M,M)$ for which \[\det\left(\pderiv{\phi^\alpha}{z^\beta}\right)\neq0\,.\] It is also possible to endow this jet bundle with the structure of a groupoid (\cref{cat:groupoid}). Using the source and target projections, one can check that two elements $f,g\in\mathcal{D}^r(M)$ can be multiplied if and only if $\pi_r(g)=\pi_{r,0}(f)$. The derivative coordinates can be found using the \textit{Fa\'a di Bruno formula}.
    \end{example}
    Furthermore, every pseudogroup $\mathcal{G}\subset\mathcal{D}^\omega$ induces a subbundle $\mathcal{G}^{(r)}\subset\mathcal{D}^{(r)}$. This structure gives rise to the following notions.
    \newdef{Regular pseudogroup}{\index{order!of a jet}
        Consider a smooth manifold $M$. Let $\mathcal{D}^\omega(M)$ be its diffeomorphism pseudogroup and let $\mathcal{G}\subset\mathcal{D}^\omega$ be another pseudogroup. If there exists a $k\in\mathbb{N}_0$, called the \textbf{order}, such that, for all $n\geq k$, the jets $\pi_n:\mathcal{G}^{(n)}\rightarrow M$ form an embedded submanifold of $\Pi_n:\mathcal{D}^{(n)}\rightarrow M$ and such that the jet projections $\pi_{n+1,n}:\mathcal{G}^{(n+1)}\rightarrow\mathcal{G}^{(n)}$ are fibrations, then $\mathcal{G}$ is called a regular pseudogroup.
    }
    \newdef{Lie pseudogroup}{\index{Lie!pseudogroup}
        Let $\mathcal{G}\subset\mathcal{D}^\omega$ be a regular analytic pseudogroup of order $k\in\mathbb{N}$. If every local diffeomorphism $\phi\in\mathcal{D}^\omega$ satisfying $j^k\phi\in\mathcal{G}^{(k)}$ is also an element of $\mathcal{G}$, then $\mathcal{G}$ is called a Lie pseudogroup.
    }
    \begin{property}
        Let $\mathcal{G}$ be a Lie pseudogroup of order $k\in\mathbb{N}$. The regularity condition implies that for all $n\geq k$ the jet bundle $\mathcal{G}^{(n)}$ is described by a set of $n^{\text{th}}$-order PDEs
        \begin{gather}
            F\left(z,\phi^{(n)}\right) = 0\,.
        \end{gather}
        The (local) solutions to these equations are exactly the analytic functions that have $(z_0,\phi^{(n)}_0)$ as local coordinates of their $n$-jet at $z_0\in M$.

        The Lie condition on $\mathcal{G}$ implies that every solution to the system is, in fact, an element of $\mathcal{G}$. This system of equations is called the \textbf{determining system} of the Lie pseudogroup.
    \end{property}

    \newdef{Lie completion}{\index{Lie!completion}
        Let $\mathcal{G}$ be a regular pseudogroup. The Lie completion $\overline{\mathcal{G}}$ of $\mathcal{G}$ is defined as the set of all (local) analytic diffeomorphisms solving the determining system of $\mathcal{G}$. This completion is itself a Lie pseudogroup. If $\mathcal{H}$ is a Lie pseudogroup, then $\overline{\mathcal{H}}=\mathcal{H}$.
    }

    \todo{COMPLETE (IS THIS EVEN USEFUL?)}
\chapter{Metric Spaces}\label{chapter:metric}

    \minitoc

\section{Definition}

    \newdef{Metric}{\index{metric}\index{distance}\label{metric:metric}
        A metric (or \textbf{distance}) on a set M is a map $d:M\times M\rightarrow\mathbb{R}^+$ that satisfies the following properties for all $x,y,z\in M$:
        \begin{enumerate}
            \item \textbf{Nondegeneracy}: $d(x,y)=0\iff x=y$,
            \item \textbf{Symmetry}: $d(x,y) = d(y,x)$, and
            \item \textbf{Triangle inequality}: $d(x,z)\leq d(x,y) + d(y,z)$.
        \end{enumerate}
        A set $M$ equipped with a metric $d$ is called a \textbf{metric space}.
    }

    \newdef{Diameter}{\index{diameter}
        The diameter of a subset $U$ of a metric space $(M,d)$ is defined as follows:
        \begin{gather}
            \mathrm{diam}(U) := \sup_{x,y\in U}d(x,y)\,.
        \end{gather}
    }
    \newdef{Bounded}{\index{bounded}
        A subset $U\subseteq M$ of a metric space is said to be bounded if $\mathrm{diam}(U)<+\infty$.
    }

    \newdef{Isometry}{\index{isometry}\label{metric:isometry}
        An isometry or \textbf{distance-preserving function} $f:(M,d)\rightarrow (M',d')$ between metric spaces is a function satisfying
        \begin{gather}
            d'\bigl(f(x),f(y)\bigr) = d(x,y)
        \end{gather}
        for all $x,y\in M$.
    }

    \newdef{Metric retraction}{\index{retract!metric}
        Let $(M,d)$ be a metric space. A function $f:M\rightarrow M$ is said to be a retraction of metric spaces if:
        \begin{itemize}
            \item $f$ is idempotent, and
            \item $f$ is nonexpansive, i.e.~the following relation holds for all $x,y\in M$:
                \begin{gather}
                    d\bigl(f(x),f(y)\bigr)\leq d(x,y)\,.
                \end{gather}
        \end{itemize}
        The image of $f$ is called a (metric) retract of $M$.
    }

\section{Topology}

    Various topological notions can be (re)formulated in terms of a metric. The most important ones are given below.

    \newdef{Open ball}{\index{ball}\label{metric:open_ball}
        An open ball with radius $R>0$ centred at a point $x_0\in M$ is defined as the following set:
        \begin{gather}
            B(x_0,R) := \{x\in M\mid d(x,x_0)<R\}.\,
        \end{gather}
    }
    \begin{property}[Metric topology]\index{topology!metric}
        Every metric space can be turned into a topological space by taking the open balls to be a basis.
    \end{property}

    \newdef{Closed ball}{
        The closed ball $\overline{B}(x_0,R)$ is defined as the closure of the open ball $B(x_0,R)$:
        \begin{gather}
            \overline{B}(x_0,R) := \{x\in M\mid d(x,x_0)\leq R\}\,.
        \end{gather}
    }

    \newdef{Packing}{\index{packing}
        Let $(M,d)$ be a metric space. A $\varepsilon$-packing, for $\varepsilon>0$, is a subset $\mathcal{P}\subseteq M$ such that
        \begin{gather}
            \sup_{x,y\in\mathcal{P}}d(x,y)\leq\varepsilon\,.
        \end{gather}
        The \textbf{packing number} $N_P(\varepsilon,M,d)$ is defined as the greatest cardinality of a $\varepsilon$-packing of $(M,d)$.
    }

    \newdef{Metrizable space}{\index{metrizable}
        A topological space that is homeomorphic to a metric space $(M,d)$, i.e.~a topological space for which there exists a metric $d:X\times X\rightarrow\mathbb{R}$ that induces the topology on $X$.
    }
    \begin{theorem}[Urysohn's metrization theorem]\index{Urysohn!metrization theorem}\label{topology:urysohn_metrization}
        Every second-countable $T_3$-space is metrizable.
    \end{theorem}

    \newdef{Sequential convergence}{\index{convergence!sequential}\label{metric:convergence}
        A sequence $\seq{x}$ in a metric space $(M,d)$ is said to converge to a point $a\in M$ if
        \begin{gather}
            \forall\varepsilon>0:\exists N_0\in\mathbb{N}:\forall n\geq N_0:d(x_n,a)<\varepsilon\,.
        \end{gather}
    }
    \newdef{Continuity}{\index{continuity}\label{metric:continuity}
        Let $(M,d)$ and $(M',d')$ be two metric spaces. A function $f:M\rightarrow M'$ is said to be continuous at a point $x_0\in$ $\dom(f)$ if
        \begin{gather}
            \forall\varepsilon>0:\exists\delta_\varepsilon>0:\forall x\in\dom(f):d(x_0,x)<\delta_\varepsilon\implies d'\bigl(f(x_0),f(x)\bigr)<\varepsilon\,.
        \end{gather}
    }
    \begin{example}
        Let $(M,d)$ be a metric space. The distance function $d:M\times M\rightarrow\mathbb{R}$ is a continuous function.
    \end{example}

    \newdef{Uniform continuity}{\index{continuity!uniform}\label{metric:uniform_continuity}
        Let $(M,d)$ and $(M',d')$ be two metric spaces. A function $f:M\rightarrow M'$ is said to be uniformly continuous if
        \begin{gather}
            \forall\varepsilon>0:\exists\delta_\varepsilon:\forall x, y\in\dom(f):d(x,y)<\delta_\varepsilon\implies d'\bigl(f(x),f(y)\bigr)<\varepsilon\,.
        \end{gather}
        This is clearly a stronger notion than that of continuity since the number $\varepsilon$ is equal for all points $y\in\dom(f)$.
    }

    Uniform continuity is equivalent to the following notion.
    \newdef{Modulus of continuity}{\index{modulus!of continuity}\label{metric:modulus}
        A function $f:(M,d)\rightarrow(M',d')$ of metric spaces is said to admit a modulus of continuity $\omega:\overline{\mathbb{R}^+}\rightarrow\overline{\mathbb{R}^+}$ if and only if
        \begin{gather}
            d'\bigl(f(x),f(y)\bigr)\leq\omega\bigl(d(x,y)\bigr)
        \end{gather}
        for all $x,y\in M$. Note that this implies that $\omega$ is continuous at zero.
    }

    Two explicit examples of moduli of continuity are.
    \newdef{Lipschitz continuity}{\index{continuity!Lipschitz}\label{calculus:lipschitz_continuity}
        Let $(M,d)$ and $(M',d')$ be two metric spaces. A function $f:M\rightarrow M'$ is said to be Lipschitz continuous if there exists a constant $C>0$ such that
        \begin{gather}
            d'\bigl(f(x),f(y)\bigr)\leq Cd(x,y)
        \end{gather}
        for all $x,y\in M$.
    }
    \newdef{H\"older continuity}{\index{continuity!H\"older}\label{calculus:holder_continuity}
        Let $(M,d)$ and $(M',d')$ be two metric spaces. A function $f:M\rightarrow M'$ is said to be $\gamma$-H\"older continuous, the constant $\gamma>0$ is called the \textbf{H\"older exponent}, if there exists a constant $C>0$ such that
        \begin{gather}
            d'\bigl(f(x),f(y)\bigr)\leq Cd(x,y)^\gamma
        \end{gather}
        for all $x,y\in M$.
    }

\section{Examples}

    \begin{example}[Product space]\index{product!space}
        Consider the Cartesian product
        \begin{gather*}
            M = M_1\times M_2\times\cdots\times M_n\,,
        \end{gather*}
        where $(M_i,d_i)$ is a metric space for all $i\leq n$. Equipped with the distance function
        \begin{gather}
            d(x,y) := \max_{1\leq i\leq n}d_i(x_i,y_i)\,,
        \end{gather}
        this set becomes a metric space.
    \end{example}
    \begin{property}[Projections determine convergence]\label{metric:projection}
        Let $M$ be a product metric space. Consider the projections associated with the sets $M_j$:
        \begin{gather}
            \pr_j:M\rightarrow M_j:(a_1,\ldots,a_n)\mapsto a_j\,.
        \end{gather}
        A sequence in $M$ converges if and only if every component $(\pr_j(x_n))_{n\in\mathbb{N}}$ converges in $(M_j,d_j)$.
    \end{property}

    \begin{example}[Supremum distance]\index{distance!supremum}\label{metric:supremum_distance}
        Let $K\subset\mathbb{R}^n$ be a compact set. The following function defines a metric on $C(K,\mathbb{C})$:
        \begin{gather}
            d_\infty(f,g) := \sup_{x\in K}|f(x) - g(x)|\,.
        \end{gather}
    \end{example}

    \begin{example}[p-metric]\index{distance!taxicab}\label{metric:p_metric}
        For every $p\geq1$, the $L^p$-norm on $\mathbb{R}^n$ is defined as follows:
        \begin{gather}
            d_p(x,y) := \left(\sum_{i=1}^n|x_i-y_i|^p\right)^{\nicefrac{1}{p}}\,.
        \end{gather}
        For $p=1$, this is sometimes called the \textbf{taxicab metric}.
    \end{example}
    \begin{example}[Chebyshev distance]\index{distance!Chebyshev}\index{metric!maximum|see{distance, Chebyshev}}\label{metric:chebyshev_distance}
        The Chebyshev distance is defined similarly to the supremum distance:
        \begin{gather}
            d_\infty(x,y) := \max_{1\leq i\leq n}|x_i-y_i|\,.
        \end{gather}
        This metric is also sometimes called the \textbf{maximum metric} or $L^\infty$-metric.
    \end{example}
    \begin{remark}
        The Chebyshev metric is also an example of a product metric defined on the Euclidean product space $\mathbb{R}^n$. The notation $d_\infty$, which is also used for the supremum distance, can be justified if the space $\mathbb{R}^n$ is identified with the set of maps $\{1,\ldots,n\}\rightarrow\mathbb{R}$. Another justification is the following relation:
        \begin{gather}
            d_\infty(x,y) = \lim_{p\rightarrow\infty}\,d_p(x,y)\,,
        \end{gather}
        which is also the origin of the name $L^\infty$-metric.
    \end{remark}

\section{Completeness}

    \newdef{Cauchy sequence}{\index{Cauchy!sequence}\index{Cauchy!criterion}\label{metric:cauchy_sequence}
        A sequence $\seq{x}$ in a metric space $(M,d)$ is said to be Cauchy (or to have the Cauchy property) if
        \begin{gather}
            \forall\varepsilon>0:\exists N\in\mathbb{N}:\forall m,n\geq N:d(x_m,x_n)<\varepsilon\,.
        \end{gather}
        A metric space $(M,d)$ is said to satisfy the \textbf{Cauchy criterion} if a sequence converges to a point in $M$ if and only if it is Cauchy.
    }

    \newdef{Complete metric space}{\index{complete!space}\label{metric:complete_space}
        A metric space that satisfies the Cauchy criterion.
    }
    \begin{property}
        Subsets of metric spaces have the following properties:
        \begin{itemize}
            \item Every closed subset of a complete metric space is complete.
            \item Every complete subset of a metric space is closed.
        \end{itemize}
    \end{property}

\subsection{Convex metric spaces}

    \newdef{Convex space}{\index{convex}
        A metric space $(M,d)$ with the property that for every two points $x,y\in M$ there exists a third point $z\in M$ such that
        \begin{gather}
            d(x,z) = d(x,y) + d(y,z)\,.
        \end{gather}
    }
    \begin{property}[Convex sets]
        A closed subset of a Euclidean space is a convex metric space if and only if it is a convex set (\cref{calculus:convex}).
    \end{property}

\section{Compactness}

    See \cref{section:compact} for the general theory of compact spaces.

    \begin{theorem}[Stone]\index{Stone}
        Every metric space is paracompact.
    \end{theorem}

    \newdef{Totally bounded}{\index{bounded!totally}
        A metric space $M$ is said to be totally bounded if it satisfies the following equivalent statements:
        \begin{itemize}
            \item For every $\varepsilon>0$ there exists a finite cover $\mathcal{F}$ of $M$ with $\forall F\in\mathcal{F}:\mathrm{diam}(F)\leq\varepsilon$.
            \item For every $\varepsilon>0$ there exists a finite subset $E\subset M$ such that $M\subseteq\bigcup_{x\in E}B(x, \varepsilon)$.
        \end{itemize}
    }
    \newdef{Covering number}{\index{covering!number}\index{entropy!metric}\label{metric:covering_number}
        Let $(M,d)$ be a metric space. The covering number $N_C(\varepsilon,M,d)$ is defined as the least number of $\varepsilon$-balls needed to cover $M$. $M$ is totally bounded if the covering number is finite for every $\varepsilon>0$. The logarithm of the covering number is sometimes called the \textbf{metric entropy}.
    }
    \begin{property}[Boundedness]
        Every totally bounded set is, in particular, bounded and every subset of a totally bounded set is also totally bounded. Furthermore, every totally bounded space is second-countable.
    \end{property}

    The following theorem is a generalization of the Heine--Borel theorem for Euclidean spaces $\mathbb{R}^n$.
    \begin{theorem}[Heine--Borel]\index{Heine--Borel}
        For a metric space $M$, the following statements are equivalent:
        \begin{itemize}
            \item $M$ is compact.
            \item $M$ is sequentially compact.
            \item $M$ is complete and totally bounded.
        \end{itemize}
    \end{theorem}

    \begin{theorem}[Heine--Cantor]\index{Heine--Cantor}
        Let $M,M'$ be two metric spaces with $M$ compact. Every continuous function $f:M\rightarrow M'$ is also uniformly continuous.
    \end{theorem}

    \newdef{Equicontinuity}{\index{equicontinuity}\label{metric:equicontinuity}
        Let $X$ be a topological space and let $M$ be a metric space. A collection $\mathcal{F}$ of maps $X\rightarrow M$ is said to be equicontinuous at $x\in X$ if, for all $\varepsilon\geq 0$, there exists a neighbourhood $U$ of $x$ such that
        \begin{gather}
            \forall f\in\mathcal{F},\forall x'\in U:d\bigl(f(x),f(x')\bigr)\leq\varepsilon\,.
        \end{gather}
        More generally, when both $X$ and $Y$ are arbitrary topological spaces, the collection $\mathcal{F}$ is said to be (topologically) equicontinuous at $x\in X$ if, for every point $y\in Y$ and every open neighbourhood $W$ of $y$, there exist neighbourhoods $U\ni x,V\ni y$ such that
        \begin{gather}
            \forall f\in\mathcal{F}:f(U)\cap V\neq\emptyset\implies f(U)\subset W\,.
        \end{gather}
    }

    \begin{property}
        Let $I\subseteq\mathbb{R}$ be an open interval and let $\mathcal{F}$ be a collection of differentiable functions such that $\{f'(t)\mid f\in\mathcal{F},t\in I\}$ is bounded. Then $\mathcal{F}$ is equicontinuous.
    \end{property}

    \begin{theorem}[Arzel\`a--Ascoli]\index{Arzel\`a--Ascoli}
        Let $K$ be a compact topological space and let $M$ be a complete metric space. The following statements are equivalent for any collection $\mathcal{F}\subseteq C(K,M)$:
        \begin{itemize}
            \item $\mathcal{F}$ is compact with respect to the supremum distance (\cref{metric:supremum_distance}).
            \item $\mathcal{F}$ is equicontinuous, closed under uniform convergence and $\{f(x)\mid f\in\mathcal{F}\}$ is totally bounded for every $x\in K$.
        \end{itemize}
    \end{theorem}

\section{Hyperspaces}\label{section:hyperspace}

    See~\citet{beer_polish_1991,beer_topologies_1993,fritz_probability_2021} for an introduction. For the link to \textit{modal logic}, see~\citet{venema_modal_2014}.

    \newdef{Hyperspace}{\index{hyperspace}
        Let $(X,\tau_X)$ be a topological space. The hyperspace $H(X,\tau_X)$, usually denoted by $H(X)$, is the set of all nonempty closed subsets of $X$.\footnote{As with the natural numbers, sometimes the empty set is included as well. However, in contrast to $\mathbb{N}$, the convention in this compendium is to exclude $\emptyset$ from hyperspaces.}
    }

    The question obviously of how to endow $H(X)$ with a suitable topology. As in the case of 'infinite-dimensional' spaces, multiple options exist.

    \newdef{Vietoris topology}{\index{topology!Vietoris}\index{topology!Hoare}
        For every open set $U\in\tau_X$, consider the following sets:
        \begin{gather}
            \Diamond U := \{V\in H(X)\mid V\cap U\neq\emptyset\}
        \end{gather}
        and
        \begin{gather}
            \square U := \{V\in H(X)\mid V\subseteq U\}\,.
        \end{gather}
        The family $\{\Diamond U\mid U\in\tau_X\}\cup\{\square U\mid U\in\tau_X\}$ is a subbasis for the Vietoris topology.

        When taking only the lower sets $\Diamond U$ (resp.~upper sets $\square U$), the lower Vietoris (or \textbf{Hoare}) topology (resp.~upper Vietoris topology) is obtained.
    }
    \begin{remark}[Modal logic]\label{metric:vietoris_modal_logic}
        For an explanation of the notations, see \cref{section:modal_logic}. The elements of $\Diamond U$ are those that possibly contain a given element of $U$, whereas the elements of $\square U$ are those that necessarily contain a given element of $U$.
    \end{remark}

    The notion of semicontinuity of 'point-valued' functions (\cref{topology:semicontinuity}) can be generalized to set-valued functions.
    \begin{property}[Hemicontinuity]\index{hemicontinuity}\index{semicontinuity|seealso{hemicontinuity}}\label{metric:hemicontinuity}
        A set-valued function $F:X\rightarrow P(Y)$ is lower (resp.~upper) hemicontinuous if and only if it is continuous with respect to the lower (resp.~upper) Vietoris topology (when extended to a topology on the entire power set).
    \end{property}
    \begin{remark}
        In the literature, hemicontinuity is often also called \textbf{semicontinuity}.
    \end{remark}

    \newdef{Wijman topology}{\index{topology!Wijman}
        Let $(X,d)$ be a metric space with its induced topology. The distance from a point $x\in X$ to a set $A\subseteq X$ is given by
        \begin{gather*}
            d(x,A) := \inf_{y\in A}d(x,y)\,.
        \end{gather*}
        The Wijsman topology on $H(X)$ is the initial topology (\cref{topology:initial_topology}) with respect to the family $\{d(x,\cdot)\mid x\in X\}$.
    }

    \begin{property}
        The Wijsman topology has the following properties:
        \begin{itemize}
            \item If $X$ is separable (\cref{topology:separable}), $H(X)$ is second countable.
            \item Hence, by \cref{topology:initial_regularity} and Urysohn's metrization theorem~\ref{topology:urysohn_metrization}, $H(X)$ is separable and metrizable whenever $X$ is.
            \item When $X$ is \textit{Polish} (see \cref{measure:polish_space}), so is $H(X)$.
        \end{itemize}
    \end{property}

    \begin{property}[Effros $\sigma$-algebra]\index{Effros $\sigma$-algebra}
        If $X$ is separable, the Borel $\sigma$-algebra (\cref{topology:borel_set}) induced by the Wijsman topology coincides with that induced by the lower Vietoris topology.
    \end{property}

    \begin{property}[Compactness]
        When $X$ is compact, the Vietoris and Wijsman topologies coincide.
    \end{property}
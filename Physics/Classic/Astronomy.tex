\chapter{Astronomy}

\section{Ellipsoidal coordinates}

    Consider the following equation:
    \begin{gather}\index{coordinate!ellipsoidal}
        \label{astronomy:ellipsoidal_defining_function}
        f(\tau) = \frac{x^2}{\tau + \alpha} + \frac{y^2}{\tau + \beta} + \frac{z^2}{\tau + \gamma} - 1,
    \end{gather}
    where $\alpha<\beta<\gamma<0$. By multiplying by the denominators and choosing $f(\tau) = 0$, a polynomial equation of degree 3 in $\tau$ is obtained. This polynomial can be formally factorized as
    \begin{gather}
        -(\tau-\lambda)(\tau-\mu)(\tau-\nu) = 0.
    \end{gather}
    This solutions of this equation obey the following conditions:
    \begin{itemize}
        \item $\nu\in\ ]-\gamma,-\beta[$\ ,
        \item $\mu\in\ ]-\beta,-\alpha[$\ , and
        \item $\lambda\in\ ]-\alpha,\infty[$\ .
    \end{itemize}
    From the previous two equations one can find a solution for $x^2$ by multiplying by $(\tau+\alpha)$ and taking the limit $\tau\rightarrow-\alpha$. Solutions for $y^2$ and $z^2$ can be found in a similar way:
    \begin{gather}
        \label{astronomy:ellipsoidal_coordinates}
        \begin{cases}
            x^2 = \frac{(\lambda + \alpha)(\mu + \alpha)(\nu + \alpha)}{(\beta - \alpha)(\gamma - \alpha)}&\\
            y^2 = \frac{(\lambda + \beta)(\mu + \beta)(\nu + \beta)}{(\beta - \alpha)(\beta - \gamma)}&\\
            z^2 = \frac{(\lambda + \gamma)(\mu + \gamma)(\nu + \gamma)}{(\alpha - \gamma)(\beta - \gamma)}.&
        \end{cases}
    \end{gather}
    These solutions can be divided in different families depending on the value of $\tau$.

\subsection{Ellipsoid: \texorpdfstring{$\tau=\lambda$}{tau equals lambda}}\index{ellipsoid}\index{focal!ellipse}

    The first family consists of the surfaces defined by fixing $\tau=\lambda$ in Equation \eqref{astronomy:ellipsoidal_defining_function}. By noting that all denominators are positive in this case, it can be seen that the obtained surface is an ellipsoid with the $x$-axis as the shortest axis. By taking the limit $\lambda\longrightarrow\infty$ the equation of a sphere with radius $\sqrt{\lambda}$ is obtained, whilst taking $\lambda\longrightarrow-\alpha$ results in an ellipse in the $yz$-plane. This ellipse is called the \textbf{focal ellipse}.

\subsection{One-sheet hyperboloid: \texorpdfstring{$\tau=\mu$}{tau equals mu}}\index{focal!hyperboloid}\index{hyperboloid}

    By fixing $\tau=\mu$ in \eqref{astronomy:ellipsoidal_defining_function} the equation of a one-sheet hyperboloid (also called a \textbf{hyperbolic hyperboloid}) around the $x$-axis is obtained. By taking the limit $\mu\longrightarrow-\alpha$ the hyperboloid collapses on the $yz$-plane and the surface outside the focal ellipse is obtained. If one takes $\mu\longrightarrow-\beta$, the hyperboloid becomes degenerate and one gets the surface inside the \textbf{focal hyperbola} defined by
    \begin{gather}
        \label{astronomy:focal_hyperbola}
        \frac{x^2}{\alpha-\beta} + \frac{z^2}{\gamma-\beta} = 1.
    \end{gather}
    This hyperbola intersects the $z$-plane in the foci of the focal ellipse.

\subsection{Two-sheet hyperboloid: \texorpdfstring{$\tau = \nu$}{}}

    By fixing $\tau=\nu$ in \eqref{astronomy:ellipsoidal_defining_function} the equation of a two-sheet hyperboloid (also called an \textbf{elliptic hyperboloid}) around the $z$-axis is obtained. By taking the limit $\nu\longrightarrow-\beta$ the hyperboloid becomes degenerate and one obtains the surface outside the focal hyperbola \eqref{astronomy:focal_hyperbola}. If $\nu\longrightarrow-\gamma$ the two sheets coincide in the $xy$-plane.

\subsection{Hamiltonian function}

    When writing out the kinetic energy in ellipsoidal coordinates and noting that mixed terms of the form $\pderiv{x^a}{\lambda^i}\pderiv{x^a}{\lambda^j}$ cancel out due to \eqref{astronomy:ellipsoidal_coordinates}, it is clear that the Hamiltonian function can be separated:
    \begin{gather}
        H = \frac{1}{2}\left(\frac{p_\lambda^2}{Q_\lambda^2} + \frac{p_\mu^2}{Q_\mu^2} + \frac{p_\nu^2}{Q_\nu^2}\right) + V,
    \end{gather}
    where $Q_j^2 = \sum_i\left(\pderiv{x^i}{\lambda^j}\right)^2$ are the metric coefficients in ellipsoidal coordinates. After a straightforward calculation these can be found to be:
    \begin{gather}
        Q_\lambda^2 = \frac{1}{4}\frac{(\lambda-\mu)(\lambda-\nu)}{(\lambda+\alpha)(\lambda+\beta)(\lambda+\gamma)},
    \end{gather}
    which is also valid for $\mu$ and $\nu$ after cyclically permutating the coordinates.

    Because of the St\"ackel conditions \eqref{lagrange:stackel_condition}, the potential must be of the form
    \begin{gather}
        V = \sum_i\frac{W_i(\lambda^i)}{Q_i^2}
    \end{gather}
    if one wants to obtain a separable Hamilton-Jacobi equation. Due to the disjoint nature of $\lambda,\mu$ and $\nu$ one can consider $W_\lambda,W_\mu$ and $W_\nu$ as three components of a single function:
    \begin{gather}
        G(\tau) := -4(\tau+\beta)W_\tau(\tau).
    \end{gather}
    The 3D potential is thus completely determined by a univariate function $G(\tau)$.

\subsection{Hamilton-Jacobi equation}

    If a time-independent system is considered, one can use \eqref{lagrange:time_independent_hje} as the starting point. By multiplying this equation by $(\lambda - \mu)(\lambda - \nu)(\mu - \nu)$ one obtains
    \begin{multline}
        (\mu - \nu)\left[2(\lambda + \alpha)(\lambda + \beta)(\lambda + \gamma)\left(\deriv{S^\lambda(\lambda)^2}{\lambda}\right)\right.\\ - (\lambda + \alpha)(\lambda + \gamma)G(\lambda) - \lambda^2E \bigg] + \text{cyclic permutations} = 0,
    \end{multline}
    where the multiplicative factor was rewritten in the form $a\lambda^2 + b\mu^2 + c\nu^2$ before multiplying the RHS of \eqref{lagrange:time_independent_hje}. This equation can also be rewritten as
    \begin{gather}
        (\mu-\nu)U(\lambda) + (\lambda-\mu)U(\nu) + (\nu-\lambda)U(\mu) = 0.
    \end{gather}
    Differentiating twice with respect to any $\lambda^i$ gives $U''(\tau) = 0$ or, equivalently,
    \begin{gather}
        U(\tau) = I_3 - I_2\tau,
    \end{gather}
    where $I_2$ and $I_3$ are two new integrals of motion.

    Using the Hamiltonian-Jacobi equation \eqref{lagrange:hamilton_jacobi_equation} one can obtain the conjugate momenta $p_\tau = \deriv{S^\tau}{\tau}$. After a lengthy calculation one obtains
    \begin{gather}
        p_\tau^2 = \frac{1}{2(\tau+\beta)}\left[E - V_\mathrm{eff}(\tau)\right],
    \end{gather}
    where the effective potential is given by
    \begin{gather}
        V_\mathrm{eff} = \frac{J}{\tau+\alpha} + \frac{K}{\tau+\gamma} - G(\tau).
    \end{gather}
    The two conserved quantities $J$ and $K$ are given by \[J = \frac{\alpha^2E + \alpha I_2 + I_3}{\alpha - \gamma} \qquad\text{and}\qquad K = \frac{\gamma^2E + \gamma I_2 + I_3}{\gamma - \alpha}.\] To be physically acceptable, $p_\tau^2$ should be positive. This leads to following conditions on the energy:
    \begin{gather}
        \begin{cases}
            E&\geq V_\mathrm{eff}(\lambda)\\
            E&\geq V_\mathrm{eff}(\mu)\\
            E&\leq V_\mathrm{eff}(\nu).
        \end{cases}
    \end{gather}
    The generating function $G(\tau)$ should also satisfy some conditions. Note that the St\"ackel potential $V(\lambda,\mu,\nu)$ can be rewritten as
    \begin{gather}
        \label{astronomy:potential2}
        V = -\frac{1}{\lambda - \nu}\left(\frac{F(\lambda) - F(\mu)}{\lambda - \mu} - \frac{F(\mu) - F(\nu)}{\mu - \nu}\right) \leq 0,
    \end{gather}
    where $F(\tau) = (\tau + \alpha)(\tau + \gamma)G(\tau)$. For $\lambda\longrightarrow\infty$ (or $r^2\longrightarrow\infty$) one obtains $V\approx-\frac{F(\lambda)}{\lambda^2}\approx-G(\lambda)$. Because $V\sim \lambda^{-1}$ it is clear that $G(\tau)$ cannot decay faster than $\lambda^{-1/2}$ at infity. Furthermore, one can interpret \eqref{astronomy:potential2} as an approximation of $-F''(\tau)$. It follows that $F(\tau)$ should be convex. For $\tau\longrightarrow-\gamma$ one obtains \[\begin{cases}\alpha + \tau < 0\\\tau + \gamma\longrightarrow 0.\end{cases}\] So, if $G(\tau)$ decays faster than $\frac{1}{\tau + \gamma}$, then $F(\tau)\longrightarrow-\infty$, which is not possible for a convex function.

    To fulfil these conditions assume that the generating function can be written as
    \begin{gather}
        G(\tau) = \frac{GM}{\sqrt{\gamma_0 + \tau}},
    \end{gather}
    where $G$ is the gravitational constant and $M$ is the galactic mass.

    \begin{theorem}[Kuzmin]\index{Kuzmin}
        The spatial mass density function generated by a St\"ackel potential is completely determined by a function of the form $\rho(z)$.
    \end{theorem}
    \begin{result}
        For triaxial mass models in ellipsoidal coordinates the axial ratios are inversely proportional to the axial ratios of the coordinate system.
    \end{result}
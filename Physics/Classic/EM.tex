\chapter{Electromagnetism}\label{chapter:em}

\section{Electricity}

    \newdef{Coulomb}{\index{Coulomb}
        \nomenclature[U_C]{C}{coulomb}
        The SI unit of charge is the coulomb (symbol: C). One coulomb equals the amount of charge that passes through a conductor when the electric current equals one amp\`ere.
    }

    \begin{property}[Conservation of charge]
        Charge is a conserved quantity.
    \end{property}

    \begin{formula}[Coulomb's law]\index{Coulomb's law}
        The force between two point charges $q_1,q_2$ is given by
        \begin{gather}
            F = \frac{q_1q_2}{4\pi\varepsilon_0 r^2}\,,
        \end{gather}
        where $r$ is the distance between the charges and $\varepsilon_0$ is the permittivity of the vacuum $(\varepsilon_0\approx8.854\mathrm{e}{-12}\frac{\mathrm{F}}{\mathrm{m}})$.
    \end{formula}

    \newdef{Electric potential}{\index{potential}
        The electric field gives the force experienced by a (positive) unit charge. The electric potential is then defined as the work done by this charge when moving through the field:
        \begin{gather}
            V(\vector{a},\vector{b}) := \Int_{\vector{a}}^{\vector{b}}\vector{E}\cdot d\vector{l}\,.
        \end{gather}
        By fixing an endpoint (some fixed reference location\footnote{As usual the potential is only determined up to some constant.}), the electric field and electric potential are related in the same way as the ordinary potential and the associated (conservative) force (cf.~\cref{classic:conservative_force}):
        \begin{gather}
            E = -\nabla V\,.
        \end{gather}
    }

    \newdef{Capacitance}{\index{capacitance}\label{em:capacitance}
        The capacitance is a (geometrical) value that reflects the amount of charge an object can store:
        \begin{gather}
            C := \frac{Q}{V}\,.
        \end{gather}
    }

\subsection{Conductors and resistors}

    \newdef{Current}{\index{current}
        The amount of charge that passes a given point in one second:
        \begin{gather}
            I := \deriv{Q}{t}\,.
        \end{gather}
    }
    \begin{formula}[Power]
        Given that the electric potential gives the work done by a positive charge, the electric power of a current $I$ is given by
        \begin{gather}
            P = VI\,.
        \end{gather}
    \end{formula}

    \begin{property}[Electric field of conductor]
        The electric field inside a conductor vanishes at equilibrium. All free charges are located at the surface. Moreover, the electric field at the surface points along the normal vector.
    \end{property}

    \newdef{Drift velocity}{
        The average velocity of independent charge carriers is the drift velocity $\vector{v}_d$. It is important to remark that $v_d$ is not equal to the propagation speed of the electric signal, which is the result of particle collisions. In fact, it is several orders of magnitude smaller.
    }

    \newdef{Mobility}{\label{em:mobility}
        \begin{gather}
            \mu := \frac{v_d}{E}\,,
        \end{gather}
        where $E$ is the external electric field.
    }
    \newdef{Conductivity}{\label{em:conductivity}
        \begin{gather}
            \sigma := nq\mu
        \end{gather}
    }
    \newdef{Resistivity}{\label{em:resistivity}
        \begin{gather}
            \rho := \frac{1}{\sigma}
        \end{gather}
    }

    \begin{formula}[Pouillet's law]\index{Pouillet}\label{em:pouillet}
        The resistance of a wire is given by the following formula:
        \begin{gather}
            R = \frac{l}{A}\rho\,,
        \end{gather}
        where
        \begin{itemize}
            \item $\rho$ is the resistivity of the material,
            \item $l$ is the length of the resistor, and
            \item $A$ is the cross-sectional area of the resistor.
        \end{itemize}
    \end{formula}

    \begin{property}[Resistor circuits]
        Consider an electrical circuit of the form
        \begin{gather*}
            \begin{tikzpicture}
                \draw[dashed] (-.5, 0) -- (0, 0);
                \draw (0, 0) -- (1, 0);
                \draw (1, -.5) -- (1, .5);
                \draw (1, .5) -- (3, .5);
                \draw (1, -.5) -- (3, -.5);
                \draw (3, -.5) -- (3, .5);
                \draw (3, 0) -- (4, 0);
                \draw[dashed] (4, 0) -- (4.5, 0);
            \end{tikzpicture}
        \end{gather*}
        The potential difference over both resistors is equal or, equivalently,
        \begin{gather}
            R_1I_1=R_2I_2\,.
        \end{gather}

        @@ COMPLETE (use correct icon for resistor) @@
    \end{property}

    \begin{theorem}[Kirchhoff's first law]\index{Kirchhoff's laws}
        The oriented\footnote{Currents leaving the point are counted with a minus sign.} sum of currents meeting at any point is zero.
    \end{theorem}
    \begin{theorem}[Kirchhoff's second law]
        The oriented sum of potential differences in a closed circuit is zero.
    \end{theorem}

\subsection{Ohm's law}

    \newformula{Free current density}{\label{em:free_current_density}
        The current density generated by free charges is given by
        \begin{gather}
            \vector{J} = nq\vector{v}_d\,.
        \end{gather}
    }

    \newformula{Ohm's law}{\index{Ohm}\label{em:ohms_law}
        \begin{gather}
            \vector{J} = \sigma\cdot\vector{E}\,,
        \end{gather}
        where $\sigma$ is the conductivity tensor. (Compare this to \cref{em:mobility} and \cref{em:conductivity} for 1D systems.)
    }

    \newformula{Ohm's law in wires}{\label{em:ohms_law_linear}
        The following formula can be found by combining \cref{em:resistivity} and \namecrefs{em:pouillet}~\ref{em:pouillet} and~\ref{em:ohms_law}, and by assuming that the conductivity tensor is a scalar (this follows from the isotropic behaviour of most resistors):
        \begin{gather}
            V = RI\,.
        \end{gather}
    }

\subsection{Electric dipoles}

    \begin{formula}[Electric dipole]\index{dipole}\label{em:dipole}
        \begin{gather}
            \vector{p} := q\vector{l}\,,
        \end{gather}
        where
        \begin{itemize}
            \item $q$ is the positive charge, and
            \item $\vector{l}$ is the vector pointing from the negative charge to the positive charge.
        \end{itemize}

        Assume that the positive charge is located at the origin and that the vector $\vector{l}$ points in the direction of the $x$-axis, i.e.~$\vector{l}=l\symbf{\hat{e}_x}$ for some $\lambda>0$ (so the negative charge is located to the left of the origin). The electric potential of the dipole is then given by:
        \begin{gather}
            V(\vector{r}) = \frac{1}{4\pi\varepsilon_0}\left(\frac{q}{r}-\frac{q}{r+l\cos(\theta)}\right) = \frac{q}{4\pi\varepsilon_0}\frac{l\cos(\theta)}{r\bigl(r+l\cos(\theta)\bigr)}\,,
        \end{gather}
        where $\theta$ is the angle between $\symbf{\hat{e}_x}$ and $\vector{r}+\vector{l}$ (see \cref{fig:electric_dipole}). In the far-field regime, where $l\cos(\theta)\ll r$, the potential is given by
        \begin{gather}
            V(\vector{r})\approx\frac{q}{4\pi\varepsilon_0}\frac{l\cos(\theta)}{r^2}\,.
        \end{gather}

        \begin{figure}[ht!]
            \centering
            \begin{tikzpicture}
                \draw[fill] (2, 0) circle (2pt) node[right]{$P$};
                \draw[fill] (-1, -3) circle (2pt) node[left]{$-q$};
                \draw[fill] (1, -3) circle (2pt) node[right]{$q$};
                \draw[->] (-1, -3) -- node[below]{$\vector{l}$} (1cm-1pt, -3);
                \draw[->] (1, -3) -- node[below right]{$\vector{r}$} (2cm-1pt, -1pt);
                \draw[dashed] (-1, -3) -- (2, 0);
                \draw (-1cm+10pt, -3) arc (0:45:10pt) node[right]{$\ \theta$};
            \end{tikzpicture}
            \caption{Electric dipole configuration.}
            \label{fig:electric_dipole}
        \end{figure}
    \end{formula}

    \begin{formula}[Energy]
        If an electric dipole is placed in an external electric field, its potential energy is given by
        \begin{gather}
            \label{em:dipole_energy}
            V = -\vector{p}\cdot\vector{E}\,.
        \end{gather}
    \end{formula}

    \begin{formula}[Torque]
        If an electric dipole is placed in an external electric field, the torque on this system is given by
        \begin{gather}
            \label{em:dipole_torque}
            \vector{\tau} = \vector{p}\times\vector{E}\,.
        \end{gather}
    \end{formula}

    \begin{formula}[Multipole expansion]
        Consider a general charge distribution $\rho:\mathbb{R}^3\rightarrow\mathbb{R}$ with support in a bounded region $\Gamma$ and assume that $\|\vector{r}\|\gg\mathrm{diam}(\Gamma)$. If $\vector{r}$ is oriented along the $z$-axis, one can write the (squared) distance to an infinitesimal volume element as
        \begin{gather}
            R^2 = r^2 + (r')^2 - 2rr'\cos(\theta)
        \end{gather}
        or
        \begin{gather}
            \label{em:legendre}
            \frac{1}{R} = \frac{1}{r}\frac{1}{\sqrt{1 - \left(\frac{r'}{r}\right)^2-2\left(\frac{r'}{r}\right)\cos(\theta)}}\,,
        \end{gather}
        where $\vector{r}'$ is the position of the volume element and $\theta$ is the polar angle of this position vector. In the general integral
        \begin{gather}
            V(\vector{r}) = \frac{1}{4\pi\varepsilon_0}\Int\frac{\rho(\vector{r}')}{\|\vector{r}-\vector{r}'\|}\,dV'\,,
        \end{gather}
        one can now expand the denominator in powers of $1/r$,
        \begin{gather}
            V(\vector{r}) = \frac{1}{4\pi\varepsilon_0}\left(\frac{K_0}{r} + \frac{K_1}{r^2} + \frac{K_2}{r^3} +\cdots\right)\,,
        \end{gather}
        since the second factor in \cref{em:legendre} is the generating function of Legendre polynomials:
        \begin{itemize}
            \item $K_0 := \displaystyle\Int\rho(\vector{r})\,dV$
            \item $K_1 := \displaystyle\Int r\cos(\theta)\rho(\vector{r})\,dV$
            \item $K_2 := \displaystyle\Int\frac{3\cos^2(\theta)-1}{2}r^2\rho(\vector{r})\,dV$
            \item $\cdots$
            \item $K_n := \displaystyle\Int P_n\bigl(\cos(\theta)\bigr)r^n\rho(\vector{r})\,dV$,
        \end{itemize}
        with $P_n$ the $n^{th}$ \temptext{Legendre polynomial}. The first term gives an approximation as if all charge was concentrated at a single point (this is called the \textbf{monopole approximation}). At very large distances, where the charge distribution appears as a single point, this gives a good approximation.

        When the position vector $\vector{r}$ is not assumed to be oriented along the $z$-axis, the Legendre polynomials have to be replaced by spherical harmonics.
    \end{formula}

\section{Magnetism}

    \newdef{Tesla}{\index{tesla}
        \nomenclature[U_T]{T}{tesla}
        The SI unit of magnetic field strength/magnetic induction is the tesla (symbol: T). It is defined such that a charge of one coulomb moving at one meter per second experiences a force of one newton when the magnetic induction equals one tesla: $\mathrm{T} = \frac{\mathrm{N}}{\mathrm{Am}}$.
    }

    \newdef{Magnetic field}{\index{magnetization}\index{susceptibility}\index{permeability}\index{induction}
        The \textbf{magnetizing field} $\vector{H}$ is the field generated by all external sources. When applying an external (magnetic) field, some materials will try to oppose this external influence. Similar to polarization in the case of electricity, one can define the \textbf{magnetization}:
        \begin{gather}
            \label{em:M}
            \vector{M} := \chi\vector{H}\,,
        \end{gather}
        where $\chi$ is the \textbf{magnetic susceptibility}.

        The \textbf{magnetic induction} $\vector{B}$ is the field generated by both the external sources and the internal magnetization. This is the total magnetic field and, hence, only this field that can be measured. In vacuum, the following relation between the magnetic induction, the magnetizing field and the magnetization exists:
        \begin{gather}
            \label{em:B}
            \vector{B} = \mu_0\left(\vector{H} + \vector{M}\right)\,.
        \end{gather}
        By combining the previous two formulas one obtains (this equation is only valid in linear media)
        \begin{gather}
            \label{em:B_with_only_H}
            \vector{B} = \mu_0\left(1 + \chi\right)\vector{H}\,.
        \end{gather}
        The proportionality constant in this formula is called the \textbf{magnetic permeability}:\index{permeability}
        \begin{gather}
            \label{em:relative_permeability}
            \mu := \mu_0(1 + \chi)\,,
        \end{gather}
        where $\mu_0$ is the magnetic permeability of the vacuum. The factor $1+\chi$ is called the \textbf{relative permeability} and it is often denoted by $\mu_r$.
    }

    \begin{remark}[Tensorial formulation]
        In anisotropic materials one has to use a tensorial formulation:
        \begin{align}
            \label{em:B_tensor}
            B_i &= \sum_j\mu_{ij}H_j\,,\\
            \label{em:M_tensor}
            M_i &= \sum_j\chi_{ij}H_j\,.
        \end{align}
        In this case, both $\mu$ and $\chi$ are $(1,1)$-tensors, i.e.~linear maps.
    \end{remark}

    @@ CHECK (linear/tensorial) @@

\subsection{Electric charges in a magnetic field}

    \newformula{Gyroradius}{\label{em:gyroradius}
        A charge $q$ moving in a magnetic field $B$ with velocity $\vector{v}$ will follow a circular path with radius
        \begin{gather}
            r = \frac{mv_\perp}{|q|B}\,.
        \end{gather}
    }
    \newformula{Gyrofrequency\footnotemark}{\index{cyclotron}\index{Larmor frequency}\label{em:gyrofrequency}
        \footnotetext{Also called the \textbf{Larmor} or \textbf{cyclotron frequency}.}
        The circular velocity is given by
        \begin{gather}
            \omega = \frac{|q|B}{m}\,.
        \end{gather}
    }

\section{Differential Maxwell equations}\label{section:maxwell_equations}

    \newformula{Gauss's law for electricity}{\index{Gauss!laws for electricity and magnetism}\label{maxwell:gauss_electricity}
        \begin{gather}
            \nabla\cdot\vector{E} = \frac{\rho}{\varepsilon}
        \end{gather}
    }
    \newformula{Gauss's law for magnetism}{\label{maxwell:gauss_magnetism}
        \begin{gather}
            \nabla\cdot\vector{B} = 0
        \end{gather}
        If magnetic monopoles would exist, the right-hand side would contain a (magnetic) charge density as in the case of electricity.
    }
    \newformula{Faraday's law}{\index{Faraday}\label{maxwell:faraday}
        \begin{gather}
            \nabla\times\vector{E} = -\pderiv{\vector{B}}{t}
        \end{gather}
    }
    \newformula{Maxwell's law\footnotemark}{\index{Maxwell}\label{maxwell:maxwell}
        \footnotetext{Also called the \textbf{Maxwell--Amp\`ere law}.}
        \begin{gather}
            \nabla\times\vector{B} = \varepsilon\mu\pderiv{\vector{E}}{t} + \mu\vector{J}
        \end{gather}
    }

\section{Potentials}\index{potential}
\subsection{Decomposition in potentials}

    The Helmholtz decomposition (\cref{vector:helmholtz_decomposition}) together with Gauss's law~\ref{maxwell:gauss_magnetism} imply the following general form for $\vector{B}$:
    \begin{gather}
        \label{maxwell:magnetic_potential}
        \vector{B} = \nabla\times\vector{A}\,,
    \end{gather}
    where $\vector{A}$ is called the \textbf{magnetic potential}.

    Combining \cref{maxwell:magnetic_potential} with Faraday's law~\ref{maxwell:faraday} (and doing some rewriting), gives the following general form for $\vector{E}$:
    \begin{gather}
        \label{maxwell:electric_potential}
        \vector{E} = -\nabla V - \pderiv{\vector{A}}{t}\,,
    \end{gather}
    where $V$ is called the \textbf{electrostatic potential}.

    \begin{property}
        Substituting the previous two expressions into \cref{maxwell:gauss_electricity} and \cref{maxwell:maxwell}, gives the following two (coupled) conditions for the electromagnetic potentials:
        \begin{align}
            \label{maxwell:potential_conditions_A}
            \Delta\vector{A} - \varepsilon\mu\mpderiv{2}{\vector{A}}{t} &= \nabla\left(\nabla\cdot\vector{A} + \varepsilon\mu\pderiv{V}{t}\right) - \mu\vector{J}\,,\\
            \label{maxwell:potential_conditions_V}
            \Delta V - \varepsilon\mu\mpderiv{2}{V}{t} &= -\pderiv{}{t}\left(\nabla\cdot\vector{A} + \varepsilon\mu\pderiv{V}{t}\right) - \frac{\rho}{\varepsilon}\,.
        \end{align}
    \end{property}

\section{Lorentz force}

    The relation between the force acting on a charged particle and the strength of electric and magnetic fields is given by the Lorentz force law.
    \begin{formula}[Lorentz force]\index{Lorentz!force}\label{maxwell:lorentz_force}
        \begin{gather}
            \vector{F} = q\left(\vector{E} + \vector{v}\times\vector{B}\right)
        \end{gather}
    \end{formula}
    The charge of a particle acts as the constant of proportionality.

    \begin{formula}[Lorentz force density]\label{maxwell:lorentz_force_density}
        \begin{gather}
            \vector{f} = \rho\vector{E} + \vector{J}\times\vector{B}
        \end{gather}
    \end{formula}

\section{Energy and momentum}

    \newdef{Poynting vector}{\index{Poynting vector}\label{maxwell:poynting_vector}
        \begin{gather}
            \vector{S} := \vector{E}\times\vector{H}
        \end{gather}
    }

    \begin{formula}[Energy density]
        \begin{gather}
            \label{maxwell:energy_density}
            W = \frac{1}{2}\left(\vector{E}\cdot\vector{D} + \vector{B}\cdot\vector{H}\right)
        \end{gather}
    \end{formula}

\section{Gauge theory}\index{gauge!transformation}

    Looking at \cref{maxwell:magnetic_potential}, it is clear that a transformation $\vector{A}\longrightarrow\vector{A}+\nabla\psi$ has no effect on $\vector{B}$ due to \cref{vector:rotor_of_gradient}. To compensate for this transformation in \cref{maxwell:electric_potential}, one also has to perform a transformation $V\longrightarrow V - \pderiv{\psi}{t}$. These transformations are called \textbf{gauge transformations} (also compare to the previous chapter).
    \newdef{Gauge fixing conditions}{\index{gauge!fixing}
        Conditions that fix a certain gauge (or class of gauge transformations). These select one of many physically equivalent configurations. Mathematically this corresponds to picking a representative for any orbit of the gauge transformations. (See \cref{chapter:gauge_theory} for more information.)
    }
    \remark{It often happens that a gauge condition does not completely fix the gauge, i.e.~the condition does not pick a unique representative but only fixes a subset of the gauge orbit that still has some remaining symmetry or freedom.}

    \begin{example}[Lorenz gauge]\index{Lorenz gauge}
        A first example of a gauge fixing condition is the Lorenz gauge\footnote{Named after \textit{Ludvig Lorenz}. Not to be confused with \textit{Hendrik Lorentz}.}:
        \begin{gather}
            \label{maxwell:lorenz_gauge}
            \nabla\cdot\vector{A} + \varepsilon\mu\pderiv{V}{t} = 0.
        \end{gather}
        When using this gauge fixing condition, \namecrefs{maxwell:potential_conditions_A}~\eqref{maxwell:potential_conditions_A} and~\eqref{maxwell:potential_conditions_V} uncouple. This allows to rewrite them as
        \begin{align}
            \Box\vector{A} &= -\mu\vector{J}\,,\\
            \Box V &= -\frac{\rho}{\varepsilon}\,.
        \end{align}
        To see which gauge functions $\psi$ are valid in this case, perform a transformation as explained above:
        \begin{gather}
            \label{maxwell:gauge_transformations}
            \vector{A}' = \vector{A} + \nabla\psi \qquad\text{and}\qquad V'=V-\pderiv{\psi}{t}\,.
        \end{gather}
        Substituting these transformations in \cref{maxwell:lorenz_gauge} and using the fact that both sets of potentials $(\vector{A}, V)$ and $(\vector{A}',V')$ satisfiy the Lorenz gauge~\eqref{maxwell:lorenz_gauge} gives the following condition for the gauge function $\psi$:
        \begin{gather}
            \label{maxwell:lorenz_gauge_condition}
            \Box\psi = 0\,.
        \end{gather}
    \end{example}

    \begin{example}[Coulomb gauge]\index{Coulomb!gauge}
        Apart from the Lorenz gauge, there is also the Coulomb gauge:
        \begin{gather}
            \label{maxwell:coulomb_gauge}
            \nabla\cdot\vector{A} = 0\,.
        \end{gather}
    \end{example}

\subsection{Differential-geometric perspective}

    Using the tools introduced in \cref{chapter:vector_bundles} (e.g.~differential forms) one can rewrite all of the above formulas in a more elegant form. This will also allow to generalize them to higher dimensions and to more general settings. See, for example, \citet{sontz_principal_2015} for a complete derivation and interpretation. (It should be noted that \textit{Gaussian units} are used throughout this section.)

    \newdef{Field strength}{\index{field!strength}
        Define
        \begin{gather}
            \mathbf{E} = E_1\drx^1 + E_2\drx^2 + E_3\drx^3
        \end{gather}
        and
        \begin{gather}
            \mathbf{B} = B_1\drx^2\wedge\drx^3 + B_2\drx^3\wedge\drx^1 + B_3\drx^1\wedge\drx^2
        \end{gather}
        as the electric and magnetic field forms. Using these differential forms one can write the field strength as follows:
        \begin{gather}
            \mathbf{F} = \mathbf{B} - \dr t\wedge\mathbf{E}\,.
        \end{gather}
    }

    \begin{formula}[Maxwell's equations]
        Define the electric 4-current as
        \begin{gather}
            \mathbf{J} = \rho\dr t - J_1\drx^1 - J_2\drx^2 - J_3\drx^3.
        \end{gather}
        Maxwell's equations (\cref{section:maxwell_equations}) can now be rewritten as follows:
        \begin{align}
            \dr\mathbf{F} &= 0\,,\label{maxwell:diff_homogeneous}\\
            \ast\dr(\ast\mathbf{F}) &= 4\pi\mathbf{J}\,,
        \end{align}
        where $\ast$ is the Hodge operator \eqref{vector:explicit_hodge_star}.
    \end{formula}

    \newdef{Potential}{\index{potential}\index{gauge!field}
        The homogeneous equation~\eqref{maxwell:diff_homogeneous} and Poincar\'e's lemma~\ref{bundle:poincare} imply that there exists a differential one-form $\mathbf{A}$ such that
        \begin{gather}
            \mathbf{F} = \dr\mathbf{A}\,.
        \end{gather}
        This one-form is called the potential or \textbf{gauge field}. It can be related to the ordinary scalar potential $V$ and vector potential $\vector{A}$ as follows:
        \begin{gather}
            \mathbf{A} = -V\dr t + A_1\drx^1 + A_2\drx^2 + A_3\drx^3\,.
        \end{gather}
    }
    \begin{property}[Gauge transformation]\index{gauge!transformation}
        Because $d^2\equiv 0$, the above equation is invariant under a transformation $\mathbf{A}\longrightarrow\mathbf{A}+\dr f$ for any $f\in C^\infty(\mathbb{R}^3)$. When written out in local coordinates, this gives exactly the gauge transformations from \cref{maxwell:gauge_transformations}.
    \end{property}

    @@ COMPLETE (perhaps move to chapter on gauge theory) @@
\chapter{Statistical Mechanics}

\section{Axioms}

    \begin{axiom}[Ergodic principle]\index{ergodic!principle}
        All microstates corresponding to the same macrostate are equally probable.
    \end{axiom}

    \begin{axiom}[Boltzmann formula]\index{Boltzmann!entropy}\label{statmech:boltzmann_formula}
        The entropy of a system is given by
        \begin{gather}
            S := k\ln\Omega(E,V,N,\alpha)\,,
        \end{gather}
        where $\Omega$ denotes the number of microstates corresponding to the system with energy $E$ and any other state variables (these are denoted by $\alpha$). In general, $S$ will be the Shannon entropy (\cref{prob:shannon_entropy}).
    \end{axiom}

\section{Temperature}

    \begin{definition}\index{temperature}\label{statmech:temperature}
        The temperature of a system in contact with a heat bath is defined as follows:
        \begin{gather}
            T := \left(\pderiv{E}{S}\right)_V\,.
        \end{gather}
    \end{definition}

\section{Canonical ensemble}

    \newformula{Partition function}{\index{partition!function}\label{statmech:partition_function}
        The partition function for discrete systems is defined as
        \begin{gather}
            Z(T) := \sum_i{g_ie^{-\beta E_i}}\,.
        \end{gather}
        The analogue for continuous systems is
        \begin{gather}
            Z(T) := \Int\Omega(E,V,N)e^{-\beta E}\,dE\,.
        \end{gather}
    }

    \begin{formula}
        Consider a system of $N$ indistinguishable, noninteracting particles. Let $\varepsilon_i$ be the energy associated with the $i^{th}$ energy level and let $g_i$ be its degeneracy. The probability $p_i$ of finding a particle in the $i^{th}$ energy level is given by
        \begin{gather}
            p_i = \frac{g_i e^{-\beta E_i}}{Z}\,.
        \end{gather}
    \end{formula}

    \newdef{Helmholtz free energy}{\index{Helmholtz!free energy}\index{energy}\index{entropy!free}\index{Massieu potential}
        The Helmholtz free energy is defined as follows:
        \begin{gather}
            F := -k_BT\ln Z.
        \end{gather}
        For the canonical ensemble it can be shown that this is equal to a Legendre transformation of the energy: $F= E-TS$.

        One can also obtain the Helmholtz free energy as a different Legendre transform using the ideas of information theory (\cref{chapter:info}). There it was shown that the convex potentials associated to exponential families were related to the free energy. If \cref{info:free_energy} is compared to the above one, it can be seen that \[\psi = -\beta F\,.\] This quantity is sometimes called the \textbf{(Helmholtz) free entropy} or \textbf{Massieu potential} to distinguish it from the (Helmholtz) free energy. It was also shown that the associated dual coordinates are the expectation values, in this case the internal energy (up to a sign), and the dual potential was equal to the (negative) Shannon entropy. Putting this together gives:
        \begin{align*}
            \eta &= \beta\pderiv{\psi}{\beta} - \psi\\
            \overset{\text{def.}}{\iff} -S &= -\beta U+\beta F\\
            \iff F &= U - TS_B\,,
        \end{align*}
        where the relation between the Boltzmann entropy $S_B$ and the Shannon entropy $S$ was used.
    }

\section{Grand canonical ensemble}

    \newformula{Grand canonical partition function}{
        The partition function of the $i^{th}$ energy level is given by
        \begin{gather}
            \mathcal{Z}_i := \sum_{n_k}e^{\beta n_k(\mu - \varepsilon_i)}\,.
        \end{gather}
        The grand canonical partition function is given by
        \begin{gather}
            \mathcal{Z} := \prod_i\mathcal{Z}_i = \sum_{n_k, \varepsilon_i}e^{\beta n_k(\mu - \varepsilon_i)}\,.
        \end{gather}
    }
    \begin{remark}
        In the case of fermions, i.e.~$n_i\in\{0,1\}$, this formula reduces to
        \begin{gather}
            \mathcal{Z} = e^{\beta\mu N}Z\,,
        \end{gather}
        with $N$ the total particle number.
    \end{remark}

    \newdef{Fugacity}{\index{fugacity}\label{statmech:fugacity}
        \begin{gather}
            z := e^{\mu N}
        \end{gather}
    }

    \begin{formula}[Quantum mechanics]
        For quantum-mechanical systems one can rewrite the partition function as follows:
        \begin{gather}
            \mathcal{Z} = \tr\exp\left(-\beta\bigl(\hat{H}-\mu\hat{N}\bigr)\right)\,.
        \end{gather}
        This reduces to the above expressions when working in the single-particle eigenbasis (this is only possible for free theories).
    \end{formula}

\section{Energy}

    \begin{theorem}[Virial theorem]\index{virial theorem}\label{statmech:virial_theorem}
        \begin{gather}
            \langle E_{\text{kin}} \rangle = -\frac{1}{2}\sum_k\langle \vector{r}_k\cdot\vector{F}_k \rangle
        \end{gather}
    \end{theorem}
    \begin{result}
        For potentials of the form $V=ar^{-n}$ this becomes
        \begin{gather}
            2\langle E_{\text{kin}} \rangle = -n\langle V \rangle\,.
        \end{gather}
    \end{result}

    \begin{theorem}[Equipartition theorem]\index{equipartition theorem}
        Let $q$ be a generalized coordinate.
        \begin{gather}
            \left\langle q^k\pderiv{H}{q^l} \right\rangle = k_BT\delta_{kl}
        \end{gather}
    \end{theorem}
    \begin{result}
        For quadratic Hamiltonians this can be rewritten using Euler's theorem for homogeneous functions (\cref{calculus:euler_homogeneous_functions}):
        \begin{gather}
            \langle T \rangle = \frac{1}{2}k_BT\,.
        \end{gather}
    \end{result}

\section{Lattice systems}
\subsection{Ising model}\index{Ising model}

    The most well-known and widespread lattice system in statistical mechanics is the Ising model. It not only characterizes (ferro)magnets and spin glasses (approximately), but it can also be used to study brain signals, social networks or forest growth.

    \begin{formula}[Ising Hamiltonian]\label{statmech:ising}
        Let $\Lambda$ be a lattice in $\mathbb{R}^n$ and consider a collection of spins $\{S_i\}_{i\in\Lambda}$ on this lattice. If the external magnetic field is denoted by $h$, the Ising Hamiltonian has the following form:
        \begin{gather}
            H := -\sum_{\langle i,j \rangle\in\Lambda}J_{ij}S_iS_j-h\sum_{i\in\Lambda}S_i\,,
        \end{gather}
        where $\langle i,j \rangle$ denotes a pair of neighbouring indices. The constants $J_{ij}$ give the interaction strength between the neighbouring spins.\footnote{One can generalize this Hamiltonian to also allow for site-dependent external fields. However, this will not be of relevance here.}
    \end{formula}

    Two general situations can be distinguished: If all $J_{ij}>0$, the system is said to be \textbf{ferromagnetic}, while if all $J_{ij}>0$, the system is said to be \textbf{antiferromagnetic}. In the case of ferromagnetism and a vanishing external field, i.e.~$h=0$, the ground state of the Ising model is degenerate. All spins are alligned, i.e.~$S_iS_j=1$, but the orientation has no influence on the energy. However, when an external field is applied (even a very small one), the second term in the Hamiltonian induces a preferential orientation and the degeneracy is lifted.

    When the temperature is finite, i.e.~$T>0$, thermal fluctuations will start to randomly flip spins and the equilibrium state will not coincide with the perfectly ordered state anymore. The question now becomes if there exists a critical temperature $T_c$ at which the system changes between a disordered state and an ordered state. For one spatial dimension the solution was found by Ising.
    \begin{property}[$d=1$]
        For a one-dimensional lattice the Ising model does not undergo a phase transition at a finite temperature. However, at $T=0$, a second-order phase transition is obtained.

        The easiest way to prove this is through the transfer operator method, where the partition function is written as a product of transfer operators. Here, this is shown for a periodic chain with uniform interaction strength $J_{ij}\equiv J$:
        \begin{align}
            Z &= \sum_{\{S_1,\ldots,S_L\}}\exp\left(-\sum_{i=1}^{L-1}JS_iS_{i+1}-hS_i\right)\\
            &= \prod_{i=1}^{L-1}\sum_{S_i,S_{i+1}}\exp\left(-JS_iS_{i+1}-hS_i\right)\\
            &= \prod_{i=1}^{L-1}P_{i,i+1}\\
            &= \tr(P^L)\,.
        \end{align}
        The matrix $P_{i,i+1}$ is given by
        \begin{gather}
            P_{i,i+1} :=
            \begin{pmatrix}
                e^{\beta(J+h)}&e^{-\beta J}\\
                e^{-\beta J}&e^{\beta(J-h)}
            \end{pmatrix}
        \end{gather}
        for all $i\in\{1,\ldots,L\}$. The result then becomes $Z=\lambda^L_1+\lambda^L_2$, where $\lambda_1$ and $\lambda_2$ are the eigenvalues of $P$. In the thermodynamic limit, i.e.~$L\gg1$, only the largest eigenvalue will contribute:
        \begin{gather}
            \lambda_1 = e^{\beta J}\cosh(\beta h) + \sqrt{e^{2\beta J}\sinh^2(\beta h)+e^{-2\beta J}}\,.
        \end{gather}
        So, for $L\gg1$, the free energy density becomes
        \begin{gather*}
            f(T,J,h) = -\frac{k_BT}{L}\ln(Z) = -k_BT\left(e^{\beta J}\cosh(\beta h) + \sqrt{e^{2\beta J}\sinh^2(\beta h)+e^{-2\beta J}}\right)\,.
        \end{gather*}

        @@ FINISH @@
    \end{property}

    For higher-dimensional lattices a phase-transition is found at finite temperature. This was first proven by \textit{Onsager et al.} and required considerably more work than the one-dimensional setting.

\section{Black-body radiation}

    \begin{formula}[Planck's law]\index{Planck}\label{statmech:plancks_law_frequency}
        \begin{gather}
            B_\nu(\nu,T) = \frac{2h\nu^3}{c^2}\frac{1}{e^{\beta h\nu} - 1}
        \end{gather}
    \end{formula}

    \begin{formula}[Wien's displacement law]\index{Wien!displacement law}\index{Wien!constant}\label{statmech:wiens_displacement_law}
        \begin{gather}
            \lambda_{\text{max}}T = b\,,
        \end{gather}
        where the constant $b = 2.8977729(17)\mathrm{e}{-3}$ Km is called \textbf{Wien's displacement constant}.
    \end{formula}
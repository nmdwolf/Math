\chapter{Statistical Mechanics}

\section{Axioms}

    \begin{axiom}[Ergodic principle]\index{ergodic!principle}
        All microstates corresponding to the same macrostate are equally probable.
    \end{axiom}

    \begin{axiom}[Boltzmann formula]\index{Boltzmann!entropy}
        The entropy of a system is given by
        \begin{gather}
            \label{statmech:boltzmann_formula}
            S := k\ln\Omega(E,V,N,\alpha),
        \end{gather}
        where $\Omega$ denotes the number of microstates corresponding to the system with energy $E$, volume $V$, number of particles $N$ and any other state variable (these are denoted by $\alpha$). In general $S$ will be the Shannon entropy \ref{prob:shannon_entropy}.
    \end{axiom}

\section{Temperature}

    \begin{definition}\index{temperature}\label{statmech:temperature}
        The temperature of a system in contact with a heat bath is defined as follows:
        \begin{gather}
            T := \left(\pderiv{E}{S}\right)_V.
        \end{gather}
    \end{definition}

\section{Canonical ensemble}

    \newformula{Partition function}{\index{partition!function}\label{statmech:partition_function}
        The partition function for discrete systems is defined as
        \begin{gather}
            Z(T) := \sum_i{g_ie^{-\beta\varepsilon_i}}.
        \end{gather}
        The analogue for continuous systems is
        \begin{gather}
            Z(T) := \int\Omega(E,V,N)e^{-\beta E}dE.
        \end{gather}
    }

    \begin{formula}
        Consider a system of $N$ indistinguishable noninteracting particles. Let $\varepsilon_i$ be the energy associated with the $i^{th}$ energy level and let $g_i$ be its degeneracy. The probability $p_i$ of finding a particle in the $i^{th}$ energy level is given by
        \begin{gather}
            p_i = \frac{g_i e^{-\beta\varepsilon_i}}{Z}.
        \end{gather}
    \end{formula}

    \newdef{Helmholtz free energy}{\index{Helmholtz!free energy}\index{energy}\index{entropy!free}\index{Massieu potential}
        The Helmholtz free energy is defined as follows:
        \begin{gather}
            F := -k_BT\ln Z.
        \end{gather}
        For the canonical ensemble it can be shown that this is equal to a Legendre transformation of the energy: $F= E-TS$.

        One can also obtain the Helmholtz free energy as a different Legendre transform using the ideas of information theory (Chapter \ref{chapter:info}). There it was shown that the convex potentials associated to exponential families were related to the free energy. If Equation \eqref{info:free_energy} is compared to the above one, it can be seen that \[\psi = -\beta F.\] This quantity is sometimes called the \textbf{(Helmholtz) free entropy} or \textbf{Massieu potential} to distinguish it from the (Helmholtz) free energy. It was also shown that the associated dual coordinates are the expectation values, in this case the internal energy (up to a sign), and the dual potential was equal to the (negative) Shannon entropy. Putting this together gives:
        \begin{align*}
            \eta &= \beta\pderiv{\psi}{\beta} - \psi\\
            \overset{\text{def.}}{\iff} -S &= \beta (-U) - (-\beta F)\\
            \iff F &= U - TS_B,
        \end{align*}
        where the relation between the Boltzmann entropy $S_B$ and the Shannon entropy $S$ was used.
    }

\section{Grand canonical ensemble}

    \newformula{Grand canonical partition function}{
        The partition function of the $i^{th}$ energy level is given by
        \begin{gather}
            \mathcal{Z}_i := \sum_{n_k}e^{\beta n_k(\mu - \varepsilon_i)}.
        \end{gather}
        The grand canonical partition function is given by
        \begin{gather}
            \mathcal{Z} := \prod_i\mathcal{Z}_i = \sum_{n_k, \varepsilon_i}e^{\beta n_k(\mu - \varepsilon_i)}.
        \end{gather}
    }
    \remark{In the case of fermions, i.e. $n_i\in\{0,1\}$, this formula reduces to $\mathcal{Z} = e^{\beta\mu}Z$.}

    \newdef{Fugacity}{\index{fugacity}\label{statmech:fugacity}
        \begin{gather}
            z := e^{\mu N}
        \end{gather}
    }

    \begin{formula}[Quantum mechanics]
        For quantum-mechanical systems one can rewrite the partition function as follows:
        \begin{gather}
            \mathcal{Z} = \tr\exp\left(-\frac{\hat{H}-\mu\hat{N}}{T}\right).
        \end{gather}
        This reduces to the above expressions when working in the single-particle eigenbasis (this is only possible for free theories).
    \end{formula}

\section{Energy}

    \begin{theorem}[Virial theorem]\index{virial theorem}\label{statmech:virial_theorem}
        \begin{gather}
            \langle T \rangle = -\frac{1}{2}\sum_k\langle \vector{r}_k\cdot\vector{F}_k \rangle
        \end{gather}
    \end{theorem}
    \begin{result}
        For potentials of the form $V=ar^{-n}$ this becomes
        \begin{gather}
            2\langle T \rangle = -n\langle V \rangle.
        \end{gather}
    \end{result}

    \begin{theorem}[Equipartition theorem]\index{equipartition theorem}
        Let $x$ be a generalized coordinate.
        \begin{gather}
            \left\langle x^k\pderiv{H}{x^l} \right\rangle = k_bT\delta_{kl}
        \end{gather}
    \end{theorem}
    \begin{result}
        For quadratic Hamiltonians this can be rewritten using Euler's theorem for homogeneous functions \ref{calculus:euler_homogeneous_functions}:
        \begin{gather}
            \langle T \rangle = \frac{1}{2}k_bT.
        \end{gather}
    \end{result}

\section{Black-body radiation}

    \begin{formula}[Planck's law]\index{Planck}\label{statmech:plancks_law_frequency}
        \begin{gather}
            B_\nu(\nu,T) = \frac{2h\nu^3}{c^2}\frac{1}{e^{\frac{h\nu}{kt}} - 1}
        \end{gather}
    \end{formula}

    \begin{formula}[Wien's displacement law]\index{Wien}\label{statmech:wiens_displacement_law}
        \begin{gather}
            \lambda_{\max}T = b,
        \end{gather}
        where the constant $b = \num{2,8977729(17)E-3}$ Km is called \textbf{Wien's displacement constant}.
    \end{formula}
\chapter{Astronomy \& Cosomology}

\section{Astronomy}
\subsection{Orbital mechanics}

    \begin{theorem}[Cassini's laws]\index{Cassini}
        The following rules (approximately) characterize the orbit of the moon:
        \begin{enumerate}
            \item The Moon has a spin-orbit ratio/resonance of $1:1$.
            \item The inclination of the Moon's spin axis is constant with respect to the ecliptic plane. The axis does precess, tracing out a circle in the ecliptic plane.
            \item Choose any normal to the ecliptic plane and any normal to the Moon's orbital plane. The plane spanned by these vectors contains the Moon's spin axis.
        \end{enumerate}
    \end{theorem}
    \newdef{Cassini state}{\index{Cassini!state}
        A system obeying Cassini's laws.
    }

    \newdef{Laplace plane}{\index{Laplace!plane}
        Consider a satellite orbiting a planet. The Laplace plane is defined as that plane around whose normal the orbital axis of the satellite precesses. The (oriented) normal to the Laplace plane always lies in the plane spanned by the spin axis of the planet and the orbital axis of the planet. In fact it always lies between these two.
    }
    \begin{property}
        If the satellite orbits very close to the planet, its Laplace plane will coincide with the equatorial plane of the planet due to the equatorial bulge. If the satellite orbits very far away, the Laplace plane will coincide with the ecliptic plane.
    \end{property}

    @@ COMPLETE @@

\subsection{Ellipsoidal coordinates}\index{coordinate!ellipsoidal}

    Consider the following function:
    \begin{gather}
        \label{astronomy:ellipsoidal_defining_function}
        f(\tau) := \frac{x^2}{\tau + \alpha} + \frac{y^2}{\tau + \beta} + \frac{z^2}{\tau + \gamma} - 1\,,
    \end{gather}
    where $\alpha<\beta<\gamma<0$. The equation $f(\tau)=0$ can be rewritten as a degree-3 polynomial equation. It can be (formally) factorized as follows:
    \begin{gather}
        -(\tau-\lambda)(\tau-\mu)(\tau-\nu) = 0\,.
    \end{gather}
    The solutions of this equation obey the following conditions:
    \begin{itemize}
        \item $\nu\in\ ]-\gamma,-\beta[$\,,
        \item $\mu\in\ ]-\beta,-\alpha[$\,, and
        \item $\lambda\in\ ]-\alpha,\infty[$.
    \end{itemize}
    From the previous two equations, one can find a solution for $x^2$ by multiplying by $(\tau+\alpha)$ and taking the limit $\tau\rightarrow-\alpha$. Solutions for $y^2$ and $z^2$ can be found in a similar way:
    \begin{gather}
        \label{astronomy:ellipsoidal_coordinates}
        \begin{cases}
            x^2 = \frac{(\lambda + \alpha)(\mu + \alpha)(\nu + \alpha)}{(\beta - \alpha)(\gamma - \alpha)}\,,&\\
            y^2 = \frac{(\lambda + \beta)(\mu + \beta)(\nu + \beta)}{(\beta - \alpha)(\beta - \gamma)}\,,&\\
            z^2 = \frac{(\lambda + \gamma)(\mu + \gamma)(\nu + \gamma)}{(\alpha - \gamma)(\beta - \gamma)}\,.&
        \end{cases}
    \end{gather}
    These solutions can be divided in different families depending on the value of $\tau$.

    @@ CHECK THIS SECTION @@

\subsection{Ellipsoid: \texorpdfstring{$\tau=\lambda$}{tau equals lambda}}\index{ellipsoid}\index{focal!ellipse}

    The first family consists of the surfaces defined by fixing $\tau=\lambda$ in \cref{astronomy:ellipsoidal_defining_function}. By noting that all denominators are positive in this case, it can be seen that the obtained surface is an ellipsoid with the $x$-axis as the shortest axis. By taking the limit $\lambda\longrightarrow\infty$ the equation of a sphere with radius $\sqrt{\lambda}$ is obtained, whilst taking $\lambda\longrightarrow-\alpha$ results in an ellipse in the $yz$-plane. This ellipse is called the \textbf{focal ellipse}.

\subsection{One-sheeted hyperboloid: \texorpdfstring{$\tau=\mu$}{tau equals mu}}\index{focal!hyperboloid}\index{hyper-!boloid}

    By fixing $\tau=\mu$ in \cref{astronomy:ellipsoidal_defining_function}, the equation of a one-sheet hyperboloid (also called a \textbf{hyperbolic hyperboloid}) around the $x$-axis is obtained. By taking the limit $\mu\longrightarrow-\alpha$ the hyperboloid collapses on the $yz$-plane and the surface outside the focal ellipse is obtained. If one takes $\mu\longrightarrow-\beta$, the hyperboloid becomes degenerate and one gets the surface inside the \textbf{focal hyperbola} defined by
    \begin{gather}
        \label{astronomy:focal_hyperbola}
        \frac{x^2}{\alpha-\beta} + \frac{z^2}{\gamma-\beta} = 1\,.
    \end{gather}
    This hyperbola intersects the $z$-plane in the foci of the focal ellipse.

\subsection{Two-sheeted hyperboloid: \texorpdfstring{$\tau = \nu$}{}}

    By fixing $\tau=\nu$ in \cref{astronomy:ellipsoidal_defining_function} the equation of a two-sheet hyperboloid (also called an \textbf{elliptic hyperboloid}) around the $z$-axis is obtained. By taking the limit $\nu\longrightarrow-\beta$, the hyperboloid degenerates and one obtains the surface outside the focal hyperbola~\eqref{astronomy:focal_hyperbola}. If $\nu\longrightarrow-\gamma$ the two sheets coincide in the $xy$-plane.

\subsection{Hamilton--Jacobi equation}

    When writing out the kinetic energy in ellipsoidal coordinates and noting that mixed terms of the form $\pderiv{x^a}{\lambda^i}\pderiv{x^a}{\lambda^j}$ cancel due to \cref{astronomy:ellipsoidal_coordinates}, it is clear that the Hamiltonian function can be separated:
    \begin{gather}
        H = \frac{1}{2}\left(\frac{p_\lambda^2}{Q_\lambda^2} + \frac{p_\mu^2}{Q_\mu^2} + \frac{p_\nu^2}{Q_\nu^2}\right) + V\,,
    \end{gather}
    where $Q_j^2 = \sum_i\left(\pderiv{x^i}{\lambda^j}\right)^2$ are the metric coefficients in ellipsoidal coordinates. After a straightforward calculation, these can be found to be:
    \begin{gather}
        Q_\lambda^2 = \frac{1}{4}\frac{(\lambda-\mu)(\lambda-\nu)}{(\lambda+\alpha)(\lambda+\beta)(\lambda+\gamma)}.
    \end{gather}
    This expression is also valid for $\mu$ and $\nu$ after cyclically permutating the coordinates.

    Because of the St\"ackel conditions~\eqref{classic:stackel_condition}, the potential must be of the form
    \begin{gather}
        V = \sum_i\frac{W_i(\lambda^i)}{Q_i^2}
    \end{gather}
    if one wants to obtain a separable Hamilton--Jacobi equation. Due to the disjoint nature of $\lambda,\mu$ and $\nu$ one can consider $W_\lambda,W_\mu$ and $W_\nu$ as three components of a single function:
    \begin{gather}
        G(\tau) := -4(\tau+\beta)W_\tau(\tau)\,.
    \end{gather}
    The 3D potential is thus completely determined by a univariate function $G(\tau)$.

    If a time-independent system is considered, one can use the Hamilton--Jacobi equation~\eqref{classic:time_independent_hje} as the starting point. By multiplying this equation by $(\lambda - \mu)(\lambda - \nu)(\mu - \nu)$, one obtains
    \begin{multline}
        (\mu - \nu)\left[2(\lambda + \alpha)(\lambda + \beta)(\lambda + \gamma)\left(\deriv{S^\lambda(\lambda)^2}{\lambda}\right)\right.\\ - (\lambda + \alpha)(\lambda + \gamma)G(\lambda) - \lambda^2E \Bigr] + \text{cyclic permutations} = 0\,,
    \end{multline}
    where the multiplicative factor was rewritten in the form $a\lambda^2 + b\mu^2 + c\nu^2$ before multiplying the right-hand side of \cref{classic:time_independent_hje}. This equation can also be rewritten as
    \begin{gather}
        (\mu-\nu)U(\lambda) + (\lambda-\mu)U(\nu) + (\nu-\lambda)U(\mu) = 0\,.
    \end{gather}
    Differentiating twice with respect to any $\lambda^i$, gives $U''(\tau) = 0$ or, equivalently,
    \begin{gather}
        U(\tau) = I_3 - I_2\tau\,,
    \end{gather}
    where $I_2$ and $I_3$ are two new integrals of motion.

    Using the Hamiltonian--Jacobi equation~\eqref{classic:hamilton_jacobi_equation}, one can obtain the conjugate momenta. A lengthy calculation gives
    \begin{gather}
        p_\tau^2 = \left(\deriv{S^\tau}{\tau}\right)^2 = \frac{1}{2(\tau+\beta)}\bigl[E - V_{\text{eff}}(\tau)\bigr]\,,
    \end{gather}
    where the effective potential is given by
    \begin{gather}
        V_{\text{eff}} = \frac{J}{\tau+\alpha} + \frac{K}{\tau+\gamma} - G(\tau)\,.
    \end{gather}
    The two conserved quantities $J$ and $K$ are given by
    \begin{gather}
        J = \frac{\alpha^2E + \alpha I_2 + I_3}{\alpha - \gamma} \qquad\text{and}\qquad K = \frac{\gamma^2E + \gamma I_2 + I_3}{\gamma - \alpha}\,.
    \end{gather}
    To be physically acceptable, $p_\tau^2$ should be positive. This leads to following conditions on the energy:
    \begin{gather}
        \begin{cases}
            E&\geq V_{\text{eff}}(\lambda)\,,\\
            E&\geq V_{\text{eff}}(\mu)\,,\\
            E&\leq V_{\text{eff}}(\nu)\,.
        \end{cases}
    \end{gather}
    The generating function $G(\tau)$ should also satisfy some conditions. Note that the St\"ackel potential $V(\lambda,\mu,\nu)$ can be rewritten as
    \begin{gather}
        \label{astronomy:potential2}
        V = -\frac{1}{\lambda - \nu}\left(\frac{F(\lambda) - F(\mu)}{\lambda - \mu} - \frac{F(\mu) - F(\nu)}{\mu - \nu}\right) \leq 0\,,
    \end{gather}
    where $F(\tau) = (\tau + \alpha)(\tau + \gamma)G(\tau)$. For $\lambda\longrightarrow+\infty$ (or $r^2\longrightarrow+\infty$), one obtains $V\approx-\frac{F(\lambda)}{\lambda^2}\approx-G(\lambda)$. Because $V\sim \lambda^{-1}$, it is clear that $G(\tau)$ cannot decay faster than $\lambda^{-1/2}$ at infity. Furthermore, one can interpret \cref{astronomy:potential2} as an approximation of $-F''(\tau)$. It follows that $F(\tau)$ should be convex. For $\tau\longrightarrow-\gamma$ one obtains
    \begin{gather}
        \begin{cases}
            \alpha + \tau < 0\,,\\
            \tau + \gamma\longrightarrow 0\,.
        \end{cases}
    \end{gather}
    So, if $G(\tau)$ decays faster than $\frac{1}{\tau + \gamma}$, then $F(\tau)\longrightarrow-\infty$, which is not possible for a convex function.

    To fulfil these conditions, assume that the generating function can be written as
    \begin{gather}
        G(\tau) = \frac{GM}{\sqrt{\gamma_0 + \tau}}\,,
    \end{gather}
    where $G$ is the gravitational constant and $M$ is the galactic mass.

    \todo{COMPLETE}

    \begin{theorem}[Kuzmin]\index{Kuzmin}
        The spatial mass density function generated by a St\"ackel potential is completely determined by a function of the form $\rho(z)$.
    \end{theorem}
    \begin{result}
        For triaxial mass models in ellipsoidal coordinates, the axial ratios are inversely proportional to the axial ratios of the coordinate system.
    \end{result}
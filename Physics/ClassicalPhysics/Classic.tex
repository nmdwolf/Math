\chapter{Classical Mechanics}\label{chapter:lagrange}

    The section about the geometric framework is mainly based on~\citet{palais_symmetries_1997,arnold_mathematical_2013}. For an introduction to differential geometry, see \cref{chapter:manifolds} and onwards.

    \minitoc

\section{Newtonian mechanics}
\subsection{Linear motion}

    \begin{axiom}[Newton's second law]\index{force}\label{classic:force}
        The force acting on a system is related to the change in momentum in the following way:
        \begin{gather}
            \vector{F}=\deriv{\vector{p}}{t}\,.
        \end{gather}
    \end{axiom}

    \newdef{Work}{\index{work}\label{classic:work}
        The work performed along a trajectory $\gamma$ is given by
        \begin{gather}
            W := \Int_\gamma\vector{F}\cdot d\vector{l}\,.
        \end{gather}
    }
    \newdef{Conservative force}{\index{conservative!force}\index{potential}
        If the work done by a force is independent of the path taken, the force is said to be \textbf{conservative}:
        \begin{gather}
            \label{classic:conservative_force_2}
            \Oint_C\vector{F}\cdot d\vector{l}=0\,.
        \end{gather}
        The Kelvin--Stokes theorem~\ref{vector:kelvin_stokes_theorem} together with \cref{vector:rotor_of_gradient} allows to rewrite the conservative force as the gradient of a scalar field $V:\mathbb{R}^3\rightarrow\mathbb{R}$:
        \begin{gather}
            \label{classic:conservative_force}
            \vector{F} = -\nabla V\,.
        \end{gather}
        Note that the \textbf{potential (energy)} $V$ is only defined up to a constant.
    }

    \newdef{Central force}{
        A force that only depends on the relative position of two objects:
        \begin{gather}
            \vector{F}_c = F\bigl(\|\vector{r}_2 - \vector{r}_1\|\bigr)\symbf{\hat{e}_r}\,.
        \end{gather}
    }

    \begin{formula}[Momentum]\index{momentum}
        Consider a mass $m$ with velocity $\vector{v}$. Its momentum is given by
        \begin{gather}
            \vector{p} = m\vector{v}\,.
        \end{gather}
        If the mass remains constant along the trajectory, Newton's second law (\cref{classic:force}) can be rewritten as follows:
        \begin{gather}
            \vector{F} = m\deriv{\vector{v}}{t} = m\vector{a}\,.
        \end{gather}
    \end{formula}

    \begin{formula}[Kinetic energy]\index{energy}\label{classic:kinetic_energy}
        For a free particle with total momentum $p$, the kinetic energy is given by the following formula:
        \begin{gather}
            E_{\text{kin}} := \frac{p^2}{2m}\,.
        \end{gather}
    \end{formula}

\subsection{Rotational motion}

    In this section, $r\in\mathbb{R}^+$ always denotes the distance from the object's center of mass to the axis around which the object rotates. More generally, the vector $\vector{r}\in\mathbb{R}^3$ will denote the position with respect to the axis of rotation.

    \newdef{Angular velocity}{\label{classic:angular_velocity}
        \begin{gather}
            \vector{\omega} := \frac{\vector{r}\times\vector{v}}{r^2}
        \end{gather}
    }
    \newdef{Angular frequency}{\label{classic:frequency}
        \begin{gather}
            \nu := \frac{\|\vector{\omega}\|}{2\pi}
        \end{gather}
    }

    \newdef{Moment of inertia}{\index{inertia}\label{classic:moment_of_inertia}
        For a (spherically) symmetric object, the moment of inertia is given by
        \begin{gather}
            I := \Int_Vr^2\rho(r)\,dV\,,
        \end{gather}
        where $\rho:\mathbb{R}^3\rightarrow\mathbb{R}^+$ denotes the mass density function. For a general body, the moment-of-inertia tensor is given by
        \begin{gather}
            \label{classic:inertia_tensor}
            \mathcal{I} := \Int_V\rho(\vector{r})\left(r^2\mathbbm{1}_{3\times3} - \vector{r}\otimes\vector{r}\right)\,dV\,.
        \end{gather}
    }

    \begin{example}[Azimuthal symmetry]
        Let $M,R$ denote the mass and the radius of the object, respectively. The (scalar) inertia of some common objects is given:
        \begin{itemize}
            \item Solid disk: $I = \frac{1}{2}MR^2$,
            \item Cylindrical shell: $I = MR^2$,
            \item Hollow sphere: $I = \frac{2}{3}MR^2$, and
            \item Solid sphere: $I = \frac{2}{5}MR^2$.
        \end{itemize}
        A proof for the solid disk and sphere are given:
        \begin{mdframed}[roundcorner=10pt, linecolor=blue, linewidth=1pt]
            \begin{proof}
                The volume of a (solid) disk is given by
                \begin{gather*}
                    V_{\emph{disk}}=\pi R^2d\,,
                \end{gather*}
                where $R$ denotes the radius and $d$ denotes the thickness. The mass density is then given by
                \begin{gather*}
                    \rho=\frac{M}{\pi R^2d}\,.
                \end{gather*}
                Using cylindrical coordinates, the moment of inertia becomes
                \begin{align*}
                    I &= \frac{M}{\pi R^2d}\Int_0^{2\pi}d\varphi\Int_0^ddz\Int_0^Rr^3\,dr\\
                    &= \frac{M}{\pi R^2d}2\pi d\frac{R^4}{4}\\
                    &= \frac{1}{2}MR^2\,.
                \end{align*}
                The volume of a solid sphere is given by
                \begin{gather*}
                    V_{\emph{sphere}} = \frac{4}{3}\pi R^3\,,
                \end{gather*}
                where $R$ denotes the radius. The mass density is then given by
                \begin{gather*}
                    \rho = \frac{M}{\frac{4}{3}\pi R^3}\,.
                \end{gather*}
                Spherical coordinates will be used to derive the moment of inertia, but one has to be careful. The $r$ in \cref{classic:moment_of_inertia} is the distance between a point in the body and the axis of rotation. Hence, it is not the same as the radial coordinate $r'$ in spherical coordinates, which is the distance between a point and the origin. However, the relation between these two quantities is easily found using basic geometry:
                \begin{gather*}
                    r=r'\sin\theta\,.
                \end{gather*}
                Now, one can calculate the moment of inertia as follows:
                \begin{align*}
                    I &= \frac{M}{\frac{4}{3}\pi R^3}\Int_0^{2\pi}d\varphi\Int_0^Rr'^{^4}\,dr'\Int_0^\pi\sin^3\theta\,d\theta\\
                    &= \frac{M}{\frac{4}{3}\pi R^3} 2\pi\frac{R^5}{5}\frac{4}{3}\\
                    &= \frac{2}{5}MR^2\,.
                \end{align*}
            \end{proof}
        \end{mdframed}
    \end{example}

    \newdef{Principal axes of inertia}{\index{principal!axis}
        Let $I$ be the matrix of inertia, i.e.~the matrix associated with the inertia tensor in \cref{classic:inertia_tensor}. This is a real symmetric matrix and, by \cref{linalgebra:diagonalizable_hermitian}, admits an eigendecomposition of the form
        \begin{gather}
            I = Q\Lambda Q^T\,.
        \end{gather}
        The columns of $Q$ determine the principal axes of inertia. The eigenvalues are called the \textbf{principal moments of inertia}.
    }

    \begin{theorem}[Parallel axis theorem\footnotemark]\index{Steiner}\index{parallel axis theorem}\label{classic:theorem:parallel_axis_theorem}
        \footnotetext{Also called \textbf{Steiner's theorem}.}
        Consider a rotation about an axis $\psi$ through a point $A$ and let $\psi_{\emph{CM}}$ be a parallel axis through the center of mass. The moment of inertia about $\psi$ is related to the moment of inertia about $\psi_{\text{CM}}$ in the following way:
        \begin{gather}
            I_\psi = I_{\text{CM}} + m\|\vector{r}_A - \vector{r}_{\text{CM}}\|^2\,,
        \end{gather}
        where $m$ is the mass of the rotating body.
    \end{theorem}

    \newdef{Angular momentum}{\label{classic:angular_momentum}
        \begin{gather}
            \vector{L} := \vector{r}\times\vector{p}
        \end{gather}
        Given the angular velocity vector $\vector{\omega}$, one can compute the angular momentum as follows:
        \begin{gather}
            \label{classic:angular_momentum_general}
            \vector{L} = \mathcal{I}(\vector{\omega})\,,
        \end{gather}
        where $\mathcal{I}$ is the inertia tensor. If $\vector{\omega}$ is parallel to a principal axis, the formula reduces to
        \begin{gather}
            \vector{L} = I\vector{\omega}\,,
        \end{gather}
        where $I$ is the corresponding principal moment of inertia.
    }

    \begin{formula}[Torque]\index{torque}\label{classic:torque}
        For angular momenta, there exists a formula analogous to Newton's second law:
        \begin{gather}
            \vector{\tau} :=\deriv{\vector{L}}{t}\,.
        \end{gather}
        For a constant mass, this formula can be rewritten as follows:
        \begin{gather}
            \vector{\tau} = \mathcal{I}(\vector{\alpha}) = \vector{r}\times\vector{F}\,,
        \end{gather}
        where
        \begin{gather}
            \vector{\alpha} := \deriv{\vector{\omega}}{t}
        \end{gather}
        is the \textbf{angular acceleration}.
    \end{formula}

    \begin{remark}
        From the previous definitions, it follows that both the angular momentum and torque vectors are in fact pseudovectors and, accordingly, change sign under coordinate transformations with negative determinant.
    \end{remark}

    \newformula{Rotational energy}{\index{energy}\label{classic:rotational_energy}
        \begin{gather}
            E_{\text{rot}} := \frac{1}{2}\mathcal{I}(\vector{\omega})\cdot\vector{\omega}
        \end{gather}
    }

\section{Lagrangian mechanics}
\subsection{Action}

    \newdef{Generalized coordinates}{\index{generalized!coordinate}
        The generalized coordinates are mutually independent coordinates that completely characterize the configuration of a system (relative to a reference configuration).

        When a system is characterized by $N$ parameters and $n_c$ constraints, there are $N-n_c$ generalized coordinates. Furthermore, every set of generalized coordinates describing the same system contains exactly $N-n_c$ coordinates. (In \cref{chapter:constrained_dynamics}, it is explained how the relevant degrees of freedom can be extracted.)
    }
    \newdef{Generalized velocities}{
        The generalized velocities $\dot{q}^k$ are the derivatives of the generalized coordinates $q^k$ with respect to time.
    }
    \newdef{Conjugate momentum}{\index{momentum!conjugate}\label{classic:conjugate_momentum}
        \begin{gather}
            p_k := \pderiv{L}{\dot{q}^k}
        \end{gather}
    }

    \begin{notation}\label{classic:notational_convention_1}
        Given a Lagrangian function $L:\mathbb{R}^{2n+1}\rightarrow\mathbb{R}$, depending on $n$ generalized coordinates and their associated velocities, the following shorthand notation is often used:
        \begin{gather}
            L(q,\dot{q},t)\equiv L\bigl(q_1(t),\ldots,q_n(t),\dot{q}_1(t),\ldots,\dot{q}_n(t),t\bigr)\,.
        \end{gather}
    \end{notation}
    \newdef{Action}{\index{action}\label{classic:action}
        Given a Lagrangian function $L$, the action is a functional on the space of paths in configuration space defined by integrating $L$:
        \begin{gather}
            S[q] := \Int_{t_1}^{t_2}L(q,\dot{q},t)\,dt\,.
        \end{gather}
    }

\subsection{Euler--Lagrange equations}\index{Euler--Lagrange!equations}

    \begin{axiom}[d'Alembert's principle]\index{d'Alembert!principle}\index{virtual!displacement}\label{classic:dalembert_principle}
        \begin{gather}
            \sum_i(\vector{F}_i-\dot{\vector{p}}_i)\cdot\delta\vector{q}^i=0\,,
        \end{gather}
        where the $\delta\vector{q}^i$ denote the \textbf{virtual displacement} vectors, i.e.~the infinitesimal variations consistent with the contraints. In the spirit of calculus of variations (\cref{section:variational_calculus}), these are defined as follows. Consider a trajectory $\vector{q}:[0,1]\rightarrow\mathbb{R}^n$ and a variation $\vector{\gamma}$ of $\vector{q}$, i.e.~a smooth function $\vector{\gamma}:[0,1]\times[-\varepsilon,\varepsilon]\rightarrow\mathbb{R}^n$ such that $\vector{\gamma}(t,0)=\vector{q}(t)$. This function encodes how $\vector{q}$ can vary given the constraints of the system. The virtual displacement vector is then defined as the tangent vector
        \begin{gather}
            \delta\vector{q} := \left.\deriv{\vector{\gamma}}{\varepsilon}\right|_{\varepsilon=0}\,.
        \end{gather}
    \end{axiom}

    \begin{formula}[Euler--Lagrange equation of the first kind]\index{generalized!force}\index{Euler--Lagrange!equations}
        \begin{gather}
            \label{classic:first_kind}
            \deriv{}{t}\left(\pderiv{T}{\dot{q}^k}\right) - \pderiv{T}{q^k}=Q_k\,,
        \end{gather}
        where $T$ is the total kinetic energy and $Q_k$ are the \textbf{generalized forces}:
        \begin{gather}
            Q_k := \sum_i\vector{F}_i\cdot\pderiv{\vector{r}_i}{q^k}\,.
        \end{gather}
        Note that the constraint forces do not contribute to this quantity because they are always perpendicular to the motion.
    \end{formula}
    \begin{formula}[Euler--Lagrange equation of the second kind]
        \begin{gather}
            \label{classic:second_kind}
            \deriv{}{t}\left(\pderiv{L}{\dot{q}^k}\right) - \pderiv{L}{q^k} = 0
        \end{gather}
        Two proofs are provided:
        \begin{mdframed}[roundcorner=10pt, linecolor=blue, linewidth=1pt]
            \begin{proof}[Proof based on d'Alembert's principle]
                In the following derivation, the mass is assumed to be constant.
                \begin{align*}
                    &\sum_k\left(\vector{F}_k - \dot{\vector{p}}_k\right)\cdot\dot{\vector{r}}_k = 0\\
                    \iff&\sum_k\left(\vector{F}_k - \dot{\vector{p}}_k\right)\cdot\left(\sum_l\pderiv{\vector{r}_k}{q^l}\dot{q^l}\right) = 0\\
                    \iff&\sum_l\left(\sum_k\vector{F}_k\cdot\pderiv{\vector{r}_k}{q^l} - \sum_km\ddot{\vector{r}}_k\cdot\pderiv{\vector{r}_k}{q^l}\right)\dot{q^l} = 0\\
                    \iff&\sum_l\left(Q_l - \sum_km\ddot{\vector{r}}_k\cdot\pderiv{\vector{r}_k}{q^l}\right)\dot{q^l} = 0\,.
                \end{align*}
                Now, consider the following derivative:
                \begin{align*}
                    &\deriv{}{t}\left(\dot{\vector{r}}\cdot\pderiv{\vector{r}}{q^l}\right) = \ddot{\vector{r}}\cdot\pderiv{\vector{r}}{q^l} + \dot{\vector{r}}\cdot\deriv{}{t}\left(\pderiv{\vector{r}}{q^l}\right)\\
                    \iff&\ddot{\vector{r}}\cdot\pderiv{\vector{r}}{q^l} = \deriv{}{t}\left(\dot{\vector{r}}\cdot\pderiv{\vector{r}}{q^l}\right) - \dot{\vector{r}}\cdot\deriv{}{t}\left(\pderiv{\vector{r}}{q^l}\right)\\
                    \iff&\ddot{\vector{r}}\cdot\pderiv{\vector{r}}{q^l} = \deriv{}{t}\left(\dot{\vector{r}}\cdot{\color{red}\underbrace{\textcolor{black}{\pderiv{\vector{r}}{q^l}}}_A}\right) - \dot{\vector{r}}\cdot\pderiv{\dot{\vector{r}}}{q^l}\,.
                \end{align*}
                To evaluate the factor indicated by \textcolor{red}{A}, one can consider another derivative:
                \begin{align*}
                    \pderiv{\dot{\vector{r}}}{\dot{q}^l} &= \pderiv{}{\dot{q}^l}\left(\sum_k\pderiv{r}{q^k}\dot{q}^k\right)\\
                    &=\sum_k\pderiv{r}{q^k}\delta_{kl}\\
                    &=\pderiv{\vector{r}}{q^l}\\
                    &=\textcolor{red}{A}\,.
                \end{align*}
                Substituting this in the previous equation gives
                \begin{gather*}
                    %\label{lagrange_deriv:deriv3}
                    \begin{aligned}
                        \ddot{\vector{r}}\cdot\pderiv{\vector{r}}{q^l} &= \deriv{}{t}\left(\dot{\vector{r}}\cdot\pderiv{\dot{\vector{r}}}{\dot{q}^l}\right) - \dot{\vector{r}}\cdot\left(\pderiv{\dot{\vector{r}}}{q^l}\right)\\
                        &=\deriv{}{t}\left(\frac{1}{2}\pderiv{\dot{\vector{r}}^2}{\dot{q}^l}\right) - \frac{1}{2}\pderiv{\dot{\vector{r}}^2}{q^l}\,.
                    \end{aligned}
                \end{gather*}
                If one multiplies this by the mass $m$ and sums over all masses, the following expression is obtained:
                \begin{align*}
                    \sum_km_k\ddot{\vector{r}}_k\cdot\pderiv{\vector{r}_k}{q^l}=\ &\deriv{}{t}\pderiv{}{\dot{q}^l}\left(\sum_k\frac{1}{2}m\dot{\vector{r}}_k^2\right) - \pderiv{}{q^l}\left(\sum_k\frac{1}{2}m\dot{\vector{r}}_k^2\right)\\
                    =\ &\deriv{}{t}\pderiv{T}{\dot{q}^l} - \pderiv{T}{q^l}%\label{lagrange_deriv:deriv4}\,,
                \end{align*}
                where the total kinetic energy is denoted by $T$ in the last line. Plugging this result into the first equation gives
                \begin{gather*}
                    \sum_l\left(Q_l - \deriv{}{t}\pderiv{T}{\dot{q}^l} - \pderiv{T}{q^l}\right)\dot{q^l} = 0\,.
                \end{gather*}
                Because all the coordinates $q^l$ are independent, the following relation should hold for all $l$:
                \begin{gather*}
                    \begin{aligned}
                        &Q_l - \deriv{}{t}\left(\pderiv{T}{\dot{q}^l}\right) - \pderiv{T}{q^l} = 0\\
                        \iff&\deriv{}{t}\left(\pderiv{T}{\dot{q}^l}\right) - \pderiv{T}{q^l} = Q_l\,.
                    \end{aligned}
                \end{gather*}
                This last equation is the Euler--Lagrange equation of the first kind. If the system only contains conservative forces, the force on the $i^{th}$ mass can be written as
                \begin{gather*}
                    F_i = -\nabla_iV\,.
                \end{gather*}
                With this in mind, one can relate the partial derivatives of the potential to the generalized forces:
                \begin{gather*}
                    \begin{aligned}
                        \pderiv{V}{q^l} &= \sum_i\left(\nabla_iV\right)\cdot\pderiv{\vector{r}_i}{q^l}\\
                        &=-Q_l\,.
                    \end{aligned}
                \end{gather*}
                Furthermore, the derivative of $V$ with respect to the generalized velocities vanishes. This, combined with the Euler--Lagrange equation of the first kind, gives
                \begin{align*}
                    &\deriv{}{t}\left(\pderiv{T}{\dot{q}^l}\right) - \pderiv{T}{q^l} = Q_l\\
                    \iff&\deriv{}{t}\left(\pderiv{T}{\dot{q}^l}\right) - \pderiv{T}{q^l} = -\pderiv{V}{q^l} + \pderiv{V}{\dot{q}^l}\\
                    \iff&\deriv{}{t}\left(\pderiv{T}{\dot{q}^l} - \pderiv{V}{\dot{q}^l}\right) - \pderiv{}{q^l}\left(T - V\right) = 0\,.
                \end{align*}
                If one introduces the Lagrangian $L:=T-V$, one gets the Euler--Lagrange equation of the second kind:
                \begin{gather*}
                    \deriv{}{t}\left(\pderiv{L}{\dot{q}^l}\right) - \pderiv{L}{q^l} = 0\,.
                \end{gather*}$ $
            \end{proof}
        \end{mdframed}

        \begin{mdframed}[roundcorner=10pt, linecolor=blue, linewidth=1pt]
            \begin{proof}[Proof based on the principle of least action]\index{Hamilton!principle}
                First, recall \cref{classic:action} of the action:
                \begin{gather*}
                    S[q] := \Int_{t_1}^{t_2}L\bigl(q(t),\dot{q}(t),t\bigr)\,dt\,.
                \end{gather*}
                The principle of least action (also called \textbf{Hamilton's principle}) postulates that the action is minimal for the physically relevant path. To this end, define a family of paths
                \begin{gather*}
                    q(t,\alpha) = q(t) + \alpha\eta(t)\,,
                \end{gather*}
                where $\eta(t)$ is an arbitrary function satisfying the following boundary conditions:
                \begin{gather*}
                    \begin{cases}
                    &\eta(t_1) = 0\,,\\
                    &\eta(t_2) = 0\,.
                    \end{cases}
                \end{gather*}
                If the action integral is extended to such a family, the integral becomes a function of $\alpha$:
                \begin{gather*}
                    S(\alpha) := \Int_{t_1}^{t_2}L\bigl(q(t,\alpha),\dot{q}(t,\alpha),t\bigr)\,dt\,.
                \end{gather*}
                Requiring that the action integral is stationary for the physical path $q(t)$, where $\alpha=0$, is equivalent to requiring that the derivative at $\alpha=0$ vanishes:
                \begin{gather*}
                    \left.\deriv{S}{\alpha}\right|_{\alpha=0} = 0\,.
                \end{gather*}
                As one evaluates this derivative at $\alpha=0$, $q(t,\alpha)$ coincides with $q(t)$ in this expression:
                \begin{gather*}
                    \begin{aligned}
                        \deriv{S}{\alpha}&=\Int_{t_1}^{t_2}\sum_l\left[\pderiv{L}{q^l}\pderiv{q^l}{\alpha} + \pderiv{L}{\dot{q}^l}\pderiv{\dot{q}^l}{\alpha}\right]\,dt\\
                        &=\Int_{t_1}^{t_2}\sum_l\left[\pderiv{L}{q^l}\eta^l(t) + \pderiv{L}{\dot{q}^l}\dot{\eta}^l(t)\right]\,dt\,.
                    \end{aligned}
                \end{gather*}
                By applying integration by parts to the second term in this integral, one obtains
                \begin{align*}
                    \deriv{S}{\alpha}&=\Int_{t_1}^{t_2}\sum_l\left[\pderiv{L}{q^l}(t)\eta^l(t) + \pderiv{L}{\dot{q}^l}(t)\dot{\eta}^l(t)\right]\,dt\\
                    &=\Int_{t_1}^{t_2}\sum_l\pderiv{L}{q^l}(t)\eta^l(t)\,dt + \pderiv{L}{\dot{q}^l}(t_2)\eta^l(t_2) - \pderiv{L}{\dot{q}^l}(t_1)\eta^l(t_1) - \Int_{t_1}^{t_2}\deriv{}{t}\left(\pderiv{L}{\dot{q}^l}\right)\eta^l(t)\,dt\,.
                \end{align*}
                Due to the initial conditions for the function $\eta$, the second and third term vanish:
                \begin{gather*}
                    \deriv{S}{\alpha}=\Int_{t_1}^{t_2}\sum_l\left[\pderiv{L}{q^l} - \deriv{}{t}\left(\pderiv{L}{\dot{q}^l}\right)\right]\eta^l(t)\,dt\,.
                \end{gather*}
                Furthermore, because the function $\eta$ was arbitrary, the only possible way that this derivative can be zero is when the integrand itself is zero:
                \begin{gather*}
                    \pderiv{L}{q^l} - \deriv{}{t}\left(\pderiv{L}{\dot{q}^l}\right) = 0\,.
                \end{gather*}
                Comparing this result to \cref{classic:second_kind} shows that one can also obtain the Lagrangian equations of the second kind by starting from the principle of least action.
            \end{proof}
        \end{mdframed}
    \end{formula}

    \begin{definition}[Cyclic coordinate]\index{cyclic}
        If the Lagrangian $L$ does not explicitly depend on a coordinate $q^k$, the coordinate is said to be cyclic.
    \end{definition}

    \begin{theorem}[Noether]\index{Noether}\label{classic:noether_cyclic}
        The conjugate momentum of a cyclic coordinate is a conserved quantity:
        \begin{gather}
            \dot{p}_k \overset{\ref{classic:conjugate_momentum}}{=} \deriv{}{t}\left(\pderiv{L}{\dot{q}^k}\right)\overset{{\eqref{classic:second_kind}}}{=}\pderiv{L}{q^k}=0\,.
        \end{gather}
    \end{theorem}

\subsection{Kepler problem}\index{Kepler!problem}\label{section:kepler}

    \begin{formula}[Gravitational potential for a point mass]\index{gravity}\label{classic:gravitational_potential}
        \begin{gather}
            V = -G\frac{M}{r}\,,
        \end{gather}
        where $G=6,67\mathrm{e}{-11}\frac{\mathrm{Nm}^2}{\mathrm{kg}^2}$ is the \textbf{gravitational constant}.
    \end{formula}

    To solve the Kepler problem, it is useful to perform a coordinate transformation. Simultaneously, one passes to the \textbf{center-of-mass reference frame}\index{center of mass}
    \begin{gather}
        \vector{R} := \frac{m_1\vector{r}_1+m_2\vector{r}_2}{m_1+m_2}\qquad\qquad M:=m_1+m_2
    \end{gather}
    and also introduces the \textbf{reduced mass}:\index{mass!reduced}
    \begin{gather}
        \vector{r}:=\vector{r}_1-\vector{r}_2\qquad\qquad\mu:=\frac{m_1m_2}{m_1+m_2}\,.
    \end{gather}
    With these coordinates, the Kepler Lagrangian becomes:
    \begin{gather}
        L_{\text{Kepler}} = \frac{1}{2}M\dot{R}^2 + \frac{1}{2}\mu\dot{r}^2 + \frac{GM}{r}\,.
    \end{gather}
    The first consequence of this transformation is that the equations of motion decouple. The center of mass behaves as a free particle:
    \begin{gather}
        M\ddot{\vector{R}} = 0\,,
    \end{gather}
    whereas the displacement vector and reduced mass are those of a particle influenced by a gravitational force:
    \begin{gather}
        \mu\ddot{\vector{r}} = \frac{GM}{r^2}\symbf{\hat{e}_r}\,.
    \end{gather}

    \begin{theorem}[Bertrand]\index{Bertrand}
        The only central force problems with closed, bounded orbits, are given by the inverse potential
        \begin{gather}
            V(r)\sim\frac{1}{r}
        \end{gather}
        and harmonic potential
        \begin{gather}
            V(r)\sim r^2\,.
        \end{gather}
    \end{theorem}

    \newdef{Laplace--Runge--Lenz vector}{\index{Laplace--Runge--Lenz vector}\label{classic:lrl_vector}
        Although all conservative central force problems have some common symmetries (time translations and rotations), the central force problems with a $1/r$-potential have an extra symmetry. However, in contrast to the ordinary Euclidean symmetries, this new symmetry is harder to understand. It is a dynamical symmetry (\cref{symplectic:dynamical_symmetry}) instead of a kinematical one (\cref{symplectic:kinematical_symmetry}), i.e.~it cannot simply be deduced from the Lagrangian.

        Before explaining the symmetry itself, the associated Noether charge (\cref{symplectic:noether}), the Laplace--Runge--Lenz vector, is given:
        \begin{gather}
            \vector{A} := \vector{p}\times\vector{L} - mk\vector{r}\,,
        \end{gather}
        where $m$ denotes the mass and $k$ fixes the scale of the potential:
        \begin{gather}
            V(r) = \frac{k}{r}\,.
        \end{gather}
        The reason why this conserved quantity cannot be obtained from a cyclic coordinate of the ordinary Lagrangian is that it is actually associated to a 4-dimensional problem. The central problem with an inverse-square force law can be reformulated as the free motion of a particle in 4 dimensions and only in this description can the Noether charge be obtained from a cyclic coordinate.
    }

\section{Hamiltonian mechanics}

    \newdef{Canonical coordinates}{\index{canonical!coordinates}
        Consider the generalized coordinates $(q,\dot{q},t)$. From these, one can derive a new set of coordinates, called canonical coordinates, by exchanging the time derivatives $\dot{q}^i$ in favour of the conjugate momenta $p_i$.

        This is only equivalent if the transformation $(q,\dot{q})\leftrightarrow(q,p)$ is invertible. A sufficient condition is that the Hessian of $L$ with respect to the generalized velocities is invertible.
    }

    \newdef{Hamiltonian function}{\index{Hamilton!function}\label{classic:hamiltonian}
        Given a Lagrangian $L$, the Hamiltonian function is defined by the following Legendre transformation (\cref{calculus:legendre}):
        \begin{gather}
            H(q,p,t) := \sum_ip_i\dot{q}^i - L(q,p,t)\,.
        \end{gather}
    }

    \newformula{Hamilton's equations}{\index{Hamilton!equations}\label{classic:hamilton_equations}
        Inserting the above definition in the action (\cref{classic:action}) and applying the variational principle results in the following equations:
        \begin{gather}
            \begin{cases}
                &\ds\dot{q}^k = \pderiv{H}{p_k}\,,\\
                &\ds\dot{p}_k = -\pderiv{H}{q^k}\,.
            \end{cases}
        \end{gather}
        Systems obeying these equations are called \textbf{Hamiltonian systems}. (See \cref{section:hamiltonian_dynamics} for the mathematical background).
    }

\subsection{Poisson bracket}

    \newdef{Poisson bracket}{\index{Poisson!bracket}
        To stick with the conventions of \cref{symplectic:poisson}, the Poisson bracket is defined as
        \begin{gather}
            \{A,B\} := \sum_k\pderiv{A}{p_k}\pderiv{B}{q^k} - \pderiv{A}{q^k}\pderiv{B}{p_k}\,,
        \end{gather}
        where $q,p$ are the canonical coordinates in the Hamiltonian formalism.
    }
    \sremark{As noted before, some authors define the Poisson bracket with the opposite sign. One should always pay attention to which convention is used.}

    \newformula{Total time derivative}{
        Hamilton's equations imply the following expression for the total time derivative:
        \begin{gather}
            \deriv{F}{t} = \pderiv{F}{t} + \{H,F\}\,,
        \end{gather}
        which is the evolution equation for a nonautonomous system (\cref{symplectic:nonautonomous_system}).
    }

\subsection{Hamilton--Jacobi equation}

    For a geometrical interpretation, see \cref{section:hamilton_jacobi}.

    \newdef{Canonical transformations}{\index{canonical!transformation}\label{classic:canonical_transformation}
        A transformation that leaves the Hamiltonian equations of motion unchanged. This means that the transformation leaves the action invariant up to a constant or, equivalently, it leaves the Lagrangian invariant up to a complete time-derivative:
        \begin{gather}
            \sum_ip_i\dot{q}^i - H(q,p,t) = \sum_iP_i\dot{Q}^i - K(Q,P,t) - \deriv{S}{t}(Q,P,t)\,.
        \end{gather}
        The function $S$ is called the \textbf{generating function} of the canonical transformation. The choice of generating function uniquely determines the transformation (the converse is, however, not true).
    }

    \newformula{Hamilton--Jacobi equation}{\index{Hamilton--Jacobi equation}\index{Hamilton!principal function}\index{Kamiltonian}
        Sufficient conditions for a function $S$ to be a generating function of canonical transformations are:
        \begin{gather}
            \begin{aligned}
                p_i &=\pderiv{S}{q^i}\,,\\
                Q^i &=\pderiv{S}{P_i}\,,
            \end{aligned}
        \end{gather}
        and
        \begin{gather}
            K = H + \pderiv{S}{t}\,.
        \end{gather}
        Choosing the new Hamiltonian function $K$, sometimes called the \textbf{Kamiltonian}, to be 0 gives the Hamilton--Jacobi equation:
        \begin{gather}
            \label{classic:hamilton_jacobi_equation}
            H\left(q,\pderiv{S}{q},t\right)+\pderiv{S}{t} = 0\,.
        \end{gather}
        In this case the function $S$ is called \textbf{Hamilton's principal function}.
    }

    \begin{property}
        The new coordinates $Q^i$ and $P_i$ are all constants of motion. This immediately follows from the choice $K=0$.
    \end{property}

    \newdef{Hamilton's characteristic function}{\index{Hamilton!characteristic function}\index{energy}
        For time-independent systems, the Hamilton--Jacobi equation can be rewritten as follows:
        \begin{gather}
            \label{classic:time_independent_hje}
            H\left(q,\pderiv{S}{q}\right) = -\pderiv{S}{t} =: E\,.
        \end{gather}
        After a redefinition of $H$, this is the same as \cref{symplectic:hamilton_jacobi}. One thus obtains the classical result that, for time-independent systems, the Hamiltonian function is a constant of motion (often called the \textbf{energy}\footnote{Note that, in general, this is not the physical energy.}). Integration with respect to time gives the following form of the principal function:
        \begin{gather}
            S(q,p,t) = W(q,p) - Et\,.
        \end{gather}
        The time-independent function $W$ is called Hamilton's characteristic function.
    }

    \begin{property}[St\"ackel condition]\index{St\"ackel potential}
        The Hamilton--Jacobi equation is separable if and only if the potential is of the form
        \begin{gather}
            \label{classic:stackel_condition}
            V(q) = \sum_{i=1}^n\ds\frac{W_i(q^i)}{G_i^2(q)}
        \end{gather}
        whenever the Hamiltonian function can be written as
        \begin{gather}
            H(q,p) = \frac{1}{2}\sum_i\frac{p_i^2}{G^2_i(q)} + V(q)\,.
        \end{gather}
        Potentials of this form are called \textbf{St\"ackel potentials}.
    \end{property}

\section{Analytical mechanics}\label{section:analytical_mechanics}
\subsection{Phase space}

    \newdef{Phase space}{\index{phase space}
        The set of all possible $2n$-tuples $(q^i,p_i)$ of generalized coordinates and associated momenta is called the phase space of the system. Note that this also includes the tuples that are not solutions of the equations of motion.
    }

    \newdef{Libration}{\index{libration}
        A closed trajectory for which the coordinates take on only a subset of the allowed values. It is the generalization of an oscillation. Topologically, it is characterized by a contractible, closed trajectory.
    }
    \newdef{Rotation}{\index{rotation}
        A closed trajectory for which at least one of the variables takes on all possible values. Topologicaly, it is characterized by a noncontractible, closed trajectory.

        \todo{CORRECT (for an ordinary rotation in spherical coordinates this indeed holds, however, for rotations in Cartesian coordinates this fails)}
    }

    \newdef{Separatrix}{\index{separatrix}
        When plotting different (closed) trajectories in the phase space of a system, the curve that separates regions of librations and rotations is called the separatrix.\footnote{In general, the separatrix of a dynamical system is a curve that separates regions with different behaviour.}
    }

    \newdef{Lagrangian derivative\footnotemark}{\index{Lagrange!derivative|see{material derivative}}\index{material!derivative}\index{advective}\label{classic:lagrangian_derivative}
        \footnotetext{Also known as the \textbf{material derivative}, especially in the context of fluid mechanics.}
        Let $A(q,\dot{q},t)$ be a phase space quantity. Its Lagrangian derivative along a path $\bigl(q(t),\dot{q}(t)\bigr)$ in phase space is given by
        \begin{gather}
            \begin{aligned}
                \Deriv{A}{t} &:= \lim_{\Delta t\rightarrow0}\frac{A(q+\Delta q,\dot{q}+\Delta\dot{q},t+\Delta t) - A(q,\dot{q},t)}{\Delta t}\\
                &= \pderiv{A}{t} + \dot{q}^i\pderiv{A}{q^i} + \deriv{\dot{q}^i}{t}\pderiv{A}{\dot{q}^i}\,.
            \end{aligned}
        \end{gather}
        The second term $\dot{\vector{q}}\cdot\nabla a$ in this equation is called the \textbf{advective term}.
    }
    \begin{remark}[Convection]\index{convective}
        When $A(q,\dot{q},t)$ is a tensor field, the gradient $\nabla$ has to be replaced by the covariant derivative. The advective term is then sometimes called the \textbf{convective} term.
    \end{remark}

    \begin{result}
        For $A(q,\dot{q},t)=\vector{q}(t)$, one obtains
        \begin{gather}
            \Deriv{\vector{q}}{t} = \dot{\vector{q}}\,.
        \end{gather}
    \end{result}

\subsection{Liouville's theorem}

    \begin{formula}[Liouville's lemma]
        Consider a phase space volume element $V_0$ moving along a path $x(t)\equiv\bigl(q(t),\dot{q}(t)\bigr)$. The Jacobian $J\bigl(x(t)\bigr)$ associated with this motion is given by
        \begin{gather}
            J\bigl(x(t)\bigr) = \deriv{V}{V_0} = \det\left(\pderiv{\vector{x}}{\vector{x}_0}\right) = \sum_{ijklmn}\varepsilon^{ijklmn}\pderiv{x^1}{x^i_0}\pderiv{x^2}{x^j_0}\pderiv{x^3}{x^k_0}\pderiv{x^4}{x^l_0}\pderiv{x^5}{x^m_0}\pderiv{x^6}{x^n_0}\,.
        \end{gather}
        The Lagrangian derivative of this Jacobian is
        \begin{gather}
            \label{classic:jacobian_derivative}
            \Deriv{J}{t} = (\nabla\cdot\vector{x})J\,.
        \end{gather}
        Furthermore, using Hamilton's equations (\cref{classic:hamilton_equations}), it is easy to prove that
        \begin{gather}
            \nabla\cdot\vector{x}=0
        \end{gather}
        and, hence, that the material derivative of $J$ vanishes.
    \end{formula}

    \begin{theorem}[Liouville]\index{Liouville!theorem on phase spaces}\label{classic:liouvilles_theorem}
        Let $V(t)$ be a moving phase space volume containing a fixed set of particles. Applying Liouville's lemma gives
        \begin{gather}
            \Deriv{V}{t} = \Deriv{}{t}\Int_{\Omega(t)}d^6x = \Deriv{}{t}\Int_{\Omega_0}J(\vector{x},t)\,d^6x_0 = 0\,.
        \end{gather}
        This implies that the phase space volume of a Hamiltonian system is invariant with respect to time evolution.
    \end{theorem}
    \begin{remark}[$\clubsuit$]
        By \cref{section:hamiltonian_dynamics}, every phase space admits a symplectic form $\omega$. By noting that the volume in phase space is calculated through the symplectic volume form $\vol_\omega\sim\omega^n$, this theorem easily follows from the fact that time evolution is the flow of the Hamiltonian vector field, which preserves the symplectic form.
    \end{remark}

    \newformula{Boltzmann's transport equation}{\index{Boltzmann!transport equation}\index{Vlasov equation}
        Let $F(q,\dot{q},t)$ be the mass distribution function:
        \begin{gather}
            M_{\text{tot}} = \Int_{\Omega(t)}F(q,\dot{q},t)\,d^6x\,.
        \end{gather}
        From the conservation of mass, one can derive the following formula:
        \begin{gather}
            \label{classic:boltzmann_transport_gather}
            \Deriv{F}{t} = \pderiv{F}{t} + \dot{q}^i\cdot\pderiv{F}{q^i} - \nabla V^i\pderiv{F}{\dot{q}^i} = \left[\pderiv{F}{t}\right]_{\text{col}}\,,
        \end{gather}
        where the right-hand side gives the change of $F$ due to collisions.\footnote{The collisionless form of this equation is sometimes called the \textbf{Vlasov equation}.} This partial differential equation in 7 variables can be solved to obtain $F$.
    }

    Consider a Hamiltonian system with a phase space $\mathcal{V}$. By Liouville's theorem, the phase flow generated by the equations of motion is a volume- or measure-preserving map $g:\mathcal{V}\rightarrow\mathcal{V}$ (\cref{measure:measure_preserving}). This gives rise to the following theorem.
    \begin{theorem}[Poincar\'e recurrence theorem]\index{Poincar\'e!recurrence theorem}
        For every point $x_0\in\mathcal{V}$ and for every neighbourhood $U\subseteq\mathcal{V}$ of $x_0$, there exists a point $y\in U$ such that $g^n(y)\in U$ for every $n\in\mathbb{N}$.
    \end{theorem}

    \begin{theorem}[Strong Jeans's theorem\footnotemark]\index{Jeans}\index{isolating integrals}\index{Lynden-Bell}
        \footnotetext{Actually due to \textit{Lynden-Bell}.}
        For a time-independent system, for which almost all orbits are regular, the distribution function can be expressed in terms of three integrals of motion.
    \end{theorem}
    The constants in Jeans's theorem are called the \textup{\textbf{isolating integrals}} of the system.

\subsection{Continuity equation}

    \newformula{Reynolds' transport theorem}{\index{Reynolds transport theorem}\index{Leibniz!integral rule}\label{classic:reynolds_transport_theorem}
        Consider a quantity
        \begin{gather}
            F = \Int_{V(t)}f(q,\dot{q},t)\,dV\,.
        \end{gather}
        Combining \cref{classic:jacobian_derivative} with the divergence theorem~\ref{vector:divergence_theorem} gives
        \begin{gather}
            \Deriv{F}{t} = \Int_V\pderiv{f}{t}\,dV + \Oint_{\partial V}f\dot{\vector{q}}\cdot d\vector{S}\,.
        \end{gather}
        This formula can be interpreted as a three-dimensional generalization of the Leibniz integral rule (\cref{calculus:leibniz_integral_rule}).
    }

    \newformula{Continuity equations}{\index{continuity!equation}
        For a conserved quantity, Reynold's transport theorem becomes:
        \begin{align}
            \label{classic:lagrangian_continuity_gather}
            \Deriv{f}{t} &+ (\nabla\cdot\dot{\vector{q}})f = 0\,,\\
            \label{classic:eulerian_continuity_gather}
            \pderiv{f}{t} &+ \nabla\cdot(f\dot{\vector{q}}) = 0\,.
        \end{align}
        If one sets $f=\rho$ (the mass density), the equations are called the \textbf{Lagrangian continuity equation} and \textbf{Eulerian continuity equation}, respectively.

        The difference between these two equations corresponds to the way the system is observed. In the Eulerian approach, one observes a fixed point in space and measures how a given quantity at that point evolves. In the Lagrangian approach, one observes a fixed element in the system and measures how a given quantity evolves around the chosen point as it moves throughout space.
    }
    \begin{result}
        Combining the Reynolds transport theorem with the Lagrangian continuity equation gives the following identity for an arbitrary function $f$:
        \begin{gather}
            \label{classic:result1}
            \Deriv{}{t}\Int_V\rho f\,dV = \Int_V\rho\Deriv{f}{t}\,dV\,.
        \end{gather}
    \end{result}

\subsection{Fluid mechanics}

    \todo{ADD (stress vector)}

    \begin{theorem}[Cauchy's stress theorem\footnotemark]\index{Cauchy!fundamental theorem}\index{stress}
        \footnotetext{Also known as \textbf{Cauchy's fundamental theorem}.}
        The stress vectors acting on the coordinate planes through a point determine the stress vector acting on an arbitrary plane passing through that point.
    \end{theorem}

    Cauchy's stress theorem is equivalent to the existence of the following tensor.
    \newdef{Cauchy stress tensor}{\index{Cauchy!stress tensor}
        The Cauchy stress tensor is a $(0,2)$-tensor $\mathbf{T}$ that gives the relation between a stress vector associated to a plane and the normal vector $\vector{n}$ to that plane:
        \begin{gather}
            \vector{t}_{(\vector{n})} = \mathbf{T}(\vector{n})\,.
        \end{gather}
    }
    \begin{example}
        For identical particles, the stress tensor is given by
        \begin{gather}
            \mathbf{T} = -\rho\langle\vector{w}\otimes\vector{w}\rangle\,,
        \end{gather}
        where $\vector{w}$ is the random component of the velocity vector and $\langle\cdot\rangle$ denotes the expectation value (\cref{prob:expectation_value}).
    \end{example}

    \begin{theorem}[Cauchy's lemma]\index{Cauchy!lemma}
        The stress vectors acting on opposite planes are equal in magnitude but opposite in direction:
        \begin{gather}
            \vector{t}_{(-\vector{n})} = -\vector{t}_{(\vector{n})}\,.
        \end{gather}
    \end{theorem}

    \newformula{Cauchy momentum equation}{\index{Cauchy!momentum equation}\index{shear stress}
        From Newton's second law (\cref{classic:force}), it follows that
        \begin{gather}
            \Deriv{\vector{P}}{t} = \Int_V\vector{f}(x,t)\,dV + \Oint_{\partial V}\vector{t}(x,t)\,dS\,,
        \end{gather}
        where $\vector{P}$ is the momentum density, $\vector{f}$ are the `body' forces and $\vector{t}$ are the `surface' forces (such as \textit{shear stress}). Using Cauchy's stress theorem and the divergence theorem~\ref{vector:divergence_theorem}, one obtains
        \begin{gather}
            \Deriv{\vector{P}}{t} = \Int_V\left[\vector{f}(x,t) + \nabla\cdot\mathbf{T}(x,t)\right]\,dV\,.
        \end{gather}
        The left-hand side can be rewritten using \cref{classic:result1} as
        \begin{gather}
            \int_V\rho\Deriv{\vector{v}}{t}\,dV = \Int_V\left[\vector{f}(x,t) + \nabla\cdot\mathbf{T}(x,t)\right]\,dV\,.
        \end{gather}
    }

\section{Dynamical systems}

    The following property, although seemingly innocuous, is very important for the study of mechanical systems.
    \begin{property}
        For dynamical systems governed by ODEs satisfying the Picard--Lindel\"of conditions (\cref{ode:picard_lindelof}), different trajectories never intersect.
    \end{property}

    The above property has an important (but nontrivial) consequence.
    \begin{theorem}[Poincar\'e--Bendixson]\index{Poincar\'e--Bendixson}
        In a two-dimensional phase space, the only trajectories inside of a closed bounded subregion without fixed points are either closed orbits or trajectories spiralling into closed orbits.
    \end{theorem}
    \begin{result}\index{strange attractor}
        In two-dimensional (Cartesian) phase spaces, there cannot exist chaos, i.e.~no \textit{strange attractors} can exist.
    \end{result}

    \newdef{Lypanuov exponents}{\index{Lyapunov exponent}
        Consider two trajectories of a system and denote the distance between them at a time $t_0$ by $s_0:=s(t_0)$. (The initial time can be taken to be 0 without loss of generality.) If, after some time $t$, these trajectories satisfy
        \begin{gather}
            s(t)\approx e^{\lambda t}s_0\,,
        \end{gather}
        the parameter $\lambda$ is called the Lyapunov exponent of the system.
    }

    \newdef{Limit cycle}{\index{cycle|seealso{limit}}\index{limit!cycle}
        Consider a closed trajectory $C$. If there exist curves that asymptotically $(t\longrightarrow\pm\infty$) converge to $C$, i.e.~their \textbf{limit set} is $C$, one calls $C$ a limit cycle.
    }

    \newdef{Poincar\'e map}{\index{Poincar\'e!map}
        Consider a dynamical system determined by a phase flow $\phi$ and let $S$ be a codimension-1 hypersurface in the phase space $Q$ that is transversal to $\phi$, i.e.~all trajectories intersect $S$ at isolated points. Intuitively, the Poincar\'e map $P:S\rightarrow S$ is defined as the `map of first return', i.e.~the image of every point $x\in S$, if it exists, is given by $\phi_T(x)$ with $T=:\min\{t\in\mathbb{R}^+\mid\phi_t(x)\in S\}$.

        One can give a more formal definition (one that also avoids the fact that $P$ would only be partially defined). The Poincar\'e map $P$ is defined as follows:
        \begin{itemize}
            \item $P:U\rightarrow S$ is a differentiable map, where $U\subseteq S$ is open and connected.
            \item $P|_{P(U)}$ is a diffeomorphism.
            \item For every point $u\in U$, the positive semi-orbit of $u$ intersects $S$ for the first time at $P(u)$.
        \end{itemize}
        The usefulness of this map lies in the fact that it preserves (quasi)periodicity whilst reducing the dimensionality of the space. It is especially useful for the study of 3-dimensional spaces, where the section $S$ is 2-dimensional and, hence, easily visualized.
    }
    \begin{property}[Fixed points]
        Fixed points of the Poincar\'e map correspond to closed orbits.
    \end{property}

\section{Geometric mechanics}
\subsection{Newton's equations}

    In this section, the current chapter is reformulated in a differential-geometric framework (in the spirit of \cref{section:hamiltonian_dynamics}). The first step is to reformulate ordinary Newtonian mechanics. The general setting here is a Riemannian manifold $(M,g)$, where the metric is mainly used for defining the kinetic energy
    \begin{gather}
        \label{classic:kinetic_energy}
        E_{\text{kin}} := \frac{1}{2}g(v,v)\,,
    \end{gather}
    together with a second-order ODE in the form of a vector field $X\in \mathfrak{X}(TM)$ such that $\pi_*(X_v)=v$, where $\pi:TM\rightarrow M$ denotes the tangent bundle projection.

    For integral curves $\gamma$ in $TM$ of second-order ODEs, it is easy to show that they are the tangent vector fields of their projections. In particular, if $q^i(t)$ are the local coordinates of a curve $\sigma:=\pi(\gamma)$ on $M$, it can be shown that the tangent coordinates $\dot{q}^i$ of $\gamma$ are exactly the derivatives of the coordinates $q^i$:
    \begin{gather}
        \dot{q}^i(t) = \deriv{q^i}{t}(t)\,.
    \end{gather}
    As such, the abuse of notation $\dot{q}^i$ is justified. Conversely, it can be shown that a vector field on $TM$ is second order if and only if this is true for any local chart, i.e.~if the vector field $X\in\mathfrak{X}(TM)$ can be expressed as follows:
    \begin{gather}
        X = \dot{q}^i\pderiv{}{q^i} + F^i(q,\dot{q})\pderiv{}{\dot{q}^i}\,.
    \end{gather}
    By writing this vector field as a system of differential equations, a second-order ODE is obtained (hence the terminology):
    \begin{gather}
        \mderiv{2}{q^i}{t} = F^i(q,\dot{q})\,.
    \end{gather}
    The primary example of such a second-order ODE is the vector field generating the geodesic flow on $TM$, i.e.~the integral curves are the tangent curves of geodesics on $M$. Therefore, it should not be surprising that the above equation is similar to \cref{diff:geodesic_equation}. By adopting the notation of \cref{riemann:autoparallel_equation}, one can generalize the geodesic equation to obtain Newton's equations of motion for an arbitrary smooth potential $U:M\rightarrow\mathbb{R}$.
    \begin{formula}[Newton's equation]\index{Newton!equation}
        Let $(M,g)$ be a Riemannian manifold and let $U:M\rightarrow\mathbb{R}$ be a smooth function. Newton's equations for a curve $\sigma:[a,b]\rightarrow M$ read
        \begin{gather}
            \nabla_{\dot{\sigma}}\dot{\sigma} = -\mathrm{grad}(U)\,,
        \end{gather}
        where $\nabla$ indicates the Levi-Civita connection and $\mathrm{grad}$ denotes the gradient operator (\cref{vector:gradient}), which is here not denoted by $\nabla$ to avoid confusion with the covariant derivative.
    \end{formula}

    \begin{property}[Cogeodesic flow]
        Consider the kinetic Hamiltonian~\eqref{classic:kinetic_energy} expressed on the cotangent bundle $T^*M$ of a Riemannian manifold:
        \begin{gather}
            H_{\text{kin}}(q,p) := \frac{1}{2}\sum_{i,j}g^{ij}(q)p_ip_j\,,
        \end{gather}
        where $g^{ij}$ is the inverse of the (local) matrix representative of the metric $g$. The integral curves of the associated Hamiltonian flow project down to geodesics on $M$.
    \end{property}

\subsection{Lagrangian mechanics}

    Now it is time to turn to Noether's theorem and, in particular, the version concerning cyclic coordinates (\cref{classic:noether_cyclic}). Any diffeomorphism of $M$ induces a diffeomorphism on $TM$ by pushforward.
    \newdef{Lagrangian symmetry}{\index{symmetry!Lagrangian}
        A symmetry of a Lagrangian $L:TM\rightarrow\mathbb{R}$ is a diffeomorphism $\phi$ of $M$ such that $\phi^*L=L$. Infinitesimal symmetries, i.e.~the generators of symmetries, are vector fields for which the associated flow is a symmetry.
    }

    Given a complete vector field $X$, one can define the conjugate momentum $\widehat{X}:TM\rightarrow\mathbb{R}$ as follows:
    \begin{gather}
        \label{classic:metric_conjugate_momentum}
        \widehat{X}(v) := g(X_{\pi(v)},v)\,.
    \end{gather}
    Using this definition, Noether's theorem~\ref{classic:noether_cyclic} can be reformulated as follows.
    \begin{theorem}[Noether's theorem]\index{Noether!theorem}
        The conjugate momentum of an infinitesimal symmetry is a constant of motion.
    \end{theorem}

    If the conjugate momenta of the coordinate-induced vector fields $\partial_i$ are denoted by $p_i$, the nondegeneracy of $g$ implies that the set $\{q^i,p_i\}_{i\leq n}$ gives well-defined coordinate functions on $T^*M$. The equivalence of the Lagrangian action principle and the Newtonian equations of motion imply that the second-order ODE associated to the potential $U$ takes the following form:
    \begin{gather}
        X_U := \dot{q}^i\pderiv{}{q^i} + \pderiv{L}{q^i}\pderiv{}{p_i}\,.
    \end{gather}
    After performing the Legendre transformation $E:=p_i\dot{q}^i-L$ to obtain the (Hamiltonian) energy function, Newton's equations can be rewritten in Hamiltonian form:
    \begin{gather}
        X_E = \pderiv{E}{p_i}\pderiv{}{q^i}-\pderiv{E}{q^i}\pderiv{}{p_i}\,.
    \end{gather}
    The function $E$ will not be called a Hamiltonian function because this will be reserved for functions on the cotangent bundle.

\subsection{Hamiltonian mechanics}

    The procedure of mapping a (complete) vector field to its conjugate momentum can be generalized to an isomorphism $TM\rightarrow T^*M$ as follows.
    \newdef{Fibre derivative}{\index{fibre!derivative}
        Let $L:TM\rightarrow\mathbb{R}$ be a smooth Lagrangian. The fibre derivative of $L$ is defined as the directional (G\^ateaux) derivative (\cref{functional:gateaux}) of $L$:
        \begin{gather}
            \langle\mathbb{F}L(v),w\rangle := \left.\deriv{}{t}L(v+tw)\right|_{t=0}\,.
        \end{gather}
        Because $\mathbb{F}L(v)\in\mathcal{L}(TM,\mathbb{R})=T^*M$ by definition of the derivative, one can see that $\mathbb{F}L$ defines a map $TM\rightarrow T^*M$. In local coordinates $(q^i,\dot{q}^i)$, the fiber derivative is given by
        \begin{gather}
            \mathbb{F}L:(q^i,\dot{q}^i)\mapsto\left(q^i,\pderiv{L}{\dot{q}^i}\right)\equiv(q^i,p_i)\,.
        \end{gather}
        As such, the classical definition~\ref{classic:conjugate_momentum} for conjugate momenta is obtained. In the case of kinetic Lagrangians defined by a metric $g$, it is not hard to see that this boils down to \cref{classic:metric_conjugate_momentum}.
    }
    \begin{remark}[Legendre transform]\index{Legendre!transformation}
        The fibre derivative $\mathbb{F}L$ is often called the Legendre transform of $L$. Although this does not exactly coincide with \cref{calculus:legendre} or \cref{info:legendre}, the relation is simple enough. The Legendre transformation $L\mapsto L^*$ (on the tangent bundle) is implemented as
        \begin{gather}
            L^*(x) = \langle\mathbb{F}L(x),x\rangle - L(x)\,.
        \end{gather}
    \end{remark}

    Lagrangians for which the Legendre transformation is invertible, i.e.~for which $\mathbb{F}L$ is a diffeomorphism, give rise to equivalent mechanics encoded in the cotangent bundle. Given such a Lagrangian, we can construct the associated energy function $E$ by a Legendre transformation and map it to a Hamiltonian $H$ on the cotangent bundle as $H:=E\circ\mathbb{F}L^{-1}$. By abuse of notation, write $L\equiv L\circ\mathbb{F}L^{-1}$. This transformation also induces a Hamiltonian vector field $X_H:=\mathbb{F}L_*X_E$ on $T^*M$ that can alternatively be encoded as $X_E=\mathbb{F}L^*X_H$. If the cotangent coordinates $p_i(\alpha) := \alpha(\partial_i)$ are chosen, it can easily be seen that $p_i\circ\mathbb{F}L\equiv p_i$. This way the Hamiltonian equations remain virtually unchanged when transporting them to the cotangent bundle.

    For any choice of coordinates for which the symplectic form on $T^*M$ takes the standard Darboux form $\omega=dp_i\wedge dq^i$, the Newtonian equations of motion take on a Hamiltonian form. If there exists a coordinate chart in which the Hamiltonian function $H$ does not depend on any of the base coordinates $q^i$, the coordinates are called \textbf{action-angle variables} and the system is said to be \textbf{completely integrable} (cf.~\cref{section:integrability}).\index{action-angle coordinates}\index{integrability!complete}

\subsection{Contact structure}

    By extending the cotangent bundle of the configuration space with a time variable, one can also (re)obtain some interesting features. Consider the following one-form on the trivial line bundle $T^*M\times\mathbb{R}$:
    \begin{gather}
        \alpha := p_i\dr q^i - H\dr t\,.
    \end{gather}
    First of all, this endows the extended cotangent bundle with a contact structure (\cref{contact:contact_structure}). Moreover, it can be shown to be a relative integral invariant (\cref{bundle:integral_invariant}) of the following Pfaffian system:
    \begin{gather}
        \frac{\dr q^i}{\smallpderiv{H}{p_i}} = \dr t = \frac{-\dr p_i}{\smallpderiv{H}{q^i}}\,.
    \end{gather}
    The vector fields that leave the contact form invariant are exactly those generated by the Hamiltonian vector field $X_H$. Liouville's theorem~\ref{classic:liouvilles_theorem} is then simply a consequence of the absolute invariance of $\dr\alpha$.

    A canonical transformation (\cref{classic:canonical_transformation}) was originally defined as a transformation that leaves the Hamiltonian equations of motion invariant. In the contact setting, it can be defined as follows.
    \newdef{Canonical transformation}{\index{canonical!transformation}\index{symplectization}
        A transformation of the trivial line bundle $T^*M\times\mathbb{R}$ that leaves both the fibres and the \textbf{symplectization}\footnote{This form turns $T^*M\times\mathbb{R}^2$ into a symplectic manifold.}
        \begin{gather}
            \Omega := \dr(e^\lambda\alpha)
        \end{gather}
        invariant.

        \todo{CHECK THIS STATEMENT (cannot find source)}
    }
\chapter{Tensor Networks}

\section{Matrix Product States}
\subsection{Finite-dimensional lattices}

	\newdef{Matrix product state}{\index{MPS}
		Let $\mathcal{H}_n$ be the local Hilbert spaces of dimension $d_n$ where $n\in\{1,...,N\}$. A state $|\psi\rangle$ in the total Hilbert space $\bigotimes_i\mathcal{H}_i$ is a matrix product state (with periodic boundary conditions) if there exist matrices $A^{i_n}(n)\in\mathcal{L}(\mathbb{C}^{D_n}, \mathbb{C}^{D_{n-1}})$ with $i_n\leq d_n$ such that:
		\begin{equation}
			|\psi\rangle = \sum_{\{i_k\}}\text{tr}\Big(\prod_n^NA^{i_n}(n)\Big)|i_1...i_N\rangle
		\end{equation}
		For each lattice site $n$ the set of matrices $\{A^{i_n}_{\alpha\beta}(n)\}$ can be regarded as the content of one rank-3 tensor. The periodic boundary condition requires that $D_0=D_N$ (otherwise the trace would be ill-defined). Different boundary conditions can be implemented by adding an additional factor $X$ at the end of the trace.
	}
	\begin{notation}
		In the continuation of this chapter we will abbreviate matrix product states as \textbf{MPS}.
	\end{notation}
	
	\begin{remark}[Physical and virtual spaces]
		For each \textit{physical} index $i_n$ one can regard the matrix $A^{i_n}(n)$ as a linear map between \textit{virtual} (or ancilla) spaces $\mathbb{C}^{D_n}$.
	\end{remark}
	
	\newformula{MPS projector}{
		Consider an MPS given by tensors $\{A(n)\}_{n\leq N}$. The associated MPS projector is defined as:
		\begin{equation}
			\mathcal{P}(A) = \sum_{i, \alpha, \beta}A^i_{\alpha\beta}(n)|i\rangle\langle\alpha\beta|
		\end{equation}
	}
	
	\newformula{Transfer operator}{\index{transfer!operator}
		Give the MPS tensors $\{A(n)\}_{n\leq N}$ one can define a transfer operator:
		\begin{equation}
			\label{mps:transfer_operator}
			\mathbb{E}(n) = \sum_{i=1}^{d_n}A^i(n)\otimes\overline{A^i}(n)
		\end{equation}
	}
	\begin{formula}[Superoperator]\index{super!operator}
		More generally we can define for every local observable $\hat{O}_n$ a superoperator in $\mathcal{L}(\mathbb{C}^{D_n}\otimes\overline{\mathbb{C}^{D_n}}, \mathbb{C}^{D_{n-1}}\otimes\overline{\mathbb{C}^{D_{n-1}}})$:
		\begin{equation}
			\mathbb{E}_{O_n}(n) = \sum_{i,i'=1}^{d_n}\langle i|\hat{O}_n|i' \rangle A^{i'}(n)\otimes\overline{A^i}(n)
		\end{equation}
		Comparing with the definition of the transfer operator we see that $\mathbb{E}$ is given by the superoperator associated to the unit operator. Given two sets of MPS tensors $\{A(n)\}, \{B(n)\}$ we define a generalized superoperator by:
		\begin{equation}
			\mathbb{E}^A_B(n) = \sum_{i=1}^{d_n}A^i(n)\otimes\overline{B^i}(n)
		\end{equation}
	\end{formula}
	\begin{example}
		Using these definitions we can rewrite the formulas for expectation values more efficiently. Given a product operator $\hat{O}=\bigotimes_i^N\hat{O}_i$ we find that:
		\begin{equation}
			\langle\psi[A]|\hat{O}|\psi[A]\rangle = \text{tr}\Big(\mathbb{E}_{O_1}(1)\cdots\mathbb{E}_{O_N}(N)\Big)
		\end{equation}
	\end{example}
	
	\begin{formula}
		Associated to the superoperator $\mathbb{E}_O(n)$ one can define a map acting on the virtual operators:
		\begin{align}
			\mathcal{E}^{(n)}_{O_n}(\phi) &= \sum_{i, i'=1}^{d_n}\langle s|\hat{O}_n|s' \rangle A^{i'}(n)\phi A^i(n)^\dag\\
			\tilde{\mathcal{E}}^{(n)}_{O_n}(\phi) &= \sum_{i, i'=1}^{d_n}\langle s|\hat{O}_n|s' \rangle A^i(n)^\dag\sigma A^{i'}(n)
		\end{align}
		where $\phi\in\mathcal{L}(\mathbb{C}^{D_n}), \sigma\in\mathcal{L}(\mathbb{C}^{D_{n-1}})$.
	\end{formula}
	\begin{property}
		The map $\mathcal{E}_{\mathbbm{1}}^{(n)}$ associated to the transfer operator is a CP map\footnote{See definition \ref{operator:cp_map}.} and the associated Kraus operators are the MPS matrices $A^i(n)$.
	\end{property}
	
\subsection{Translation-invariant states}

	\newdef{Uniform MPS}{
		By setting all MPS tensors $A(n) = B$ for a given tensor $B$ one obtains a translation-invariant (TI) state, i.e. a state invariant under a shift of the index $n$. These MPS form the variational class of uniform MPS.
	}
	\begin{remark}[TIMPS]
		Not every TIMPS is uniform, there should only exist a local gauge transformation $A'(n) = U(n-1)A(n)U(n)^{-1}$ such that $A'(n)$ is uniform (in certain cases this is only possible by enlarging the bond dimension).
	\end{remark}

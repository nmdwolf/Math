\chapter{\difficult{Classical Field Theory}}\label{chapter:classical_fields}

    Rigorous definitions and statements about the mathematical concepts used in this chapter can be found in Chapters \ref{chapter:bundles}, \ref{chapter:vector_bundles}, \ref{chapter:riemann} and \ref{chapter:variation}.

\section{Lagrangian field theory}\index{action}

    The physical space will be assumed to be a (pseudo-)Riemannian, $n$-dimensional manifold $(M,g)$ with the fields being sections of a fibre bundle $E\rightarrow M$ (often the tangent bundle $TM$). In general, a Lagrangian (function) or \textbf{action} is a function $L:\Gamma(E)\rightarrow\mathbb{R}$ from the space of (compactly supported) sections of a vector bundle to the real numbers. This is often given by local functionals for a local Lagrangian \ref{var:local_lagrangian}:
    \begin{gather}
        L:\Gamma_c(E)\rightarrow\mathbb{R}:\phi\mapsto\int_M(j^\infty\phi)^*\mathcal{L}\vol.
    \end{gather}
    In the remainder of this chapter the functional $L$ and the density $\mathcal{L}$ will both be denoted by $L$ for notational simplicity.

    Associated to this manifold one can construct a cochain complex similar to the de Rham complex $\Omega^\bullet(M)$. This structure takes two geometric features into account. On the one hand one has the ordinary de Rham differential $d$ on the base manifold $M$, while on the other hand one has a differential $\delta$ along the jet fibres, induced by the variation of fields. The total differential will be the sum of these as is standard in the context of bicomplexes. This defines the variational bicomplex.

    Some key concepts from the calculus of variations are recalled here. The variational derivative or Euler-Lagrange derivative \eqref{var:euler_lagrange_derivative} is defined as follows (partial derivatives are denoted by subscripted commas, e.g. $\partial_\mu\partial_\nu\phi\equiv\phi_{,\mu\nu}$):
    \begin{gather}
        \frac{\delta L}{\delta \phi} := \pderiv{L}{\phi} - \partial_\mu\left(\pderiv{L}{\phi_{,\mu}}\right) + \partial_\mu\partial_\nu\left(\pderiv{L}{\phi_{,\mu\nu}}\right) -\cdots.
    \end{gather}
    By comparing this formula to the formula for the variation of the Lagrangian density, one obtains the first variational formula \eqref{var:first_variational_formula}:
    \begin{gather}
        \delta L = \frac{\delta L}{\delta \phi^I}\delta\phi^I - d\Theta[\phi].
    \end{gather}
    The first term vanishes on-shell because it is proportional to the Euler-Lagrange equation associated to the field $\phi^I$. The last term contains the boundary terms obtained after performing integration by parts. The $(n-1,1)$-form $\Theta$ is called the \textbf{presymplectic potential}.

    The \textbf{presymplectic current} $\omega$ is obtained by taking the variation of the presymplectic potential:\index{potential!presymplectic}\index{current!presymplectic}
    \begin{gather}
        \omega[\phi] = \delta\Theta[\phi].
    \end{gather}
    On-shell this form is closed, i.e. $\mathbf{d}\omega\approx0$ (off-shell this does not necessarily hold and, hence, the form is not symplectic). It can be shown that if the variations $\delta\phi^I$ satisfy the linearised equations of motion, then for every gauge transformation $\xi$ there exists a $(n-2,1)$-form $k_\xi[\phi]$ such that $\omega\approx dk[\phi]$. (More details can be found in \cite{compere}.)

\subsection{Noether's theorem for fields}\index{Noether!theorem}

    In the context of field theory the Lagrangian density is often denoted by $\mathcal{L}$ instead of $L$. This convention will be adopted here as well.

    \begin{theorem}[Noether's first theorem]\index{Noether!charge}\label{field:noethers_theorem}
        Consider a general field transformation
        \begin{gather}
            \phi\longrightarrow\phi+\alpha\delta\phi,
        \end{gather}
        where $\alpha$ is an infinitesimal quantity and $\delta\phi$ is a small variation. In case of a symmetry one obtains a conservation law of the following form:
        \begin{gather}
            \label{field:conserved_current}
            \partial_\mu\left(\pderiv{\mathcal{L}}{\phi_{,\mu}}\delta\phi - \mathcal{J}^\mu\right) = 0.
        \end{gather}
        The factor between parentheses can be interpreted as a conserved current $j^\mu(x)$.\\
        \begin{proof}
            \begin{mdframed}[roundcorner=10pt, linecolor=blue, linewidth=1pt]
                The general transformation rule for the Lagrangian is
                \begin{gather}
                    \label{noether_deriv:1}
                    \mathcal{L}\longrightarrow\mathcal{L} + \alpha\delta\mathcal{L}.
                \end{gather}
                To have a symmetry, i.e. to keep the action invariant, the deformation factor has to be a 4-divergence:
                \begin{gather}
                    \label{noether_deriv:2}
                    \mathcal{L}\longrightarrow\mathcal{L} + \alpha\partial_\mu\mathcal{J}^\mu.
                \end{gather}

                To obtain the conservation law \eqref{field:conserved_current}, the Lagrangian is varied explicitly:
                \begin{align*}
                    \delta\mathcal{L} &= \pderiv{\mathcal{L}}{\phi}\delta\phi + \pderiv{\mathcal{L}}{(\partial_\mu\phi)}\delta(\partial_\mu\phi)\\
                    &= \pderiv{\mathcal{L}}{\phi}\delta\phi + \partial_\mu\left(\pderiv{\mathcal{L}}{(\partial_\mu\phi)}\delta\phi\right) - \partial_\mu\left(\pderiv{\mathcal{L}}{(\partial_\mu\phi)}\right)\delta\phi\\
                    &= \partial_\mu\left(\pderiv{\mathcal{L}}{(\partial_\mu\phi)}\delta\phi\right) + \left[\pderiv{\mathcal{L}}{\phi} - \pderiv{\mathcal{L}}{(\partial_\mu\phi)}\right]\delta\phi.
                \end{align*}
                The second term vanishes due to the Euler-Lagrange equation \eqref{lagrange_deriv:second_kind_with_hamilton}. Combining these formulas gives
                \begin{gather}
                    \partial_\mu\left(\pderiv{\mathcal{L}}{(\partial_\mu\phi)}\delta\phi\right) - \partial_\mu\mathcal{J}^\mu(x) = 0.
                \end{gather}
                From this equation one can conclude that the current
                \begin{gather}
                    j^\mu(x) = \pderiv{\mathcal{L}}{(\partial_\mu\phi)}\delta\phi - \mathcal{J}^\mu(x)
                \end{gather}
                is conserved.\qed
            \end{mdframed}
        \end{proof}
    \end{theorem}
    The above conservation law can also be expressed in terms of a charge (such a current and its associated charge are generally called the \textbf{Noether current} and \textbf{Noether charge}):
    \begin{gather}
        \label{field:noether_charge}
        Q[\Sigma] := \int_\Sigma j^0d^3x,
    \end{gather}
    where $\Sigma$ is a spacelike hypersurface. The conservation law can then simply be restated as \[\deriv{Q}{t} = 0.\]

    \begin{definition}[Stress-energy tensor]\index{stress-energy tensor}
        Consider the translation of a scalar field: \[\phi(x)\longrightarrow\phi(x+a) = \phi(x) + a^\mu\partial_\mu\phi(x).\] Because the Lagrangian is a scalar quantity, it transforms in the same way as the fields:
        \begin{gather}
            \mathcal{L}\longrightarrow\mathcal{L} + a^\mu\partial_\mu\mathcal{L} = \mathcal{L} + a^\nu\partial_\mu(\mathcal{L}\delta^\mu_{\ \nu}).
        \end{gather}
        On a $D$-dimensional manifold this leads to the existence of $D$ conserved currents. These can be used to define the stress-energy tensor:
        \begin{gather}
            \label{field:stress_energy_tensor}
            T^\mu_{\ \nu} = \pderiv{\mathcal{L}}{\phi_{,\mu}}\partial_\nu\phi - \mathcal{L}\delta^\mu_{\ \nu}.
        \end{gather}
    \end{definition}

\subsection{Gauge algebra}

    In this section the gauge symmetries of a local action $S$, i.e. an action \[S[\phi] := \int L(\phi^I,\partial_\mu\phi^I,\ldots,x^\mu) dx\] where $L:J^\infty(E)\rightarrow\mathbb{R}$ is the Lagrangian, is considered. A \textbf{gauge transformation} of this action is a coordinate transformation that depends arbitrarily on $M$ but leaves the action invariant. The most general form of such a transformation is
    \begin{gather}
        \label{constraint:gauge_transformation}
        \delta_\varepsilon\phi^I = \overline{R}^I_{(0),\alpha}\varepsilon^\alpha + \overline{R}^{I,\mu}_{(1),\alpha}\partial_\mu\varepsilon^\alpha + \cdots + \overline{R}^{I,\mu_1\ldots\mu_s}_{(s),\alpha}\partial_{\mu_1\ldots\mu_s}\varepsilon^\alpha\equiv \overline{R}^I_\alpha\varepsilon^\alpha,
    \end{gather}
    where the coefficients $\overline{R}_{(i)}$ are arbitrary functions of the coordinates and in the last step a new shorthand was introduced where the summation over $j$ also includes an integral over $x$ (the \textbf{DeWitt convention}):\index{DeWitt convention}
    \begin{align}
        R^I_\alpha\varepsilon^\alpha &:= \int R^I_\alpha(x,x')\varepsilon^\alpha(x')dx'\\
        &= \int\sum_j\Big(\overline{R}^i_{(0),j}(x)\delta(x-x')+\overline{R}^i_{(1),j}(x)\delta'(x-x')+\overline{R}^i_{(2),j}(x)\delta^{(2)}(x-x')+\cdots\Big)\varepsilon^j(x')dx'.\nonumber
    \end{align}
    Invariance of the action implies that
    \begin{gather}
        \delta_\varepsilon S = \frac{\delta S}{\delta\phi^I}\delta_\varepsilon\phi^I = \frac{\delta S}{\delta\phi^I}R^I_\alpha\varepsilon^\alpha = 0.
    \end{gather}
    Beause this should hold for every value of the transformation parameters $\varepsilon^\alpha$, one immediately obtains the variational Noether identities:
    \begin{property}[Noether identities]\label{field:noether_identity}
        If a local action is invariant under the transformation \eqref{constraint:gauge_transformation}, then
        \begin{gather}
            \frac{\delta S}{\delta\phi^I}R^I_\alpha = 0
        \end{gather}
        for all ``indices'' $\alpha$. In contrast to Noether's theorem \ref{lagrange:noether_cyclic}, these identities do not imply conserved quantities. Instead they show that the equations of motion are not independent.
    \end{property}
    The structure of the infinitesimal gauge transformations is easily seen to be that of a (real) Lie algebra, whilst that of finite (exponentiated) transformations is a Lie group. However, the gauge algebra $\overline{\mathcal{G}}$ is very large (in fact it is infinite-dimensional) and contains a lot of physically irrelevant information. The simplest example is that of the \textbf{zilch symmetries} as referred to by \textit{Freedman} and \textit{Van Proeyen} \cite{supergravity}:
    \newdef{Trivial gauge symmetry}{\index{zilch symmetry}
        All transformations of the form
        \begin{gather}
            \delta_\varepsilon\phi^I = \varepsilon^{IJ}\frac{\delta S}{\delta\phi^J},
        \end{gather}
        where $\varepsilon^{IJ}$ is antisymmetric, are physically irrelevant since they are not generated by constraints. The trivial gauge transformations form an ideal $\mathcal{N}$ of the gauge algebra and the physically relevant algebra is the quotient $\mathcal{G} := \overline{\mathcal{G}}/\mathcal{N}$. However, for some reasons it might be convenient to retain the full gauge algebra.

        In fact one can show that any gauge transformation, satisfying suitable conditions, that vanishes on-shell is equal to some trivial transformation. ?? EXPLAIN (see HENNEAUX and TEITELBOIM) ??
    }
    A further problem with the gauge algebra is that independent transformations might lead to dependent Noether identities wich implies that there is still some redundancy. To fix this one defines the following minimal set:
    \newdef{Generating set}{\index{open!algebra}
        A generating set\footnote{Sometimes called a \textbf{complete set} of gauge symmetries.} of the gauge algebra is a set of transformations $\delta_\varepsilon\phi^I = R^I_\alpha\varepsilon^\alpha$ such that every gauge transformation can be written as follows:
        \begin{gather}
            \delta\phi^I = R^I_\alpha\mu^\alpha + M^{IJ}\frac{\delta S}{\delta\phi^J},
        \end{gather}
        where $M^{IJ}=-M^{JI}$. Because the coefficients might be functions of the fields and their derivatives, the generating set is in general not a basis for the gauge algebra. However, due to the Lie algebra structure, there must exist structure functions $C^\gamma_{\alpha\beta}$ and $M^{IJ}_{\alpha\beta}$ such that
        \begin{gather}
            \label{field:lie_algebroid}
            R^J_\alpha\frac{\delta R^I_\beta}{\delta\phi^J} - R^I_\beta\frac{\delta R^J_\alpha}{\delta\phi^I} = C^\gamma_{\alpha\beta}R^I_\gamma + M^{IJ}_{\alpha\beta}\frac{\delta S}{\delta\phi^J},
        \end{gather}
        where $M^{IJ}_{\alpha\beta}=-M^{JI}_{\alpha\beta}$. If all $M$ are zero, the algebra is said to be \textbf{closed} (even though the generating set itself might not be closed as a Lie algebra because the $C$'s generally are functions of the fields) and otherwise it is said to be \textbf{open}. A generating set is said to be \textbf{irreducible} if there exist no nontrivial combinations of elements:
        \begin{gather}
            R^I_\alpha\varepsilon^\alpha = M^{IJ}\frac{\delta S}{\delta\phi^J}\implies\varepsilon^\alpha = N^{\alpha I}\frac{\delta S}{\delta\phi^I}.
        \end{gather}
    }
    The following remark is the Lagrangian counterpart of Remark \ref{constraint:remark_chevalley_eilenberg} in the Hamiltonian treatment of constrained systems:
    \begin{remark}[Lie algebroids]
        If one restricts to closed gauge algebras, i.e. ignores zilch symmetries, Equation \ref{field:lie_algebroid} is exactly the closure condition for a Lie algebroid \ref{hdg:lie_algebroid}. Higher relations between the generators, i.e. a reducible theory, turns the gauge algebra into a Lie $n$-algebroid or even a $L_\infty$-algebroid.
    \end{remark}

\section{Covariant phase space}

    First, the formalism for mechanical systems will be introduced, i.e. no fields will be considered. Then, the formalism originally developed by \textit{Peierls} will be introduced in the absence of local gauge symmetries.

\subsection{Zero Hamiltonian}

    In Chapter \ref{chapter:constrained_dynamics} dynamical systems with constraints were considered. Using the tools from that chapter one can turn any system evolving under a physical, but nondynamical or external, time parameter $t$ into a system having time as a canonical coordinate. In this setting the time variable is treated on the same footing as the other coordinates. Such a system is called a \textbf{generally covariant system}.\index{covariant!system}

    If one starts from the action
    \begin{gather}
        S[q,p] = \int\left(p_i\dot{q}^i-H_0\right)dt,
    \end{gather}
    one can introduce time as a generalized coordinate with momentum $p_0$ by modifying the action as follows:
    \begin{gather}
        S[q,p,t,p_0,u] = \int\left[p_0t'+p_iq'^i-u(p_0+H_0)\right]d\tau,
    \end{gather}
    where the quotes indicate derivatives with respect to the parameter $\tau$. It is easily checked that the resulting equations of motion are the same as for the original action.

    The system now involves a single constraint $H_0=p_0$, which is first-class. It is often called the \textbf{Hamiltonian constraint}.\index{Hamilton!constraint} Aside from this constraint, the extended action contains no first-class Hamiltonian. Evolution is solely determined by a constraint and, therefore, is given by a gauge transformation.

    \begin{remark}[Nonholonomic constraints]
        In Chapter \ref{chapter:constrained_dynamics} all constraints were assumed to be holonomic, i.e. they did not explicitly depend on time. The presence of time derivatives is not compatible with the Poisson/Dirac bracket. However, when passing to a generally covariant system as above, the time variable loses its peculiar character and all constraints can be handled in the same way.
    \end{remark}

    \begin{property}[Vanishing Hamiltonian]
        If the canonical coordinates $(q,p)$ transform as scalars under $\tau$-reparametrizations, the Hamiltonian is weakly zero.
    \end{property}

\subsection{Field theory}

    Since the classical notion of phase space as the set of $(q,p)$-points in coordinate-momentum space, at a given time $t$, is clearly not covariant (the choice of a time slice ruins any form of relativistic invariance) one has to embrace a new approach:
    \newdef{Covariant phase space}{\index{phase space}
        Let $S[\phi]$ be a local action functional. The covariant phase space $\mathcal{P}$ associated to $S$ is the set of solutions of the equations of motion
        \begin{gather}
            \frac{\delta S}{\delta\phi}=0.
        \end{gather}
        The physical observables are defined as the smooth functions on this new phase space $\mathcal{P}$. These can be described more generally. Let $M$ be the set of all field histories/configurations (the covariant phase space is a submanifold of this space). The ring of physical observables $C^\infty(\mathcal{P})$ is obtained as the quotient of $C^\infty(M)$ by the ideal of functions vanishing on-shell (similar to Definition \ref{constraint:functions}).
    }

    ?? COMPLETE ??

\section{Batalin-Vilkovisky formalism}

    When considering constrained systems (Section \ref{section:classical_brst}) and their quantization (Section \ref{section:quantum_constrained}), one enlarged the phase space by the both ghosts and antighosts. The former corresponded to differential forms along the gauge orbits and antighosts corresponded to Koszul-Tate generators characterizing the zero locus of the field equations. Now, what about a field theory, where the solutions of the field equations are not functions in $C^\infty(M)$ but sections of a vector bundle $E\rightarrow M$. As seen in the first section of this chapter, field theories admit symmetries generated by the field equations themselves, the zilch symmetries. One can then play the same game as in Chapter \ref{chapter:constrained_dynamics} with the ordinary phase space replaced by the covariant phase space $\mathcal{I}$ and the symmetry group replaced by the zilch symmetries (and other gauge symmetries).

    \newdef{Antifield}{\index{anti-!field}
        In the BRST formalism one extends the set of fields $\phi^I$ by a pair of ghosts and antighosts $(\eta^a,\mathcal{P}_a)$ for every gauge symmetry $\hat{G}_a$. In the antifield formalism one also introduces a set of antifields $\mathcal{P}_I$. These carry the following cohomological grading:
        \begin{align}
            \varepsilon(\mathcal{P}_I) &= \varepsilon_I + 1\\
            \mathrm{antigh}(\mathcal{P}_I) &= \mathrm{antigh}(\phi^I) + 1 = 1.
        \end{align}
        They are the Koszul generators related to zilch symmetries:
        \begin{gather}
            \delta\mathcal{P}_I = -\frac{\delta S}{\delta\phi^I}.
        \end{gather}
        The (anti)ghost fields then arise as the Koszul-Tate generators induced by the Noether identities \ref{field:noether_identity} (which introduce some reducibility in the symmetries). $\delta(R^I_a\mathcal{P}_I)=0$ by the above relation, so all Noether identities induce elements of $H^1(\delta)$. According to the Koszul-Tate construction one needs to introduce generators $\mathcal{P}_a$ and so on.

        If one extends the above grading properties to the antighost fields, one obtains
        \begin{gather}
            \mathrm{antigh}(\mathcal{P}_a) = 2,
        \end{gather}
        so the antifields are shifted in degree by 1 when compared to the classical setting. Also the Grassmann parity is shifted compared to the classical case:
        \begin{gather}
            \varepsilon(\mathcal{P}_I) = \varepsilon_I + 1\qquad\qquad\varepsilon(\mathcal{P}_a) = \varepsilon_a+1\qquad\qquad\ldots
        \end{gather}
    }

    \newdef{Antifield bracket}{\label{field:antibracket}
        The antifield bracket (\textbf{antibracket}) of two functionals on $C^\infty(\mathcal{I})\otimes\mathbb{C}[\eta^a]\otimes\mathbb{C}[\mathcal{P}_I]\otimes\mathbb{C}[\mathcal{P}_a]$ is defined as follows:
        \begin{gather}
            \{f,g\} := \left(\frac{\partial^Rf}{\partial\phi^I}\frac{\partial^Lg}{\partial\mathcal{P}_I}-\frac{\partial^Rf}{\partial\mathcal{P}_I}\frac{\partial^Lg}{\partial\phi^I}\right) + \left(\frac{\partial^Rf}{\partial\eta^a}\frac{\partial^Lg}{\partial\mathcal{P}_a}-\frac{\partial^Rf}{\partial\mathcal{P}_a}\frac{\partial^Lg}{\partial\eta^a}\right),
        \end{gather}
        where the index $a$ denotes (anti)ghost fields of arbitrary degree.
    }
    \begin{property}
        The BV-antibracket has the following algebraic properties:
        \begin{itemize}
            \item It is BRST-odd: $\mathrm{gh}(\{f,g\}) = \mathrm{gh}(f)+\mathrm{gh}(g)+1$.
            \item It induces the structure of a Gerstenhaber algebra \ref{hda:gerstenhaber_algebra}, where the degree is the Grassmann parity.
        \end{itemize}
        As before, of one considers the extended state space with ``coordinates'' the fields and ``momenta'' the antifields, the antibracket gives the structure of an odd symplectic manifold and, in particular, that of a ``BV manifold'' as defined below:
        \begin{gather}
            \{f,g\} = \frac{\partial^Rf}{\partial z^\mu}\omega^{\mu\nu}\frac{\partial^Lg}{z^\nu},
        \end{gather}
        where $(z^\mu)\equiv(\phi^I,\eta^a,\mathcal{P}_I,\mathcal{P}_a)$ and
        \begin{gather}
            (\omega^{\mu\nu}) :=
            \begin{pmatrix}
                0&\delta^I_J+\delta^a_b\\
                -\delta^I_J+\delta^a_b&0
            \end{pmatrix}.
        \end{gather}
    \end{property}

    \newdef{BV manifold}{\index{Batalin-Vilkovisky!manifold}\index{ghost!number}\label{field:bv_manifold}
        A Batalin-Vilkovisky manifold is a triple $(M,\omega,S)$ where $M$ is a graded manifold, $\omega$ is a degree-1 symplectic form and $S$ is a degree-0 function such that the classical master equation \eqref{hdg:classical_master_equation} is satisfied:
        \begin{gather}
            \{S,S\}=0,
        \end{gather}
        where $\{\cdot,\cdot\}$ is the Poisson bracket induced by $\omega$ (Definition \ref{hdg:poisson_manifold}).

        The most straightforward example of a BV manifold is the BV-BRST complex associated to a field theory. For this reason the Poisson bracket is often called the \textbf{antibracket}, while the grading is often called the \textbf{ghost number} and denoted by $\mathrm{gh}$. The function $S$ is for field theories given by the action (functional).
    }

    \newdef{BV Laplacian}{
        Consider a BV manifold $(M,\omega,S)$. A BV Laplacian is an operator $\Delta$ on the space of half-densities $|\Omega|^{1/2}(M)$ that satisfies the following conditions:
        \begin{enumerate}
            \item\textbf{Nilpotency}: $\Delta^2=0$, and
            \item\textbf{Product rule}: $\Delta(fg)= (\Delta f)g + (-1)^{\varepsilon(f)}f(\Delta g) + (-1)^{\varepsilon(f)}\{f,g\}$.
        \end{enumerate}
        This implies that the BV Laplacian acts as a graded derivation:
        \begin{gather}
            \Delta\{f,g\} = \{\Delta f,g\} + (-1)^{\varepsilon(f)+1}\{f,\Delta g\}.
        \end{gather}
        The canonical BV Laplacian in field-antifield coordinates is given by
        \begin{gather}
            \Delta_\text{BV} := \sum_I(-1)^{\varepsilon_I+1}\frac{\partial^R}{\partial\phi^I}\frac{\partial^R}{\partial\mathcal{P}_I} + \sum_a(-1)^{\varepsilon_a+1}\frac{\partial^R}{\partial\eta^a}\frac{\partial^R}{\partial\mathcal{P}_a}.
        \end{gather}
        This operator satisfies
        \begin{gather}
            \Delta_\text{BV}f = -\frac{1}{2}\mathrm{div}X_f,
        \end{gather}
        for all $f\in C^\infty(M)$, where $\mathrm{div}$ denotes the divergence \ref{riemann:divergence} with respect to the standard Berezinian volume form.
    }

    \newdef{BV integral}{\index{Batalin-Vilkovisky!integral}\index{gauge}
        Consider an odd symplectic $(M,\omega)$ of superdimension $m|m$. Let $\psi$, the \textbf{gauge fixing fermion}, be an odd function of the even coordinates of a Darboux basis (denote these by $q$). This function determines a projectable Lagrangian submanifold $L_\psi\subset\Pi T^*\mathbb{R}^m$ by the Maslow-H\"ormander theorem \ref{symplectic:maslow_hormander}. The Batalin-Vilkovisky integral of a function $f\in C^\infty(M)$ with respect to $\psi$ is defined as
        \begin{gather}
            \int_{L_\psi}f := \int f|_{p_i=\partial_{q^i}\psi},
        \end{gather}
        The BV integral and BV Laplacian interact in the following way (for BV integrable $f$):
        \begin{enumerate}
            \item If $f=\Delta_\text{BV}g$, then $\int_{L_\psi}f = 0$ for all gauge fixing fermions $\psi$.
            \item If $\Delta_\text{BV}f=0$, $\deriv{}{t}\int_{L_{\psi_t}}f=0$, where $\{\psi_t\}_{t\in\mathbb{R}}$ is a continuous family of gauge fixing fermions.
        \end{enumerate}
        The second property implies that the BV integral is invariant under deformations of the domain of integration.
    }
    \begin{formula}[Quantum master equation]\index{master equation}
        Consider the function $f:=e^{iS/\hbar}$ on a BV manifold $(M,\omega,S)$. Because
        \begin{gather}
            \Delta f = \frac{i}{\hbar}\Delta S e^{iS/\hbar} + \left(\frac{i}{\hbar}\right)^2\frac{1}{2}\{S,S\}e^{iS/\hbar},
        \end{gather}
        the condition that $f$ is BV-harmonic is equivalent to $S$ satisfying
        \begin{gather}
            \frac{1}{2}\{S,S\}-i\hbar\Delta S=0.
        \end{gather}
        This equation is called the quantum master equation. Expanding $S$ as a power series in $\hbar$ shows that the order-0 term satisfies the classical master equation \eqref{hdg:classical_master_equation}.
    \end{formula}

    \begin{example}[AKSZ model]
        The Alexandrov-Kontsevich-Schwarz-Zabronsky model considers the mapping space between a dg-manifold $(M,Q)$ and a dg-symplectic manifold $(N,\omega,X_H)$, where $X_H$ is Hamiltonian.

        For any graded manifold $\Sigma$, one can construct the source manifold by taking $M:=\Pi T\Sigma$ and $Q:=d$. A symplectic form on $C^\infty(M,N)$ is then given by
        \begin{gather}
            \Omega := \int_{\Pi T\Sigma}\omega_{\mu\nu}\delta\Phi^\mu\delta\Phi^\nu\mathrm{Vol}.
        \end{gather}
        The BV action is defined as follows:
        \begin{gather}
            S := \int_{\Pi T\Sigma}\left(\alpha_\mu d\Phi^\mu+\Theta\right)\mathrm{Vol},
        \end{gather}
        where $\alpha$ is a symplectic potential for $\omega$, which necessarily exists globally by Property \ref{hdg:global_exactness} if $\mathrm{gh}(\omega)\neq0$.

        In general, the symplectic form on $C^\infty(M,N)$ is induced from that on $N$ by a pull-push operation. First one pulls back this form along the evaluation map $\mathrm{ev}:C^\infty(M,N)\times M\rightarrow N$ and then one pushes it forward along the projection on the first factor (cf. fibre integration \ref{bundle:fibre_integration}).
    \end{example}
\chapter{Analytical mechanics}

\section{Phase space}

	\newdef{Phase space}{\index{phase space}
		The set of all possible $n$-tuples\footnote{Not only those as given by the equations of motion.} $(q^i, p_i)$ of generalized coordinates and associated momenta is called the phase space of the system. Given a system living on a smooth manifold $Q$, its phase space is modelled by the cotangent bundle $T^*Q$.
	}
    
	\newdef{Rotation}{\index{rotation}
		A rotation is the change of a coordinate for which every possible value is allowed.
	}
	\newdef{Libration}{\index{libration}
		A libration is the change of a coordinate for which only a subset of the total range is allowed. It is the generalization of an oscillation.
	}

\section{Material derivative}

	\newdef{Lagrangian derivative\footnotemark}{\index{Lagrange!derivative}\index{material!derivative}
		\footnotetext{Also known as the \textbf{material derivative}, especially when applied to fluid mechanics.}
	    	Let $a(\vector{r}, \vector{v}, t)$ be a property defined at every point of the system. The Lagrangian derivative along a path $(\vector{r}(t), \vector{v}(t))$ in phase space is given by:
	    	\begin{align}
	    		\label{phasespace:lagrangian_derivative}
		    	\ds\Deriv{a}{t} &= \lim_{\Delta t\rightarrow0}\ds\frac{a(\vector{r} + \Delta\vector{r}, \vector{v} + \Delta\vector{v}, t+\Delta t) - a(\vector{r}, \vector{v}, t)}{\Delta t}\nonumber\\
		        &= \pderiv{a}{t} + \deriv{\vector{r}}{t}\cdot\pderiv{a}{\vector{r}} + \deriv{\vector{v}}{t}\cdot\pderiv{a}{\vector{v}}\nonumber\\
		        &= \pderiv{a}{t} + \vector{v}\cdot\nabla a + \deriv{\vector{v}}{t}\cdot\pderiv{a}{\vector{v}}
	    	\end{align}
	    	The second term $\vector{v}\cdot\nabla a$ in this equation is called the \textbf{advective} term.
    	}
    \begin{remark}
    	In the case that $a(\vector{r}, \vector{v}, t)$ is a tensor field the gradient $\nabla$ has to be replaced by the covariant derivative. The advective term is then called the \textbf{convective} term.
    \end{remark}
    
    \begin{result}
    	If we take $a(\vector{r}, \vector{v}, t) = \vector{r}$ we obtain:
    	\begin{gather}
            \Deriv{\vector{r}}{t} = \vector{v}.
    	\end{gather}
    \end{result}

\section{Liouville's theorem}

	\begin{formula}[Liouville's lemma]
	    	Consider a phase space volume element $dV_0$ moving along a path $(\vector{r}(t), \vector{v}(t)) \equiv (\vector{x}(t))$. The Jacobian $J(\vector{x}, t)$ associated with this motion is given by:
		\begin{gather}
			J(\vector{x}, t) = \deriv{V}{V_0} = \det\left(\pderiv{\vector{x}}{\vector{x}_0}\right) = \sum_{ijklmn}\varepsilon^{ijklmn}\pderiv{x^1}{x^i_0}\pderiv{x^2}{x^j_0}\pderiv{x^3}{x^k_0}\pderiv{x^4}{x^l_0}\pderiv{x^5}{x^m_0}\pderiv{x^6}{x^n_0}.
		\end{gather}
		The Lagrangian derivative of this Jacobian then becomes:
		\begin{gather}
			\label{fluidum:jacobian_derivative}
			\Deriv{J}{t} = (\nabla\cdot\vector{x})J.
		\end{gather}
		Furthermore using the Hamiltonian equations \ref{lagrange:hamilton_equations} it is easy to prove that
		\begin{gather}
			\nabla\cdot\vector{x} = 0
	        \end{gather}
	        and as such the material derivative of $J$ vanishes.
	\end{formula}

	\begin{theorem}[Liouville's theorem]\index{Liouville!theorem on phase spaces}
	    	Let $V(t)$ be a phase space volume containing a fixed set of particles. Applying Liouville's lemma gives:
	    	\begin{gather}
	        	\label{fluidum:liouvilles_theorem}
	    		\Deriv{V}{t} = \Deriv{}{t}\int_{\Omega(t)}d^6x = \Deriv{}{t}\int_{\Omega_0}J(\vector{x}, t)d^6x_0 = 0.
	    	\end{gather}
	    	It follows that the phase space volume of a Hamiltonian system\footnote{A system that satisfies Hamilton's equations of motion.} is invariant with respect to time-evolution.
	\end{theorem}
    
	\newformula{Boltzmann's transport equation}{\index{Boltzmann!transport equation}\index{Vlasov}
    		Let $F(\vector{r}, \vector{v}, t)$ be the mass distribution function:
    		\begin{gather}
    			M_{tot} = \int_{\Omega(t)}F(\vector{x}, t)d^6x.
    		\end{gather}
    		From the conservation of mass we can derive the following formula:
	    	\begin{gather}
    			\label{fluidum:boltzmann_transport_gather}
		        \Deriv{F}{t} = \pderiv{F}{t} + \deriv{\vector{r}}{t}\cdot\pderiv{F}{\vector{r}} - \nabla V\cdot\pderiv{F}{\vector{v}} = \left[\pderiv{F}{t}\right]_{col}
	    	\end{gather}
	        where the right hand side gives the change of $F$ due to collisions.\footnote{The collisionless form of this equation is sometimes called the \textbf{Vlasov equation}.} This partial differential equation in 7 variables can be solved to obtain $F(\vector{x}, t)$.
	}

	Consider a Hamiltonian system with a finite phase space $\mathcal{V}$. By Liouville's theorem, the phase flow generated by the equations of motion is a measure (volume) preserving map $g:\mathcal{V}\rightarrow\mathcal{V}$. This leads us to the following theorem:
	\begin{theorem}[Poincar\'e recurrence theorem]\index{Poincar\'e!recurrence theorem}
	    	Let $\mathcal{V}_0$ be the phase space volume of the system. For every point $x_0\in\mathcal{V}_0$ and for every neighbourhood $U$ of $x_0$ there exists a point $y\in U$ such that $g^ny\in U$ for every $n\in\mathbb{N}$.
	\end{theorem}
    
	\begin{theorem}[Strong Jeans theorem\footnotemark]\index{Jeans}\index{isolating integrals}
    		\footnotetext{Actually due to Donald Lynden-Bell.}
    		The distribution function $F(\vector{r}, \vector{v})$ of a time-independent system for which almost all orbits are regular can be expressed in terms of 3 integrals of motion. These are called the \textup{\textbf{isolating integrals}}.
    	\end{theorem}
    
\section{Continuity equation}
	
    \newformula{Reynolds transport theorem\footnotemark}{\index{Reynolds!transport theorem}\index{Leibniz!integral rule}
    	\footnotetext{This is a 3D extension of the \textit{Leibniz integral rule}.}
    	Consider a quantity \[F = \int_{V(t)}f(\vector{r}, \vector{v}, t)dV.\] Using equation \ref{fluidum:jacobian_derivative} and the divergence theorem \ref{vectorcalculus:divergence_theorem} we obtain
        \begin{gather}
        	\label{fluidum:reynolds_transport_theorem}
    		\boxed{\Deriv{F}{t} = \int_V\pderiv{f}{t}dV + \oint_Sf\vector{v}\cdot d\vector{S}}
    	\end{gather}
    }
    \newformula{Continuity equations}{\index{continuity!equation}
    	For a conserved quantity the equation above becomes:
        	\begin{gather}
            	\label{fluidum:lagrangian_continuity_gather}
        		\Deriv{f}{t} + (\nabla\cdot\vector{v})f = 0
        	\end{gather}
            \begin{gather}
            	\label{fluidum:eulerian_continuity_gather}
            	\pderiv{f}{t} + \nabla\cdot(f\vector{v}) = 0
            \end{gather}
            If we set $f = \rho$ (mass density) then the first equation is called the \textbf{Lagrangian continuity equation} and the second equation is called the \textbf{Eulerian continuity equation}. Both equations can be found by pulling the Lagrangian derivative inside the integral on the left-hand side of \ref{fluidum:reynolds_transport_theorem}.
    }
    \begin{result}
    	Combining the Reynolds transport theorem with the Lagrangian continuity equation gives the following identity for an arbitrary function $f$:
    	\begin{gather}
        	\label{fluidum:result1}
    		\Deriv{}{t}\int_V\rho fdV = \int_V\rho\Deriv{f}{t}dV.
    	\end{gather}
    \end{result}

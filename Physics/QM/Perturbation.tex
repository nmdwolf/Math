\chapter{Perturbation Theory}\index{perturbation}

\section{Interaction picture}\index{interaction!picture}\label{section:interaction_picture}

    Let $\hat{H}(t)=\hat{H}_0+\hat{V}(t)$ be the total Hamiltonian of a system, where $\hat{V}(t)$ denotes the interaction potential. Let $|\psi(t)\rangle$ and $\hat{O}$ denote a state and operator in the Schr\"odinger picture.
    \begin{definition}[Interaction representation]
        In the interaction picture the state vector is defined as follows:
        \begin{gather}
            |\psi(t)\rangle_I := e^{\frac{i}{\hbar}\hat{H}_0t}|\psi(t)\rangle.
        \end{gather}
        From this it follows that the operators in the interaction picture are given by
        \begin{gather}
            \hat{O}_I(t) = e^{\tfrac{i}{\hbar}\hat{H}_0t}\,\hat{O}\,e^{-\tfrac{i}{\hbar}\hat{H}_0t}.
        \end{gather}
    \end{definition}
    \newformula{Schr\"odinger equation}{
        Using the previous formulas, the Schr\"odinger equation can be rewritten as follows:
        \begin{gather}
            i\hbar\deriv{}{t}|\psi(t)\rangle_I = \hat{V}_I(t)|\psi(t)\rangle_I.
        \end{gather}
        The time-evolution of operators in the interaction picture is given by
        \begin{gather}
            \deriv{}{t}\hat{O}_I(t) = \frac{i}{\hbar}\left[\hat{H}_0, \hat{O}_I(t)\right].
        \end{gather}
        States evolve solely based on the interaction terms and operators evolve according to the free (time-independent) Hamiltonian.
    }

    \begin{theorem}[Adiabatic theorem]\index{adiabatic!theorem}
        If a perturbation is acting slowly enough on a system such that the system can adapt its configuration at every single moment, the system will remain in the same eigenstate.
    \end{theorem}
    \sremark{The original formulation by \textit{Born} and \textit{Fock} also required the system to be \textit{gapped}. However, later this was shown to be inessential.}

    \newdef{M\o ller operator}{\index{M\o ller operator}
        The operators relating the (free) asymptotic states to the interacting state:
        \begin{gather}
            |\psi(0)\rangle = \Omega_\pm|\text{in/out}\rangle.
        \end{gather}
        If for $t\longrightarrow\pm\infty$ the interaction term vanishes, there should exist a wavefunction $|\phi(t)\rangle$ evolving under the free Hamiltonian such that
        \begin{gather}
            \|\psi(t)-\phi(t)\|\overset{t\rightarrow\pm\infty}{\longrightarrow}0.
        \end{gather}
        With $|\text{in/out}\rangle:=\lim_{t\rightarrow\pm\infty}\phi(t)$ this gives:
        \begin{gather}
            \Omega_\pm = \lim_{t\rightarrow\mp\infty}\exp\left(\tfrac{i}{\hbar}\hat{H}(t)t\right)\exp\left(-\tfrac{i}{\hbar}\hat{H}_0t\right)
        \end{gather}
        with respect to the strong topology.
    }
    \begin{remark}
        The limit in the definition of the M\o ller operators will only result in a well-defined operator for infinite-dimensional spaces.
    \end{remark}

\section{Rayleigh-Schr\"odinger theory}\index{Rayleigh-Schr\"odinger theory}

    The basic assumptions of Rayleigh-Schr\"odinger perturbation theory are that the perturbing Hamiltonian is time-independent and that the eigenfunctions of the unperturbed Hamiltonian $\hat{H}_0$ also form a complete set for the perturbed Hamiltonian.

    \begin{formula}
        The perturbed eigenfunctions and eigenvalues can be expanded in the following way, where $\lambda$ is assumed to be a small (perturbation) parameter:
        \begin{align}
            |\psi_n\rangle &= \sum_{i = 0}^\infty\lambda^i |\psi_n^{(i)}\rangle\\
            E_n &= \sum_{i = 0}^\infty\lambda^iE_n^{(i)}\,,
        \end{align}
        where $i$ is called the \textbf{order} of the perturbation.
    \end{formula}

\section{Time-dependent perturbation theory}
\subsection{Dyson series}

    \newformula{Tomonaga-Schwinger equation}{\index{Tomonaga-Schwinger equation}
        The evolution operator $\hat{U}(t)$ satisfies the following Schr\"odinger-type equation in the interaction picture (Section \ref{section:interaction_picture}):
        \begin{gather}
            \label{perturbation:tomonaga_schwinger_equation}
            i\hbar\deriv{}{t}\hat{U}_I|\psi(0)\rangle_I = \hat{V}_I(t)\hat{U}_I|\psi(0)\rangle_I.
        \end{gather}
    }

    \newformula{Dyson series}{\index{Dyson series}\label{perturbation:dyson_series}
        Together with the initial value condition $\hat{U}_I(0) = \mathbbm{1}$, the Tomonaga-Schwinger equation becomes an initial value problem. A particular solution is given by
        \begin{gather}
            \hat{U}_I(t) = \mathbbm{1} - \frac{i}{\hbar}\int_0^t\hat{V}_I(t')\hat{U}_I(t')\,dt'.
        \end{gather}
        This solution can be iterated to obtain a series expansion of the evolution operator:
        \begin{gather}
            \hat{U}(t) = 1 - \frac{i}{\hbar}\int_0^t\hat{V}(t_1)\,dt_1 + \left(-\frac{i}{\hbar}\right)^2\int_0^t\int_0^{t_1}\hat{V}(t_1)\hat{V}(t_2)\,dt_2\,dt_1 + \cdots
        \end{gather}
        It is clear that the integrands obey a time-ordering. By introducing the \textbf{time-ordering operator}
        \begin{gather}
            \label{perturbation:time_ordering_operator}
            \mathcal{T}\left(\hat{V}(t_1)\hat{V}(t_2)\right) =
            \begin{cases}
                \hat{V}(t_1)\hat{V}(t_2)&t_1 \geq t_2\\
                \hat{V}(t_2)\hat{V}(t_1)&t_2 > t_1
            \end{cases}
        \end{gather}
        the integrals can be rewritten in a more symmetric form:
        \begin{gather}
            \hat{U}(t) = 1 - \frac{i}{\hbar}\int_0^t\hat{V}(t_1)\,dt_1 + \frac{1}{2!}\left(-\frac{i}{\hbar}\right)\int_0^t\int_0^{\textcolor{red}{t}}\mathcal{T}\left(\hat{V}(t_1)\hat{V}(t_2)\right)\,dt_2\,dt_1 + \cdots.
        \end{gather}
        By comparing this expression to the series expansion for exponential functions, the following concise formula is obtained:
        \begin{gather}
            \hat{U}(t) = \mathcal{T}\left(e^{-\frac{i}{\hbar}\int_0^t\hat{V}(t')\,dt'}\right).
        \end{gather}
        This formula is called the \textbf{Dyson series}.
    }

\section{Variational method}\index{variational!method}

    \newdef{Energy functional}{\index{energy}
        \begin{gather}
            \label{perturbation:energy_functional}
            E[\psi] := \frac{\langle\psi|\hat{H}|\psi\rangle}{\langle\psi|\psi\rangle}
        \end{gather}
    }

    \begin{property}[Bounded below]
        The energy functional satisfies the following inequality:
        \begin{gather}
            E[\psi]\geq E_0\,,
        \end{gather}
        where $E_0$ is the ground state energy.
    \end{property}

    \begin{method}
        Assume that the ansatz $|\psi\rangle$ depends on a set of parameters $\{\lambda_i\}_{i\in I}$. The ``optimal'' wave function, i.e.~the one extremizing the energy functional, is found by solving the following system of equations:
        \begin{gather}
            \pderiv{\psi}{\lambda_i} = 0\qquad\forall i\in I.
        \end{gather}
    \end{method}

\section{Adiabatic approximation}\index{adiabatic!approximation}
\subsection{Berry phase}\index{Berry!phase}

    Consider a system for which the adiabatic approximation is valid. The wave function is then of the form
    \begin{gather}
        \psi(t) = C_a(t)\psi_a(t)\exp\left(-\frac{i}{\hbar}\int_{t_0}^tE_a(t')\,dt'\right).
    \end{gather}
    It follows from the orthonormality of the eigenstates $\psi_k(t)$ that the coefficient $C_a(t)$ is just a phase factor, so it can be rewritten as
    \begin{gather}
        C_a(t) = e^{i\gamma_a(t)}.
    \end{gather}
    By substituting this ansatz in the wave function, the Sch\"odinger equation gives a differential equation for the phase factor $\gamma_a(t)$. Integration gives
    \begin{gather}
        \label{perturbation:phase_factor}
        \gamma_a(t) = i\int_{t_0}^t\left\langle\psi_a(t')\left|\pderiv{\psi_a(t')}{t'}\right\rangle\right.\,dt'.
    \end{gather}
    Due to time evolution, the wave function accumulates a phase over the period $t_0-t_f$ through the coefficient $C_a(t)$. This phase is called the \textbf{Berry phase}.

    Now, apply a phase transformation to remove the Berry phase:
    \begin{gather}
        \label{perturbation:phase_transform}
        \psi'_a(t) := \psi_a(t)e^{i\eta(t)}.
    \end{gather}
    Inserting this in Equation \eqref{perturbation:phase_factor} gives
    \begin{gather}
        \bar\gamma'_a(t) = \bar\gamma_a(t) - \eta(t_f) + \eta(t_0)\,,
    \end{gather}
    where the bar denotes the integration between $t_0$ and $t_f$ in Equation \eqref{perturbation:phase_factor}. If the system is cyclic, then $\psi_a(t_0) = \psi_a(t_f)$. Combining this with Equation \eqref{perturbation:phase_transform} gives
    \begin{gather}
        \eta(t_f) - \eta(t_0) = 2k\pi
    \end{gather}
    for some $k\in\mathbb{N}$. This implies that the Berry phase cannot be eliminated through a basis transformation and, hence, this phase is physically observable.

    \newdef{Berry connection}{\index{Berry!connection}
        The quantity
        \begin{gather}
            \mathbf{A}(\vector{x}) := i\langle\psi_a(\vector{x})|\nabla_{\vector{x}}\psi_a(\vector{x})\rangle,
        \end{gather}
        where $\nabla_{\vector{x}}$ denotes the gradient in phase space, is called the Berry connection (or \textbf{Berry gauge potential}). Applying Stokes's theorem to \eqref{perturbation:phase_factor} gives
        \begin{gather}
            \bar\gamma_a = \int\boldsymbol{\mathcal{B}}\cdot d\vector{S}\,,
        \end{gather}
        where $\boldsymbol{\mathcal{B}} = \nabla_{\vector{x}}\times\mathbf{A}(\vector{x})$ is called the \textbf{Berry curvature}. Although the Berry connection is gauge-dependent, the Berry curvature is gauge-invariant
    }
    \begin{remark}[$\clubsuit$]
        Using the language of differential geometry (Chapter \ref{chapter:principal_bundles}) one immediately finds that the accumulated phase $\bar\gamma_a$ is simply the holonomy associated with the Berry connection along the considered trajectory.
    \end{remark}
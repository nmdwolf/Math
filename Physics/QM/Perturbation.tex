\chapter{Perturbation Theory}

\section{Rayleigh-Schr\"odinger theory}\index{Rayleigh-Schr\"odinger theory}

    The basic of assumptions of Rayleigh-Schr\"odinger perturbation theory are that the perturbing Hamiltonian is time-independent and that the eigenfunctions of the unperturbed Hamiltonian $\hat{H}_0$ also form a complete set for the perturbed Hamiltonian.

    \begin{formula}
        The perturbed eigenfunctions and eigenvalues can be expanded in the following way, where we assume that $\lambda$ is a small (perturbation) parameter:
        \begin{align}
            |\psi_n\rangle &= \sum_{i = 0}^{+\infty} \lambda^i |\psi_n^{(i)}\rangle\\
            E_n &= \sum_{i = 0}^{+\infty} \lambda^i E_n^{(i)}
        \end{align}
        where $i$ is called the \textbf{order} of the perturbation.
    \end{formula}

\section{Time-dependent perturbation theory}

    In this section we consider perturbed Hamiltonians of the following form:
    \begin{gather}
        \hat{H}(t) = \hat{H}_0 + \lambda \hat{V}(t).
    \end{gather}

\subsection{Dyson series}

    \newformula{Tomonaga-Schwinger equation}{\index{Tomonaga-Schwinger equation}
        The evolution operator $\hat{U}(t)$ satisfies the following Schr\"odinger-type equation in the interaction picture\footnote{See section \ref{qm:interaction_picture}.}:
        \begin{gather}
            \label{QM:perturbation:tomonaga_schwinger_equation}
            i\hbar\deriv{}{t}\hat{U}_I|\psi(0)\rangle_I = \hat{V}_I(t)\hat{U}_I|\psi(0)\rangle_I.
        \end{gather}
    }

    \newformula{Dyson series}{\index{Dyson series}
        Together with the initial value condition $\hat{U}_I(0) = \mathbbm{1}$ the Tomonaga-Schwinger equation becomes an initial value problem. A particular solution is given by
        \begin{gather}
            \hat{U}_I(t) = \mathbbm{1} - \stylefrac{i}{\hbar}\int_0^t\hat{V}_I(t')\hat{U}_I(t')dt'.
        \end{gather}
        This solution can be iterated to obtain a series expansion of the evolution operator:
        \begin{gather}
            \hat{U}(t) = 1 - \stylefrac{i}{\hbar}\int_0^t\hat{V}(t_1)dt_1 + \left(-\stylefrac{i}{\hbar}\right)^2\int_0^tdt_1\int_0^{t_1}dt_2\hat{V}(t_1)\hat{V}(t_2) + ...
        \end{gather}
        It is clear that the integrands obey a time-ordering. By introducing the \textbf{time-ordering operator} $\mathcal{T}$
        \begin{gather}
            \label{QM:time_ordering_operator}
            \mathcal{T}\left(\hat{V}(t_1)\hat{V}(t_2)\right) =
            \begin{cases}
                \hat{V}(t_1)\hat{V}(t_2)&t_1 \geq t_2\\
                \hat{V}(t_2)\hat{V}(t_1)&t_2 > t_1
            \end{cases}
        \end{gather}
        the integrals can be rewritten in a more symmetric form:
        \begin{gather}\index{Dyson!series}
            \hat{U}(t) = 1 - \stylefrac{i}{\hbar}\int_0^t\hat{V}(t_1)dt_1 + \frac{1}{2!}\left(-\stylefrac{i}{\hbar}\right)\int_0^tdt_1\int_0^{\textcolor{red}{t}}dt_2\mathcal{T}\left(\hat{V}(t_1)\hat{V}(t_2)\right) + \ldots.
        \end{gather}
        By comparing this expression with the series expansion for exponential functions, we obtain the following concise formula:
        \begin{gather}
            \label{QM:dyson_series}
            \hat{U}(t) = \mathcal{T}\left(e^{-\frac{i}{\hbar}\int_0^t\hat{V}(t')dt'}\right).
        \end{gather}
        This formula is called the \textbf{Dyson series}.
    }

\section{Variational method}\index{variational method}

    \newdef{Energy functional}{\index{energy}
        \begin{gather}
            \label{QM:perturbation:energy_functional}
            E[\psi] = \stylefrac{\langle\psi|\hat{H}|\psi\rangle}{\langle\psi|\psi\rangle}
        \end{gather}
    }

    \begin{property}
        The energy functional \ref{QM:perturbation:energy_functional} satisfies the following inequality:
        \begin{gather}
            E[\psi] \geq E_0
        \end{gather}
        where $E_0$ is the ground state energy.
    \end{property}

    \begin{method}
        Assume that the trial function $|\psi\rangle$ depends on a set of parameters $\{c_i\}_{i\in I}$. The ''optimal'' wave function (the one extremizing the energy functional) is found by solving the following system of equations:
        \begin{gather}
            \pderiv{\psi}{c_i} = 0.
        \end{gather}
    \end{method}

\section{Adiabatic approximation}
\subsection{Berry phase}\index{Berry!phase}

    Consider a system for which the adiabatic approximation is valid. We then have a wave function of the form
    \begin{gather}
        \psi(t) := C_a(t)\psi_a(t)\exp\left(-\frac{i}{\hbar}\int_{t_0}^tE_a(t')dt'\right).
    \end{gather}
    It follows from the orthonormality of the eigenstates $\psi_k(t)$ that the coefficient $C_a(t)$ is just a phase factor, so we can write it as
    \begin{gather}
        C_a(t) = e^{i\gamma_a(t)}.
    \end{gather}
    By substituting this ansatz in the wave function, the Sch\"odinger equation gives a differential equation for the phase factor $\gamma_a(t)$. Integrating it gives
    \begin{gather}
        \label{QM:perturbation:berry:phase_factor}
        \gamma_a(t) = i\int_{t_0}^t\left\langle\psi_a(t')\left|\pderiv{\psi_a(t')}{t'}\right\rangle\right. dt'.
    \end{gather}
    Due to time evolution the wave function accumulates a phase over the period $t_0-t_f$ through the coefficient $C_a(t)$. This phase is called the \textbf{Berry phase}.

    Let us try to apply a phase transformation to remove the Berry phase:
    \begin{gather}
        \label{QM:perturbation:berry:phase_transform}
        \psi'_a(t) := \psi_a(t)e^{i\eta(t)}.
    \end{gather}
    Inserting this in equation \ref{QM:perturbation:berry:phase_factor} gives
    \begin{gather}
        \bar\gamma'_a(t) = \bar\gamma_a(t) - \eta(t_f) + \eta(t_0)
    \end{gather}
    where the bar denotes the integration between $t_0$ and $t_f$ in equation \ref{QM:perturbation:berry:phase_factor}. If the system is cyclic then $\psi_a(t_0) = \psi_a(t_f)$. Combining this with equation \ref{QM:perturbation:berry:phase_transform} gives us
    \begin{gather}
        \eta(t_f) - \eta(t_0) = 2k\pi
    \end{gather}
    for some $k\in\mathbb{N}$. This implies that the Berry phase cannot be eliminated through a basis transformation and this phase is thus physically observable.

    \newdef{Berry connection}{\index{Berry!connection}
        The quantity
        \begin{gather}
            \mathbf{A}(\vector{x}) := i\langle\psi_a(\vector{x})|\nabla_{\vector{x}}\psi_a(\vector{x})\rangle
        \end{gather}
        where $\nabla_{\vector{x}}$ denotes the gradient in phase space, is called the Berry connection (or Berry gauge potential). Applying Stokes' theorem to \ref{QM:perturbation:berry:phase_factor} gives us
        \begin{gather}
            \bar\gamma_a = \int\boldsymbol{\mathcal{B}}\cdot d\vector{S}
        \end{gather}
        where $\boldsymbol{\mathcal{B}} = \nabla_{\vector{x}}\times\mathbf{A}(\vector{x})$ is called the \textbf{Berry curvature}. Although the Berry connection is gauge dependent, the Berry curvature is gauge invariant!
    }
    \remark{Using the language of differential geometry one immediately finds that the accumulated phase $\bar\gamma_a$ is simply the holonomy associated with the Berry connection along the considered trajectory. (See chapter \ref{chapter:principal_bundles}.)}
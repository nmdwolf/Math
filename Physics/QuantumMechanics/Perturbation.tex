\chapter{Perturbation Theory}\index{perturbation}

    \minitoc

\section{Interaction picture}\index{interaction!picture}\label{section:interaction_picture}

    Let $\widehat{H}(t)=\widehat{H}_0+\widehat{V}(t)$ be the total Hamiltonian of a system, where $\widehat{V}(t)$ denotes the (possibly time-dependent) interaction potential. Let $\ket{\psi(t)}$ and $\widehat{O}$ denote a state and operator in the Schr\"odinger picture, respectively.

    \newdef{Interaction representation}{
        In the interaction picture, the state vector is defined as follows:
        \begin{gather}
            \ket{\psi(t)}_I := e^{\tfrac{i}{\hbar}\widehat{H}_0t}\ket{\psi(t)}\,.
        \end{gather}
        It follows, that the operators in the interaction picture are given by
        \begin{gather}
            \widehat{O}_I(t) = e^{\tfrac{i}{\hbar}\widehat{H}_0t}\,\widehat{O}\,e^{-\tfrac{i}{\hbar}\widehat{H}_0t}\,.
        \end{gather}
    }

    \newformula{Schr\"odinger equation}{\index{Schr\"odinger!equation}
        Using the previous formulas, the Schr\"odinger equation can be rewritten as follows:
        \begin{gather}
            i\hbar\deriv{}{t}\ket{\psi(t)}_I = \widehat{V}_I(t)\ket{\psi(t)}_I\,.
        \end{gather}
        The time evolution of operators in the interaction picture is given by
        \begin{gather}
            \deriv{}{t}\widehat{O}_I(t) = \frac{i}{\hbar}\left[\widehat{H}_0,\widehat{O}_I(t)\right]\,.
        \end{gather}
        States evolve solely based on the interaction terms and operators evolve according to the free (time-independent) Hamiltonian.
    }

    \newformula{Tomonaga--Schwinger equation}{\index{Tomonaga--Schwinger equation}\label{perturbation:tomonaga_schwinger_equation}
        As in \cref{qm:evolution_operator}, the evolution operator $\widehat{U}(t,t')$ satisfies the following Schr\"odinger-type equation in the interaction picture:
        \begin{gather}
            i\hbar\deriv{}{t}\widehat{U}_I(t,t') = \widehat{V}_I(t)\widehat{U}_I(t,t')\,.
        \end{gather}
        Although this equation is often called the Tomonaga--Schwinger equation in the literature, this is actually not correct. The Tomonaga--Schwinger equation generalizes the Schr\"odinger equation to allow for evolutions between arbitrary \textit{Cauchy surfaces} (see \cref{gr:cauchy_surface}).
    }

    \newdef{M\o ller operator}{\index{M\o ller operator}
        The operators relating the (free) asymptotic states to the interacting state:
        \begin{gather}
            \ket{\psi(0)} = \widehat{\Omega}_\pm\ket{\text{in/out}}\,.
        \end{gather}
        If, for $t\longrightarrow\pm\infty$, the interaction term vanishes, there should exist a wave function $\ket{\phi(t)}$ evolving under the free Hamiltonian such that
        \begin{gather}
            \|\psi(t)-\phi(t)\|\xrightarrow{t\rightarrow\pm\infty}0\,.
        \end{gather}
        With $\ket{\text{in/out}}:=\lim_{t\rightarrow\pm\infty}\ket{\phi(t)}$, this gives
        \begin{gather}
            \widehat{\Omega}_\pm = \lim_{t\rightarrow\mp\infty}\exp\left(\tfrac{i}{\hbar}\widehat{H}(t)t\right)\exp\left(-\tfrac{i}{\hbar}\widehat{H}_0t\right)
        \end{gather}
        with respect to the strong topology.
    }
    \begin{remark}
        The limit in the definition of the M\o ller operators will only result in a well-defined operator for infinite-dimensional spaces.
    \end{remark}

\section{Rayleigh--Schr\"odinger theory}\index{Rayleigh--Schr\"odinger theory}

    The basic assumptions of Rayleigh--Schr\"odinger perturbation theory are that the perturbing Hamiltonian is time independent and that the eigenfunctions of the unperturbed Hamiltonian $\widehat{H}_0$ form a complete set for the perturbed Hamiltonian.

    \begin{formula}
        The perturbed eigenfunctions and eigenvalues can be expanded in the following way, where $\lambda\in\mathbb{R}$ is assumed to be a small (perturbation) parameter:
        \begin{gather}
            \begin{aligned}
                \ket{\psi_n} &= \sum_{i=0}^{+\infty}\lambda^i|\psi_n^{(i)}\rangle\,,\\
                E_n &= \sum_{i=0}^{+\infty}\lambda^iE_n^{(i)}\,,
            \end{aligned}
        \end{gather}
        where $i\in\mathbb{N}$ is called the \textbf{order} of the perturbation.
    \end{formula}

\todo{EXPAND}

\section{Adiabatic approximation}\index{adiabatic!approximation}
\subsection{Berry phase}\index{Berry!phase}

    \begin{theorem}[Adiabatic theorem]\index{adiabatic!theorem}
        If a perturbation is acting slowly enough such that the system can adapt its configuration at every single moment, the system will remain in the same eigenstate.
    \end{theorem}
    \sremark{The original formulation by \textit{Born} and \textit{Fock} also required the system to be \textit{gapped}. Later, this was shown to be inessential.}

    Consider a system for which the adiabatic approximation is valid and assume that the state starts of as an eigenstate. The wave function is then of the form
    \begin{gather}
        \ket{\psi(t)} = C_a(t)\exp\left(-\frac{i}{\hbar}\Int_{t_0}^tE_a(t')\,dt'\right)\ket{\psi_a(t)}\,,
    \end{gather}
    where the $\ket{\psi_a(t)}$ is an instantaneous eigenstate of $\widehat{H}(t)$. It follows from the orthonormality of the eigenstates $\ket{\psi_a(t)}$ that the coefficient $C_a(t)$ is just a phase factor, so it can be written as
    \begin{gather}
        C_a(t) = e^{i\gamma_a(t)}\,.
    \end{gather}
    By substituting this ansatz in the wave function, the Sch\"odinger equation gives a differential equation for the phase factors $\gamma_a(t)$. Integration gives
    \begin{gather}
        \label{perturbation:phase_factor}
        \gamma_a(t) = i\Int_{t_0}^t\braket{\psi_a(t')}{\pderiv{\psi_a(t')}{t'}}\,dt'\,.
    \end{gather}
    Due to time evolution, the wave function accumulates a phase through the coefficient $C_a(t)$. This phase is called the \textbf{Berry phase}.

    Now, try to apply a phase transformation to remove the Berry phase:
    \begin{gather}
        \label{perturbation:phase_transform}
        \ket{\psi'_a(t)} := e^{i\eta(t)}\ket{\psi_a(t)}\,.
    \end{gather}
    Inserting this in \cref{perturbation:phase_factor}, gives
    \begin{gather}
        \gamma'_a(t) = \gamma_a(t) - \eta(t) + \eta(t_0)\,.
    \end{gather}
    If the system is cyclic with period $\tau\in\mathbb{R}$, then $\psi_a(t_0) = \psi_a(t_0+\tau)$. Combining this with the equations above, gives
    \begin{gather}
        \eta(t_0+\tau) - \eta(t_0) = 2k\pi
    \end{gather}
    for some $k\in\mathbb{N}$. This implies that the Berry phase cannot be eliminated through a basis transformation and, hence, this phase is physically observable!

    \newdef{Berry connection}{\index{Berry!connection}
        The quantity
        \begin{gather}
            \mathbf{A}(\vector{x}) := i\braket{\psi_a(\vector{x})}{\nabla_{\vector{x}}\psi_a(\vector{x})}\,,
        \end{gather}
        where $\nabla_{\vector{x}}$ denotes the gradient in phase space, is called the Berry connection (or \textbf{Berry gauge potential}). Applying Stokes' theorem to~\eqref{perturbation:phase_factor} gives
        \begin{gather}
            \gamma_a(t_0+\tau) = \Int\symbfcal{B}\cdot d\vector{S}\,,
        \end{gather}
        where $\symbfcal{B} = \nabla_{\vector{x}}\times\mathbf{A}(\vector{x})$ is called the \textbf{Berry curvature}. Although the Berry connection is gauge-dependent, the Berry curvature is gauge-invariant.
    }
    \begin{remark}\index{holonomy}
        Using the language of differential geometry (\cref{chapter:principal_bundles}), one immediately finds that the accumulated phase $\gamma_a$ is simply the holonomy (\cref{bundle:parallel_transport}) associated with the Berry connection along the considered trajectory through phase space.
    \end{remark}
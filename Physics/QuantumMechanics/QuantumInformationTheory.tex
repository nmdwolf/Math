\chapter{Quantum Information Theory}\label{chapter:quantum_computing}

    The section on (quantum) reference frames is based on~\citet{de_la_hamette_quantum_2020}.

    \minitoc

\section{Entanglement}
\subsection{Introduction}

    \begin{construct}[Schmidt decomposition]\index{Schmidt!decomposition}\index{rank!Schmidt}
        Consider a bipartite state $\ket{\psi}\in\mathcal{H}_1\otimes\mathcal{H}_2$. For any such state, there exist orthonormal sets $\bigl\{\ket{e_i},\ket{f_j}\bigr\}_{i,j\leq\kappa}$ such that
        \begin{gather}
            \ket{\psi} = \sum_{i=1}^\kappa\lambda_i\ket{e_i}\otimes\ket{f_i}\,,
        \end{gather}
        where the coefficients $\lambda_i$ are nonnegative real numbers. All objects in this expression can be obtained from a singular value decomposition of the coefficient matrix $\mathbf{C}$ of $\ket{\psi}$ in some bases of $\mathcal{H}_1$ and $\mathcal{H}_2$. The number $\kappa\in\mathbb{N}$ is called the \textbf{Schmidt rank} of $\ket{\psi}$.
    \end{construct}

    \newdef{Entangled states}{\index{separable!state}\index{entanglement}
        Consider a state $\ket{\psi}$ and consider its Schmidt decomposition. If the Schmidt rank is 1, i.e.~the state can be written as $\ket{\psi} = \ket{v}\otimes\ket{w}$, the state is said to be \textbf{separable}. Otherwise, the state is said to be entangled.
    }

    The following theorem follow from the linearity of quantum mechanics.
    \begin{theorem}[No-cloning]\index{no-cloning}\label{quantum_information:no_cloning}
        There is no unitary operator $\widehat{U}$ on a Hilbert space $\mathcal{H}_1\otimes\mathcal{H}_2$ such that
        \begin{gather}
            \widehat{U}\ket{\psi}_1\ket{\phi}_2 = e^{i\alpha(\psi,\phi)}\ket{\psi}_1\ket{\psi}_2
        \end{gather}
        for all (normalized) $\ket{\psi}_1\in\mathcal{H}_1$ and $\ket{\phi}_1\in\mathcal{H}_2$.
    \end{theorem}
    \begin{theorem}[No-deleting]\index{no-deleting}\label{quantum_information:no_deleting}
        Consider a tripartite system $\mathcal{H}_1\otimes\mathcal{H}_2\otimes\mathcal{H}_3$ such that $\mathcal{H}_1\cong\mathcal{H}_2$. If $\widehat{U}$ is a unitary operator on $\mathcal{H}_1\otimes\mathcal{H}_2\otimes\mathcal{H}_3$ such that
        \begin{gather}
            \widehat{U}\ket{\psi}_1\ket{\psi}_2\ket{\phi}_3=\ket{\psi}_1\ket{0\vphantom{\psi}}_2\ket{\phi_\psi}_3
        \end{gather}
        for all $\ket{\psi}_1\in\mathcal{H}_1$, where the final ancilla state $\ket{\phi_\psi}_3$ might depend on the initial state $\ket{\psi}_1$, then $\widehat{U}$ is simply a swap, i.e.~$\ket{\psi}_1\mapsto\ket{\phi_\psi}_3$ is an isometric embedding.
    \end{theorem}

\subsection{Bell states}

    \newdef{Bell state}{\index{Bell state}\index{Einstein--Podolsky--Rosen|see{Bell state}}
        A (binary) Bell state (also called a \textbf{cat state} or \textbf{Einstein--Podolsky--Rosen pair}) is defined as the following entangled state:
        \begin{gather}
            \ket{\Phi^+} := \frac{1}{\sqrt{2}}\bigl(\ket{00}+\ket{11}\bigr)\,.
        \end{gather}
        In fact, this state can be extended to a full maximally entangled basis for the 2-qubit Hilbert space:
        \begin{gather}
            \begin{aligned}
                \ket{\Phi^-} &:= \frac{1}{\sqrt{2}}\bigl(\ket{00}-\ket{11}\bigr)\,,\\
                \ket{\Psi^+} &:= \frac{1}{\sqrt{2}}\bigl(\ket{01}+\ket{10}\bigr)\,,\\
                \ket{\Psi^-} &:= \frac{1}{\sqrt{2}}\bigl(\ket{01}-\ket{10}\bigr)\,.
            \end{aligned}
        \end{gather}
    }

    \begin{method}[Dense coding\footnotemark]\index{dense!coding}\index{action!spooky}
        \footnotetext{Sometimes called \textbf{superdense coding}.}
        Consider the Bell state $\ket{\Phi^+}$. By acting with one of the (unitary) spin-flip operators $\widehat{X},\widehat{Y},\widehat{Z}$, one can obtain any of the other three Bell states:
        \begin{gather}
            \begin{aligned}
                \widehat{X}\ket{\Phi^+} &= \ket{\Phi^-}\,,\\
                \widehat{Y}\ket{\Phi^+} &= \ket{\Psi^+}\,,\\
                \widehat{Z}\ket{\Phi^+} &= \ket{\Psi^-}\,.
            \end{aligned}
        \end{gather}
        In a typical Alice-and-Bob-style experiment, one can ask whether this observation allows to achieve a better-than-classical communication channel. If Alice performs a spin flip on her qubit, although the resulting state has instantly `changed' (cf.~\textit{spooky action at a distance}), Bob still cannot uniquely determine what this state is (since the resulting state is still maximally entangled). However, if Alice sends her qubit to Bob, the latter can perform a measurement on the composite system to find out what the state is and in this way determine which operation Alice performed ($\mathbbm{1},\widehat{X},\widehat{Y},\widehat{Z}$). Alice has thus effectively sent 2 classical bits of information through 1 qubit. Note that due to the fact that Alice still has to send her qubit through classical means, no faster-than-light communication is achieved.
    \end{method}

    \newdef{GHZ state}{\index{Greenberger--Horne--Zeilinger state}\label{quantum_information:ghz}
        The Greenberger--Horne--Zeilinger state is defined as the multiparticle qudit ($d,N>2$) version of the Bell state and is, therefore, also referenced to as a cat state:
        \begin{gather}
            \ket{\mathrm{GHZ}} = \frac{1}{\sqrt{n}}\sum_{i=0}^{n-1}\ket{i}^{\otimes N}\,.
        \end{gather}
    }

\subsection{SRE states}\label{section:sre_states}

    \todo{ADD}

\section{Density operators}\index{density!operator}\label{section:density_operator}

    \newdef{Density operator}{\index{density!operator}
        Consider a (finite-dimensional) Hilbert space $\mathcal{H}$. A density operator on $\mathcal{H}$ is a linear operator $\rho\in\End(\mathcal{H})$ satisfying the following properties:
        \begin{enumerate}
            \item\textbf{Positivity}: $\braket{v}{\rho v}\geq0$ for all $v\in\mathcal{H}$,
            \item\textbf{Hermiticity}: $\rho^\dag=\rho$, and
            \item\textbf{Unit trace}: $\tr(\rho)=1$.
        \end{enumerate}
        More concisely, density operators are the representing objects of normal states (\cref{operators:normal_state}) on $\mathcal{B}(\mathcal{H})$.
    }

    \begin{example}[Classical probability]
        A diagonal density matrix corresponds to a discrete probability distribution.
    \end{example}

    \newdef{Pure state}{\index{pure}
        A state is said to be pure if it is described by an outer product of a state vector or, equivalently, by an idempotent density matrix:
        \begin{gather}
            \rho = \ket{\psi}\bra{\psi}\,.
        \end{gather}
        A density matrix that is not of this form gives rise to a \textbf{mixed state}.
    }

	\newdef{Reduced density operator}{
		Let $\ket{\Psi}\in\mathcal{H}_A\otimes\mathcal{H}_B$ be the state of a bipartite system. The reduced density operator $\rho_A$ of $A$ is defined as follows:
		\begin{gather}
			\rho_A := \tr_B\ket{\Psi}\bra{\Psi}\,.
		\end{gather}
	}

	\newdef{Purification}{\index{purification}
		Let $\rho_A$ be the density operator of a system $A$. A purification of $\rho_A$ is a pure state $\ket{\Psi}$ of some composite system $A\otimes B$ such that
		\begin{gather}
			\rho_A = \tr_B\ket{\Psi}\bra{\Psi}\,.
		\end{gather}
	}
	\begin{property}
		Any two purifications of the same density operator $\rho_A$ are related by a transformation $\mathbbm{1}_A\otimes\widehat{V}$ with $\widehat{V}$ an isometry.
	\end{property}

\section{Channels}

    The following definition generalizes the content of \cref{section:PVM} to the setting of partial information. When generalizing the projections in a PVM (spectral measure), one obtains a POVM.
    \newdef{Positive operator-valued measure}{\index{measurement!positive-operator valued}
        First, let $\mathcal{H}$ be a finite-dimensional Hilbert space. A POVM on $\mathcal{H}$ consists of a finite set of positive (semi)definite operators $\{P_i\}_{i\leq n}$ such that
        \begin{gather}
            \sum_{i=1}^nP_i=\mathbbm{1}_{\mathcal{H}}\,.
        \end{gather}
        The probability to obtain state $i$, given a general state $\widehat{\rho}$, is given by $\tr(\widehat{\rho}P_i)$. Note that the operators are not necessarily orthogonal projectors, so $n$ can be greater than $\dim(\mathcal{H})$.

        Now, consider a measurable space $(X,\Sigma)$ and a (possibly infinite-dimensional) Hilbert space $\mathcal{H}$. A POVM on $X$ consists of a function $P:\Sigma\rightarrow\mathcal{B}(\mathcal{H})$ satisfying the following conditions:
        \begin{enumerate}
            \item $P_E$ is positive and self-adjoint for all $E\in\Sigma$,
            \item $P_X=\mathbbm{1}_{\mathcal{H}}$, and
            \item for all disjoint $\seq{E}\subset\Sigma$:
                \begin{gather}
                    \sum_{n\in\mathbb{N}}P_{E_n} = P_{\cup_{n\in\mathbb{N}}E_n}\,.
                \end{gather}
        \end{enumerate}
    }

    The following theorem can be derived from Stinespring's theorem~\ref{operators:stinespring}.
    \begin{theorem}[Naimark dilation theorem]\index{Naimark dilation theorem}
        Every POVM $P$ on $\mathcal{H}$ can be realized as a PVM $\Pi$ on a, possibly larger, Hilbert space $\mathcal{K}$, i.e.~there exists a bounded operator $V:\mathcal{K}\rightarrow\mathcal{H}$ such that
        \begin{gather}
            P(\cdot) = V\Pi(\cdot)V^\dagger\,.
        \end{gather}
        In the finite-dimensional setting, $V$ can be chosen to be an isometry.
    \end{theorem}

    Recall the content of \cref{section:c_star_algebras}.
    \newdef{Completely positive trace-preserving}{\index{quantum!channel}\index{super-!operator}
        Consider a map $\Phi:\mathcal{B}(\mathcal{H}_1)\rightarrow\mathcal{B}(\mathcal{H}_2)$ between bounded operators on two (finite-dimensional) Hilbert spaces. This map preserves density matrices if it positive (\cref{operators:positive_map}) and if it is trace-preserving (\cref{operators:trace_preserving}). Furthermore, to ensure that an operation applied to a subsystem does not interfere with the positivity of the complete system, they are also required to be completely positive (\cref{operators:cp_map}).

        Completely positive, trace-preserving (CPTP) maps are often called \textbf{quantum channels} or \textbf{superoperators}.
    }

    \begin{theorem}[Choi--Jamio\l{}kowski]\index{Choi--Jamio\l{}kowski}
        The following map between quantum channels $\Phi:\mathcal{B}(\mathcal{H}_1)\rightarrow\mathcal{B}(\mathcal{H}_2)$ and density operators $\rho\in\End(\mathcal{H}_1\otimes\mathcal{H}_2)$ is an isomorphism:
        \begin{gather}
            \Phi\mapsto(\mathbbm{1}_{\mathcal{H}_1}\otimes\Phi)\ket{\mathrm{GHZ}}\bra{\mathrm{GHZ}}\,,
        \end{gather}
        where the GHZ state was introduced in \cref{quantum_information:ghz}.
    \end{theorem}

\section{Quantum logic}\label{section:quantum_logic}
\subsection{Birkhoff--von Neumann logic}

    Consider classical propositional logic. This is governed by the Boolean property, i.e.~the set of all propositions admits the structure of a complete Boolean algebra (\cref{type:boolean_logic}). Now, the question becomes how to treat propositions in quantum mechanics (as needed in, for example, quantum computing). In the sense of \indexauthor{von Neumann}, the propositions should be characterized by $\{0,1\}$-valued observables or, equivalently, by projection operators. As such, the natural lattice to consider logic is that of closed subspaces of the state space $\mathcal{H}$ (which is a Hilbert space). Birkhoff--von Neumann logic is the study of such lattices.

    Note that, in contrast to classical logic, the lattices of closed subspaces are not Boolean. The lattices are merely complete, orthomodular lattices (\cref{set:complemented_lattice}).\footnote{It should be noted that complete, orthomodular lattices are, in general, very different from those originating from Hilbert spaces (cf.~\textit{Piron's theorem}).\index{Piron}} Now, although these lattices are themselves very interesting, there relevance for quantum logic are heavily discussed for several reasons (e.g.~lack of distributivity, lack of a clear implication operator, lack of an extension to predicate logic). In the next section it will be explained how this issue can be avoided by embedding Birkhoff--von Neumann logic into the more general framework of linear logic.

\subsection{Linear logic}

    A basic component of standard logic are the \textit{structural inference rules}.\index{inference rule} These are inference rules that do not involve any logical operations. The following two inference rules for first-order logic control context extension (for an introduction to sequent calculus, see \cref{section:sequent_calculus}):
    \begin{itemize}
        \item\textbf{Contraction}\index{contraction}:
        \begin{gather}
            \begin{aligned}
                \Gamma,p_1:P,p_2:P &\vdash t_{p_1,p_2}:T\\
                \hline
                \Gamma,p:P &\vdash t_{p,p}:T\,.
            \end{aligned}
        \end{gather}
        This rule states that, in a valid judgement, premises might be used more than once.
        \item\textbf{Weakening}:
        \begin{gather}
            \begin{aligned}
                \Gamma\vdash P:&\mathrm{Type}\qquad\Gamma\vdash t:T\\
                \hline
                &\Gamma,P\vdash t:T\,.
            \end{aligned}
        \end{gather}
        This rule states that, any premise can be added to (the premises of) a valid judgement.
    \end{itemize}
    In terms of categorical semantics, these two rules correspond (in the independent setting) to the diagonal and projection morphisms in Cartesian categories (\cref{cat:semicartesian}).

    Now, when considering quantum mechanics, two important results are the no-cloning and no-deleting theorem (\cref{quantum_information:no_cloning} and \cref{quantum_information:no_deleting}). These correspond to the fact that the categories $\mathbf{FinVect}$ and $\mathbf{Hilb}$ are monoidal, but not Cartesian monoidal, i.e.~the tensor product does not admit diagonal and projection morphisms. The natural type of logic in this setting is than a \textit{substructural} one where the contraction and weakening rules are not valid.

    In linear logic, the following propositions exist:
    \begin{enumerate}
        \item\textbf{Variables}: Every propositional variable is a proposition.
        \item\textbf{Negation}: If $P$ is a proposition, so is $P^\perp$.
        \item\textbf{Connectives}: If $P,Q$ are propositions, then
            \begin{itemize}
                \item\textbf{Additive conjunction}: $P\& Q$ is a proposition. (Read: $P\text{ with }Q$.)
                \item\textbf{Additive disjunction}: $P\oplus Q$ is a proposition. (Read: $P\text{ plus }Q$.)
                \item\textbf{Multiplicative conjunction}: $P\otimes Q$ is a proposition. (Read: $P\text{ times }Q$.)
                \item\textbf{Multiplicative disjunction}: $P\dualampersand Q$ is a proposition. (Read: $P\text{ par }Q$.)
            \end{itemize}
        \item\textbf{Constants}:
            \begin{itemize}
                \item\textbf{Additive truth}: $\top$,
                \item\textbf{Additive falsity}: $\mathbf{0}$,
                \item\textbf{Multiplicative truth}: $\mathbf{1}$, and
                \item\textbf{Multiplicative falsity}: $\bot$.
            \end{itemize}
        \item\textbf{Exponential connectives}: If $P$ is a proposition, then
            \begin{itemize}
                \item\textbf{Exponential conjunction}: $!P$ is a proposition. (Read: $\text{of course }P$.)
                \item\textbf{Exponential disjunction}: $?P$ is a proposition. (Read: $\text{why not }P$.)
            \end{itemize}
    \end{enumerate}
    Given a context, the following inference rules are valid:\footnote{The form of these rules heavily depends on the exchange rule (the second item). Care must be taken if this rule is weakened.}
    \begin{enumerate}
        \item\textbf{Identity*}: If $P$ is a propositional variable, then $P\vdash P$.
        \item\textbf{Exchange*}: Sequents remain valid under permutations.
        \item\textbf{Restricted weakening*}: If $P$ is a proposition, then
            \begin{gather}
                \begin{aligned}
                    &\Gamma\vdash\Theta\\
                    \hline
                    \Gamma&,!P\vdash\Theta
                \end{aligned}
            \end{gather}
            and, dually,
            \begin{gather}
                \begin{aligned}
                    &\Gamma\vdash\Theta\\
                    \hline
                    \Gamma&\vdash\Theta,?P
                \end{aligned}\,.
            \end{gather}
        \item\textbf{Restricted contraction*}: If $P$ is a proposition, then
            \begin{gather}
                \begin{aligned}
                    !P&,!P\vdash\Theta\\
                    \hline
                    &!P\vdash\Theta
                \end{aligned}
            \end{gather}
            and, dually,
            \begin{gather}
                \begin{aligned}
                    \Gamma&\vdash?P,?P\\
                    \hline
                    &\Gamma\vdash?P
                \end{aligned}\,.
            \end{gather}
        \item\textbf{Negation}: If $P$ is a proposition, then
            \begin{gather}
                \begin{aligned}
                    &\Gamma\vdash\Theta,P\\
                    \hline
                    &\Gamma,P^\perp\vdash\Theta
                \end{aligned}
            \end{gather}
            and, conversely,
            \begin{gather}
                \label{quantum_information:negation_rule}
                \begin{aligned}
                    &\Gamma,P\vdash\Theta\\
                    \hline
                    &\Gamma\vdash\Theta,P^\perp
                \end{aligned}\,.
            \end{gather}
            Note that these rules allow to write any sequent in right form, i.e.~$\vdash\Gamma^\perp,P$.
        \item\textbf{Additive conjunction}: If $P,Q$ are propositions, then
            \begin{gather}
                \begin{aligned}
                    &P\vdash\Theta\\
                    \hline
                    P&\& Q\vdash\Theta
                \end{aligned}
                \qquad
                \begin{aligned}
                    &Q\vdash\Theta\\
                    \hline
                    P&\& Q\vdash\Theta
                \end{aligned}
            \end{gather}
            and, conversely,
            \begin{gather}
                \begin{aligned}
                    \Gamma\vdash&P\qquad\Gamma\vdash Q\\
                    \hline
                    &\Gamma\vdash P\&Q
                \end{aligned}\,.
            \end{gather}
        \item\textbf{Additive disjunction}: If $P,Q$ are propositions, then
            \begin{gather}
                \begin{aligned}
                    &\Gamma\vdash P\\
                    \hline
                    \Gamma&\vdash P\oplus Q
                \end{aligned}
                \qquad
                \begin{aligned}
                    &\Gamma\vdash Q\\
                    \hline
                    \Gamma&\vdash P\oplus Q
                \end{aligned}
            \end{gather}
            and, conversely,
            \begin{gather}
                \begin{aligned}
                    P\vdash&\Theta\qquad Q\vdash\Theta\\
                    \hline
                    &P\oplus Q\vdash\Theta
                \end{aligned}\,.
            \end{gather}
        \item\textbf{Multiplicative conjunction}: If $P,Q$ are propositions, then
            \begin{gather}
                \begin{aligned}
                    &\,\,P,Q\vdash\Theta\\
                    \hline
                    &P\otimes Q\vdash\Theta
                \end{aligned}
            \end{gather}
            and, conversely,
            \begin{gather}
                \begin{aligned}
                    \Gamma\vdash&P\qquad\Lambda\vdash Q\\
                    \hline
                    \Gamma,\,&\Lambda\vdash P\otimes Q
                \end{aligned}\,.
            \end{gather}
        \item\textbf{Multiplicative disjunction}: If $P,Q$ are propositions, then
            \begin{gather}
                \begin{aligned}
                    &\Gamma\vdash P,Q\\
                    \hline
                    \Gamma&\vdash P\dualampersand Q
                \end{aligned}
            \end{gather}
            and, conversely,
            \begin{gather}
                \begin{aligned}
                    P\vdash&\Delta\qquad Q\vdash\Theta\\
                    \hline
                    P&\dualampersand Q\vdash\Delta,\Theta
                \end{aligned}\,.
            \end{gather}
        \item\textbf{Truth and falsity}:
            \begin{gather}
                \begin{aligned}
                    \Gamma\vdash\top &\qquad \mathbf{0}\vdash\Theta\\
                    \begin{aligned}
                        \Gamma&\vdash\Theta\\
                        \hline
                        \Gamma,&\mathbf{1}\vdash\Theta
                    \end{aligned}
                    &\qquad \vdash\mathbf{1}
                    \\
                    \begin{aligned}
                        &\vdash\Theta\\
                        \hline
                        &\vdash\Theta,\bot
                    \end{aligned}
                    &\qquad \bot\vdash\,.
                \end{aligned}
            \end{gather}
        \item\textbf{Exponential conjunction}: If $P$ is a proposition, then
            \begin{gather}
                \begin{aligned}
                    P&\vdash\Theta\\
                    \hline
                    !P&\vdash\Theta
                \end{aligned}
            \end{gather}
            and, conversely, whenever $\Gamma$ consists solely of $!$-propositions and $\Theta$ consists solely of $?$-propositions,
            \begin{gather}
                \begin{aligned}
                    \Gamma&\vdash P\\
                    \hline
                    \Gamma&\vdash!P
                \end{aligned}\,.
            \end{gather}
        \item\textbf{Exponential disjunction}: If $P$ is a proposition, then
            \begin{gather}
                \begin{aligned}
                    \Gamma&\vdash P\\
                    \hline
                    \Gamma&\vdash?P
                \end{aligned}
            \end{gather}
            and, conversely, whenever $\Gamma$ consists solely of $!$-propositions and $\Theta$ consists solely of $?$-propositions,
            \begin{gather}
                \begin{aligned}
                    P&\vdash\Theta\\
                    \hline
                    ?P&\vdash\Theta
                \end{aligned}\,.
            \end{gather}
    \end{enumerate}
    The inference rules with an asterisk are the structural rules. Note that a \textit{cut-elimination theorem} holds and, hence, the identity and cut rules for general propositions can be derived from the rules above.

    Linear implication is characterized as follows:
    \begin{gather}
        P\vdash Q \iff \vdash P^\perp\dualampersand Q \iff \vdash P\multimap Q\,.
    \end{gather}

    \begin{remark}[Resource theory]
        Before passing to the properties that follow from the basic rules and the categorical semantics of linear logic (eventually passing to linear type theory), it is useful to rephrase the connectives and their inference rules in terms of `resources'.

        In this interpretation, an implication $A\implies B$ would mean that the resources $A$ can be used to obtain the resources $B$. However, in ordinary logic, if $A$ and $A\implies B$ hold, then one can derive that $B$ holds, but $A$ also still holds, something that does not work with resources. If you can use resources $A$ to construct $B$, the resources $A$ are (usually\footnote{This is not the case with catalysts}) used up.\footnote{One could also give this a causal flavour~\citep{girard_linear_1995}.} One, hence, needs a more subtle and nuanced framework to capture these notions: linear logic. The implication that will be used, where resources are spent, is denoted by $A\multimap B$ for clarity. The two conjunctives, $\otimes$ and $\&$, mean that two resources are available concurrently and separately, respectively. So, if $A\multimap B$ holds, then, since the contraction rule is not valid, one does not have $A\multimap B\otimes B$. However, one does have $A\otimes A\multimap B\otimes B$.
    \end{remark}

    The connectives in linear logic satisfy (or generalize) many of the properties of ordinary logic.
    \begin{property}[Distributivity]
        \begin{gather}
            \begin{aligned}
                P\otimes(Q\oplus R) &= (P\otimes Q)\oplus(P\otimes R)\\
                P\dualampersand(Q\& R) &= (P\dualampersand Q)\&(P\dualampersand R)\\
                P\otimes\mathbf{0} &= \mathbf{0}\\
                P\dualampersand\top &= \top
            \end{aligned}
        \end{gather}
    \end{property}

    The exponential connectives can be used to turn additive connectives into multiplicative ones (and the other way around) as with the ordinary exponential function in calculus.
    \begin{property}
        \begin{gather}
            \begin{aligned}
                !(P\& Q) &=\ !P\otimes!Q\\
                ?(P\oplus Q) &=\ !P\dualampersand!Q\\
                !\top &= \mathbf{1}\\
                ?\mathbf{0} &= \bot
            \end{aligned}
        \end{gather}
    \end{property}
    Moreover, due to the apparent similarity with the operators in (S4) modal logic (\cref{section:modal_logic}), the exponential connectives are sometimes also called \textbf{modalities}.\index{modality}

    Linear negation can also be defined alternatively.
    \begin{property}[Negation]\label{quantum_information:negation}
        Linear negation admits the following recursive definition:
        \begin{itemize}
            \item $P^{\perp\perp}=P$,
            \item $(P\& Q)^\perp=P^\perp\oplus Q^\perp$,
            \item $(P\otimes Q)^\perp=P^\perp\dualampersand Q^\perp$,
            \item $\top^\perp=\mathbf{0}$,
            \item $\mathbf{1}^\perp=\bot$, and
            \item $(!P)^\perp=?P^\perp$.
        \end{itemize}
    \end{property}

    \begin{property}[Categorical semantics]
        Whereas standard Boolean logic is the internal logic of Cartesian closed categories --- where conjunction, disjunction and implication correspond, respectively to products, coproducts and internal homs --- linear logic is the internal logic of (a subclass of) $\ast$-autonomous categories (\cref{hda:star_autonomous_category}).

        The multiplicative conjunction $\otimes$ corresponds to the tensor product, hence the notation. Similar to ordinary logic, the linear implication $\multimap$ corresponds to taking internal homs. The important part, now, is that negation comes as a separate entity, in this case given by taking duals: $x^\perp\equiv x^*$. The multiplicative disjunction $\dualampersand$ is then constructed through \cref{quantum_information:negation} (which corresponds to de Morgan duality as in \cref{hda:de_morgan_duality}).

        For the additive connectives, one needs the existence of finite products. The $\ast$-autonomy then also implies the existence of finite coproducts (again through de Morgan duality).

        For the exponential connectives, some more structure is needed. As with modal logic, the structure is given by the existence of a suitable (co)monad.
    \end{property}

\section{\difficult{Topos theory}}
\subsection{Bohr topos}

    \newdef{Bohr topos}{\index{Bohr!topos}\index{Alexandrov!topology}
        Consider a $C^*$-algebra $A$ and denote by $\mathrm{ComSub}(A)$ the poset (\cref{set:poset}) of commutative $C^*$-subalgebras. This set can be equipped with the \textbf{Alexandrov topology}\footnote{There exist an equivalences $\mathbf{Pre}\cong\mathbf{AlexTop}$ and $\mathbf{Pos}\cong\mathbf{AlexTop}_{T_0}$.}, i.e.~the topology for which the open sets are the upward closed subsets. The topological space $(\mathrm{ComSub}(A),\tau_{\text{Alex}})$ is called the Bohr site of $A$.

        The sheaf topos over the Bohr site is called the Bohr topos $\mathbf{Bohr}(A)$. It can be turned into a ringed topos, where the ring object (which is even an internal commutative $C^*$-algebra) is given by the tautological functor
        \begin{gather}
            \underline{A}:\mathrm{ComSub}(A)\rightarrow\mathbf{Set}:C\mapsto C\,.
        \end{gather}
    }

    \begin{property}\label{quantum:topos_morphisms}
        A morphism in $\mathbf{C^*Alg}$ is commutativity reflecting if and only if the induced morphism on posets admits a right adjoint. Moreover, there exists a bijection between the following two classes of morphisms:
        \begin{itemize}
            \item Geometric morphisms $f:\mathbf{Bohr}(B)\rightarrow\mathbf{Bohr}(A)$ admitting a right adjoint together with epimorphisms of internal algebras $\underline{A}\rightarrow f^*\underline{B}$.
            \item Commutativity-reflecting functions $f:A\rightarrow B$ that restrict to algebra morphisms on all commutative subalgebras.
        \end{itemize}
    \end{property}

    \newdef{Spectral presheaf}{\index{spectral!presheaf}\label{quantum_information:spectral_presheaf}
        The presheaf $\Sigma$ on a Bohr site assigning to every commutative subalgebra its Gel'fand spectrum.
    }

    The idea behind the Bohr topos is that, given a general $C^*$-algebra $A$, the Bohr topos $\mathbf{Bohr}(A)$ is interpreted as its quantum phase space.\index{phase space} This is similar to \cref{section:smooth_spaces}, where smooth spaces are also reinterpreted in terms of sheaf topoi.

    \begin{theorem}[Kochen--Specker]\index{Kochen--Specker}\index[author]{Kochen}\index[author]{Specker}
        For $A=\mathcal{B}(\mathcal{H})$, the spectral presheaf has no global elements if $\dim(\mathcal{H})>2$.
    \end{theorem}

    \begin{property}[Gleason's theorem]\index{Gleason}\index[author]{Gleason}
        There exists a natural bijection between the quantum states of a $C^*$-algebra $A$ and the classical states of $\underline{A}$ internal to $\mathbf{Bohr}(A)$.
    \end{property}

    \newdef{Bohrification}{\index{Bohrification}
        Consider a $C^*$-algebra $A$ together with its Bohr topos $\mathbf{Bohr}(A)$. To its internal $C^*$-algebra $\underline{A}$, one can assign an internal locale $\underline{\Sigma}_A$ by (internal) Gel'fand duality (\cref{operators:gelfand_spectrum}). Under the equivalence~\ref{topos:slice_locale}, one then obtains a locale $\Sigma_A$. The functor
        \begin{gather}
            \func{\Sigma}{C^*Alg}{Loc}:A\mapsto\Sigma_A
        \end{gather}
        is called Bohrification. This locale can be constructed as the disjoint union
        \begin{gather}
            \Sigma_A = \bigsqcup_{C\in\mathrm{ComSub}(A)}\Phi_C\,,
        \end{gather}
        the \'etale locale corresponding to the spectral presheaf (i.e.~the spectral presheaf is the internal Gel'fand spectrum of $\underline{A}$). Its open sets are given by those subsets whose restrictions to commutative subalgebras are open in such a way that these restrictions are compatible with subalgebra inclusions.
    }
    \begin{example}[Gel'fand spectrum]\index{Gel'fand!spectrum}\index{topology!double negation}\index{nucleus}
        If $A$ is a commutative $C^*$-algebra, its Bohrification is not isomorphic to its ordinary Gel'fand spectrum $\Phi_A$. However, after replacing the topology on $\mathbf{Bohr}(A)$ by the double negation topology (\cref{topos:double_negation}) and repeating the above construction, one obtains
        \begin{gather}
            \Phi_A\cong\Sigma^{\lnot\lnot}_A\,.
        \end{gather}
        This locale can also be obtained in another way. Double negation $\lnot\lnot$ defines an (internal) \textbf{nucleus} on the (internal) locale $\Sigma_A$, i.e.~a left-exact monad. $\Sigma_A^{\lnot\lnot}$ is then given by the fixed points of $\lnot\lnot:\Sigma_A\rightarrow\Sigma_A$. 
    \end{example}

    By \cref{quantum:topos_morphisms} above, the following relation is obtained.
    \begin{property}[Observables]\index{observable}
        Morphisms $\mathbf{Bohr}(A)\rightarrow\mathbf{Bohr}(C(\mathbb{R})_0)$ admitting a right adjoint together with an epimorphism $\underline{C_0(\mathbb{R})}\rightarrow f^*\underline{A}$ correspond to observables on $A$.
    \end{property}

    The topological bundle $\Sigma_A\rightarrow\mathrm{Alex}(\mathrm{ComSub}(A))$ also admits a topos-theoretic incarnation. There exists a (canonical) morphism of ringed topoi
    \begin{gather}
        \pi:\mathbf{Bohr}(A)\rightarrow\bigl(\mathbf{Sh}\bigl(\mathrm{Alex}(\mathrm{ComSub}(A))\bigr),\underline{\mathbb{R}}\bigr)\,,
    \end{gather}
    whose underlying geometric morphism is simply the identity.

    \begin{property}[States]\index{state}
        A positive and normalized section of the morphism $\pi:\mathbf{Bohr}(A)\rightarrow\bigl(\mathbf{Sh}\bigl(\mathrm{Alex}(\mathrm{ComSub}(A))\bigr),\underline{\mathbb{R}}\bigr)$ in the category of $\underline{\mathbb{R}}$-\textit{module topoi}.
    \end{property}

\subsection{Internal logic}

    Whereas \cref{section:quantum_logic} covers quantum logic from the external point of view, the spectral presheaf (\cref{quantum_information:spectral_presheaf}) allows to treat it internally. By functional calculus (\cref{section:PVM}), every proposition $A\in\Delta$ about a self-adjoint operator on a Hilbert space $\mathcal{H}$, i.e.~every measurable subset of the spectrum $\sigma(A)$, corresponds to a projection $P_{A,\Delta}$. Now, the goal will be to assign to every such projection a `classical interpretation' in the classical \textbf{context} given by a commutative subalgebra of $A$.\index{context} This is achieved by the subobject of the spectral presheaf $\Sigma$ constructed as follows:
    \begin{gather*}
        \delta_P(V) := \{\omega\in\Sigma_v\mid\omega(P|_V)=1\}\,,
    \end{gather*}
    where $P|_V$ is the smallest projection in $V$ such that $\im(P)\subseteq\im(P|_V)$. The morphism
    \begin{gather*}
        \delta:\mathcal{P}(\mathcal{H})\rightarrow\mathrm{Sub}(\Sigma)
    \end{gather*}
    is called the \textbf{daseinization} map.\index{daseinization} Note that this map extends to all self-adjoint operators through functional calculus.

    A `pure state' $\psi$ in classical mechanics corresponds to a map from subsets of phase space to the subobject classifier (saying whether the point lies in the given subset or not):
    \begin{gather*}
        T^\psi:\mathrm{Sub}(P)\rightarrow\{0,1\}\,.
    \end{gather*}
    By analogy, a pure state $\ket{\psi}$ in quantum mechanics will correspond to a morphism from subobjects of the spectral presheaf:
    \begin{gather*}
        T^{\ket{\psi}}:\mathrm{Sub}(\Sigma)\rightarrow\mathrm{Hom}_{\mathbf{Psh}(\mathrm{ComSub}(A))}(1,\Omega)\,,
    \end{gather*}
    where $\Omega$ is the subobject classifier from \cref{topos:presheaf_topos}.
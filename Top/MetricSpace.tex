\chapter{Metric Spaces}
\section{Definition}

    \newdef{Metric}{\index{metric}\index{distance}\label{metric:metric}
        A metric (or \textbf{distance}) on a set M is a map $d:M\times M\rightarrow\mathbb{R}^+$ that satisfies the following properties:
        \begin{enumerate}
            \item \textbf{Nondegeneracy}: $d(x,y)=0\iff x=y$,
            \item \textbf{Symmetry}: $d(x,y) = d(y,x)$, and
            \item \textbf{Triangle inequality}: $\forall x,y,z\in M:d(x,z)\leq d(x,y) + d(y,z)$.
        \end{enumerate}
        A set $M$ equipped with a metric $d$ is called a \textbf{metric space}.
    }

    \newdef{Diameter}{\index{diameter}
        The diameter of a subset $U\subset(M,d)$ of a metric space is defined as follows:
        \begin{gather}
            \text{diam}(U) := \sup_{x,y\in U}d(x,y).
        \end{gather}
    }
    \newdef{Bounded}{
        A subset $U\subseteq M$ is bounded if $\text{diam}(U)<+\infty$.
    }

\section{Topology}

    Multiple topological notions can be (re)formulated in terms of a metric. The most important ones are given below:
    \newdef{Open ball}{\index{ball}
        An open ball centered on a point $x_0\in M$ with radius $R>0$ is defined as the following set:
        \begin{gather}
            \label{metric:open_ball}
            B(x_0,R) := \{x\in M\mid d(x,x_0)<R\}.
        \end{gather}
    }
    \begin{property}[Metric topology]\index{topology!metric}
        Every metric space can be turned into a topological space by taking the open balls to be a basis.
    \end{property}
    \newdef{Closed ball}{
        The closed ball $\overline{B}(x_0,R)$ is defined as the closure of the open ball $B(x_0,R)$:
        \begin{gather}
            \overline{B}(x_0,R) := \{x\in M\mid d(x,x_0)\leq R\}.
        \end{gather}
    }

    \newdef{Convergence}{\index{convergence}\label{metric:convergence}
        A sequence $\seq{x}$ in a metric space $(M,d)$ is said to converge to a point $a\in M$ if
        \begin{gather}
            \forall\varepsilon>0:\exists N_0\in\mathbb{N}:\forall n\geq N_0:d(x_n,a)<\varepsilon.
        \end{gather}
    }
    \newdef{Continuity}{\index{continuity}\label{metric:continuity}
        Let $(M,d)$ and $(M',d')$ be two metric spaces. A function $f:M\rightarrow M'$ is said to be continuous at a point $a\in$ $\dom(f)$ if
        \begin{gather}
            \forall\varepsilon>0:\exists\delta_\varepsilon>0:\forall x\in\dom(f):d(a,x)<\delta_\varepsilon\implies d'(f(a),f(x))<\varepsilon.
        \end{gather}
    }
    \begin{property}
        Let $(M,d)$ be a metric space. The distance function $d:M\times M\rightarrow\mathbb{R}$ is a continuous function.
    \end{property}

    \newdef{Uniform continuity}{\index{uniform!continuity}\label{metric:uniform_continuity}
        Let $(M,d)$ and $(M',d')$ be two metric spaces. A function $f:M\rightarrow M'$ is said to be uniformly continuous if
        \begin{gather}
            \forall\varepsilon>0:\exists\delta_\varepsilon:\forall x, y\in\dom(f):d(x,y)<\delta_\varepsilon\implies d'(f(x),f(y))<\varepsilon.
        \end{gather}
        This is clearly a stronger notion than that of continuity since the number $\varepsilon$ is equal for all points $y\in\dom(f)$.
    }

    \newdef{Metrizable space}{\index{metrizable}
        A topological space $X$ is metrizable if it is homeomorphic to a metric space $M$ or, equivalently, if there exists a metric function $d:X\times X\rightarrow\mathbb{R}$ such that it induces the topology on $X$.
    }
    \begin{theorem}[Urysohn's metrization theorem]\index{Urysohn!metrization theorem}
        A space that is $T_3$ and second-countable is metrizable.
    \end{theorem}

\section{Examples}

    \begin{example}[Product space]\index{product!space}
        Consider the Cartesian product \[M = M_1\times M_2\times\cdots\times M_n,\] where $(M_i,d_i)$ is a metric space for all $i\leq n$. Equipped with the distance function
        \begin{gather}
            d(x,y) := \max_{1\leq i\leq n}d_i(x_i,y_i)
        \end{gather}
        this product space becomes a metric space.
    \end{example}
    \begin{property}[Projections determine convergence]\index{projection}\label{metric:projection}
        Let $M$ be a product metric space. Consider the projections associated with the sets $M_j$:
        \begin{gather}
            \mathrm{pr}_j:M\rightarrow M_j:(a_1,\ldots,a_n)\mapsto a_j.
        \end{gather}
        A sequence in a product metric space $M$ converges if and only if every component $(\mathrm{pr}_j(x_m))_{m\in\mathbb{N}}$ converges in $(M_j, d_j)$.
    \end{property}

    \begin{example}[Supremum distance]\label{metric:supremum_distance}
        Let $K\subset\mathbb{R}^n$ be a compact set. The following map defines a metric on $C(K,\mathbb{C})$:
        \begin{gather}
            d_\infty(f,g) := \sup_{x\in K}|f(x) - g(x)|.
        \end{gather}
    \end{example}

    \begin{example}[p-metric]\label{metric:p_metric}
        For every $p\geq1$ one defines the $L^p$-norm on $\mathbb{R}^n$ by the following formula:
        \begin{gather}
            d_p(x,y) := \left(\sum_{i=1}^n|x_i-y_i|^p\right)^{\nicefrac{1}{p}}.
        \end{gather}
    \end{example}
    \begin{example}[Chebyshev distance]\index{Chebyshev!distance}\label{metric:chebyshev_distance}
        The Chebyshev distance is defined similarly to the supremum distance:
        \begin{gather}
            d_\infty(x,y) := \max_{1\leq i\leq n}|x_i - y_i|.
        \end{gather}
        This metric is also sometimes called the \textbf{maximum metric} or $L^\infty$-metric.
    \end{example}
    \begin{remark}
        The Chebyshev metric is also an example of a product metric defined on the Euclidean product space $\mathbb{R}^n$. The notation $d_\infty$, which is also used for the supremum distance, can be justified if the space $\mathbb{R}^n$ is identified with the set of maps $\{1,\ldots,n\}\rightarrow\mathbb{R}$ equipped with the supremum distance. Another justification is the following relation:
        \begin{gather}
            d_\infty(x,y) = \lim_{p\rightarrow\infty}\ d_p(x,y),
        \end{gather}
        which is also the origin of the name $L^\infty$-metric.
    \end{remark}

\section{Completeness}

    \newdef{Cauchy sequence}{\index{Cauchy!sequence}\index{Cauchy!criterion}\label{metric:cauchy_sequence}
        A sequence $\seq{x}$ in a metric space $(M,d)$ is Cauchy (or has the Cauchy property) if
        \begin{gather}
            \forall\varepsilon>0:\exists N\in\mathbb{N}:\forall m,n\geq N:d(x_m,x_n)<\varepsilon.
        \end{gather}
        A metric space $(M,d)$ is said to satisfy the Cauchy criterion if a sequence converges to a point $x\in M$ if and only if it is Cauchy.
    }

    \newdef{Complete metric space}{\index{complete!space}\label{metric:complete_space}
        A metric space that satisfies the Cauchy criterion.
    }
    \begin{property}
        Subsets of metric spaces have the following properties:
        \begin{itemize}
            \item Every closed subset of a complete metric space is complete.
            \item Every complete subset of a metric space is closed.
        \end{itemize}
    \end{property}

\subsection{Injective metric spaces}

    \newdef{Metric retraction}{\index{retract!metric}
        Let $(M,d)$ be a metric space. A function $f:X\rightarrow X$ is said to be a retraction of metric spaces if:
        \begin{itemize}
            \item $f$ is idempotent, and
            \item $f$ is non-expansive, i.e. the following relation holds for all $x,y\in M$:
                \begin{gather}
                    d(f(x),f(y))\leq d(x,y).
                \end{gather}
        \end{itemize}
        The image of $f$ is called a (metric) retract of $M$.
    }

    \newdef{Injective metric space}{\index{injective!metric space}
        A metric space $M$ is said to be injective if whenever $M$ is isometric to a subspace $Y$ of a metric space $X$, then $Y$ is a metric retract of $X$.
    }

    \begin{property}
        Every injective metric space is complete.
    \end{property}

\subsection{Convex metric spaces}

    \newdef{Convex space}{\index{convex}
        A metric space $(M,d)$ with the property that for every two points $x,y\in M$ there exists a third point $z\in M$ such that
        \begin{gather}
            d(x,z) = d(x,y) + d(y,z).
        \end{gather}
    }
    \begin{property}[Convex sets]
        A closed subset of Euclidean space is a convex metric space if and only if it is a convex set \ref{linalgebra:convex}.
    \end{property}

    \newdef{Hyperconvex space}{\index{hyperconvex}
        A convex space for which the set of closed balls has the Helly property \ref{set:helly_family}.
    }

    \begin{theorem}[Aronszajn \& Panitchpakdi]
        A metric space is injective if and only if it is hyperconvex.
    \end{theorem}

    ?? WHY IS THIS HERE ??

\section{Compactness}

    See Section \ref{section:compact} for the general theory of compact spaces.

    \begin{theorem}[Stone]\index{Stone!theorem on paracompactness}
        Every metric space is paracompact.
    \end{theorem}

    \newdef{Totally bounded}{\index{bounded!totally}
        A metric space $M$ is said to be totally bounded if it satisfies the following equivalent statements:
        \begin{itemize}
            \item For every $\varepsilon>0$ there exists a finite cover $\mathcal{F}$ of $M$ with $\forall F\in\mathcal{F}:\text{diam}(F)\leq\varepsilon$.
            \item For every $\varepsilon>0$ there exists a finite subset $E\subset M$ such that $M\subseteq\bigcup_{x\in E}B(x, \varepsilon)$.
        \end{itemize}
    }
    \begin{property}[Boundedness]
        Every totally bounded set is in particular bounded and every subset of a totally bounded set is also totally bounded. Furthermore, every totally bounded space is second-countable.
    \end{property}

    The following theorem is a generalization of the Heine-Borel theorem for Euclidean spaces $\mathbb{R}^n$.
    \begin{theorem}\index{Heine-Borel}
        For a metric space $M$ the following statements are equivalent:
        \begin{itemize}
            \item $M$ is compact.
            \item $M$ is sequentially compact.
            \item $M$ is complete and totally bounded.
        \end{itemize}
    \end{theorem}

    \begin{theorem}[Heine-Cantor]\index{Heine-Cantor}
        Let $M,M'$ be two metric spaces with $M$ compact. Every continuous function $f:M\rightarrow M'$ is also uniformly continuous.
    \end{theorem}

    \newdef{Equicontinuity}{\index{equicontinuity}\label{metric:equicontinuity}
        Let $X$ be a topological space and let $M$ be a metric space. A collection $\mathcal{F}$ of maps $X\rightarrow M$ is equicontinuous in $a\in X$ if for all neighbourhoods $U$ of $a$ the following statements holds for all $\varepsilon\geq 0$:
        \begin{gather}
            \forall f\in\mathcal{F},\forall x\in U:d(f(x),f(a))\leq\varepsilon.
        \end{gather}
    }

    \begin{property}
        Let $I\subseteq\mathbb{R}$ be an open interval and let $\mathcal{F}$ be a collection of differentiable functions such that $\{f'(t)\mid f\in\mathcal{F},t\in I\}$ is bounded. Then $\mathcal{F}$ is equicontinuous.
    \end{property}

    \begin{theorem}[Arzel\`a-Ascoli]\index{Arzel\`a-Ascoli}
        Let $K$ be a compact topological space and let $M$ be a complete metric space. The following statements are equivalent for any collection $\mathcal{F}\subseteq C(K,M)$:
        \begin{itemize}
            \item $\mathcal{F}$ is compact with respect to the supremum distance \eqref{metric:supremum_distance}.
            \item $\mathcal{F}$ is equicontinuous, closed under uniform convergence and $\{f(x)\mid f\in\mathcal{F}\}$ is totally bounded for every $x\in K$.
        \end{itemize}
    \end{theorem}
\chapter{Sheaf Theory}\label{chapter:sheaf}

    A reference for this chapter is \cite{brylinski}. For a background on topological spaces: see chapters \ref{chapter:topology} and onwards. For the concept of sheaf in category theory, see section \ref{section:grothendieck_topos}.

\section{Presheaves}

    \newdef{Presheaf}{\index{presheaf}\index{section}
        Let $(X,\tau)$ be a topological space. A presheaf over $X$ consists of an algebraic structure $\mathcal{F}(U)$ for every open set $U\in\tau$ and a morphism $\Phi^U_V:\mathcal{F}(U)\rightarrow \mathcal{F}(V)$ for every two open sets $U, V\in\tau$ with $V\subseteq U$ such that the following conditions are satisfied:
        \begin{enumerate}
            \item $\Phi^U_U = \mathbbm{1}_{\mathcal{F}(U)}$, and
            \item if $W\subseteq V\subseteq U$, then $\Phi^U_W = \Phi^V_W\circ\Phi^U_V$.
        \end{enumerate}
        The set $\mathcal{F}(U)$ is called the set of \textbf{sections} over $U$ and the morphisms $\Phi^U_V$ are called the \textbf{restriction maps}.
    }

    \newdef{Morphism of presheaves}{\index{morphism!of presheaves}\index{germ}
        Let $\mathcal{F}, \mathcal{F}'$ be two presheaves over a space $X$. A morphism $\mathcal{F}\rightarrow \mathcal{F}'$ is a set of morphisms $\Psi_U:\mathcal{F}(U)\rightarrow \mathcal{F}'(U)$ that commute with the restriction maps $\Phi^U_V$.
    }

    \begin{adefinition}[Categorical definition]
        Using the language of category theory one can more easily introduce presheaves: Let $\mathbf{C}$ be a category and let $X$ be a topological space. A $\mathbf{C}$-valued presheaf on $X$ is a contravariant functor $\mathcal{F}:\mathbf{Open}(X)\rightarrow\mathbf{C}$. A morphism of presheaves is accordingly a natural transformation between such functors. As such the category of presheaves on a topological space $X$ is in fact $\mathbf{Set}^{\mathbf{Open}(X)^{op}}$, the presheaf topos on $\mathbf{Open}(X)$.
    \end{adefinition}

    \begin{example}[Constant presheaf]\label{sheaf:constant_presheaf}
        Let $S$ be any set. The constant presheaf over $X$ with target $S$ is defined by
        \begin{gather}
            \mathcal{F}(U) := S
        \end{gather}
        for every open set $U\subseteq X$.
    \end{example}

\section{Sheaves}

    \newdef{Sheaf}{\index{sheaf}\label{sheaf:def}
        Let $(X,\tau)$ be a topological space. A sheaf over $X$ is a presheaf $\mathcal{F}$ satisfying the following conditions:
        \begin{enumerate}
            \item \textbf{Locality (or separation)}: Let $\{U_i\}_{i\in I}\subset\tau$ be an open cover of $U\subseteq X$ and consider sections $s, t\in\mathcal{F}(U)$. If $\forall i\in I: s|_{U_i}=t|_{U_i}$, then $s=t$. This is equivalent to saying that that $\mathcal{F}(U)$ injects into $\prod_i\mathcal{F}(U_i)$ for all open covers of $U$.
            \item \textbf{Gluing}: Let $\{U_i\}_{i\in I}\subset\tau$ be an open cover of $U\subseteq X$ and let $\{s_i\in\mathcal{F}(U_i)\}$ be a collection of sections. If $\forall i, j\in I: s_i|_{U_i\cap U_j} = s_j|_{U_i\cap U_j}$, then there exists a section $s\in\mathcal{F}(U)$ such that $\forall i\in I: s|_{U_i} = s_i$.
        \end{enumerate}
    }
    \begin{remark}[Separated presheafs]
        If a global section exists by the gluing condition, then it is automatically unique by the separation axiom. In some texts these two conditions are combined in a single gluing condition that requires a unique global section. Presheafs satisfying only the first condition are said to be \textbf{separated}. (See also the footnote in definition \ref{topoi:sheaf}.)
    \end{remark}

    \begin{property}
        Let $X$ be a topological space and let $\mathcal{F}$ be a presheaf over $X$. $\mathcal{F}$ is a sheaf over $X$ if for any open $U\subseteq X$ and every open cover $\{U_i\}_{i\in I}$ of $U$ the following diagram is an equalizer diagram:
        \begin{gather}
            \label{sheaf:equalizer}
            \mathcal{F}(U)\rightarrow\prod_{i\in I}\mathcal{F}(U_i)\rightrightarrows\prod_{i, j\in I}\mathcal{F}(U_i\cap U_j).
        \end{gather}
        The two morphisms on the right are obtained by combining the projection morphisms of the direct product and the restriction morphisms $\Phi^{U_i}_{U_i\cap U_j}$ and $\Phi^{U_j}_{U_i\cap U_j}$.
    \end{property}

    \newdef{Stalk}{\index{stalk}\index{germ}
        Let $x\in X$ and consider the set of all neighbourhoods of $x$. This set can be turned into a directed set \ref{set:directed_set} by equipping it with the (partial) order relation \[U\subseteq V\implies U\geq V.\] This turns the sheaf $\mathcal{F}$ over $X$ into a directed system. The stalk over $x$ is then defined as the following direct limit \ref{algebra:direct_limit}:
        \begin{gather}
            \mathcal{F}_x := \varinjlim_{U\ni x} \mathcal{F}(U).
        \end{gather}
        The equivalence class of a section $s\in\mathcal{F}(U)$ in $\mathcal{F}_x$ is called the \textbf{germ} of $s$ at $x$. Two sections belong to the same germ at $x$ if there exists a neighbourhood of $x$ on which they coincide.
    }
    \begin{notation}
        Similar to the notation of the restriction morphisms we denote the morphism that maps every section to its germ at $x$ by $\Phi^U_x$.
    \end{notation}

    \begin{property}
        Two subsheaves of a sheaf $\mathcal{G}$ over $X$ are equal if and only if their stalks are equal as subsets of $\mathcal{G}_x$ for all points $x\in X$.
    \end{property}

    \begin{construct}[Associated sheaf]\index{sheafification}
        Consider a presheaf $\mathcal{F}$ over a topological space $X$. From this presheaf one can construct a sheaf $\overline{\mathcal{F}}$, called the \textbf{sheafification} or associated sheaf of $\mathcal{F}$, in the following way:

        First we define a presheaf $\mathcal{G}$ such that\footnote{Sections in this sheaf are said to be \textit{continuous}. This statement can be made formal using the concept of an \'etal\'e space. (See construction \ref{sheaf:etale_construction}.)}
        \begin{gather}
            \mathcal{G}(U) := \left\{(s_x)_{x\in U}\in\prod_{x\in U}\mathcal{F}_x:\left(\forall x\in U: \exists\text{ open }V\ni x, t\in\mathcal{F}(V): \forall v\in V: s_v = \Phi^V_v(t)\right)\right\}.
        \end{gather}
        The restriction maps $\rho^U_V$ are defined by
        \begin{gather}
            \rho^U_V:(s_x)_{x\in U}\mapsto(s_x)_{x\in V}.
        \end{gather}
        It is easily proven that this presheaf is in fact a sheaf and hence we obtain the sheafification of $\mathcal{F}$ by setting $\overline{\mathcal{F}} = \mathcal{G}$. This construction also gives a canonical morphism $\varphi:\mathcal{F}\rightarrow\overline{\mathcal{F}}$ defined by
        \begin{gather}
            \varphi(s):U\rightarrow\prod_{x\in U}\mathcal{F}_x:x \mapsto s_x = \Phi^U_x(s)
        \end{gather}
        where $s\in\mathcal{F}(U)$ and $x\in U$.
    \end{construct}
    \sremark{We see that the sections of $\overline{\mathcal{F}}$ arise from (locally) resticting sections of $\mathcal{F}$ to the stalks $\mathcal{F}_x$.}

    \begin{uproperty}
        Let $\mathcal{F}$ be a presheaf over $X$ with associated sheaf $\overline{\mathcal{F}}$. For any sheaf $\mathcal{G}$ over $X$ and any morphism $\rho:\mathcal{F}\rightarrow\mathcal{G}$ there exists a unique morphism $\sigma:\overline{\mathcal{F}}\rightarrow\mathcal{G}$ such that $\rho = \sigma\circ\varphi$ where $\varphi$ is the canonical morphism $\mathcal{F}\rightarrow\overline{\mathcal{F}}$.
    \end{uproperty}

    \begin{property}
        Let $\mathcal{F}$ be a presheaf over $X$ with associated sheaf $\overline{\mathcal{F}}$. The morphism $\varphi:\mathcal{F}\rightarrow\overline{\mathcal{F}}$ induces an isomorphism $\varphi_x:\mathcal{F}_x\rightarrow\overline{\mathcal{F}}_x$ for all $x\in X$.
    \end{property}
    \begin{property}
        Let $\mathcal{F}$ be a sheaf over $X$ with associated sheaf $\overline{\mathcal{F}}$. The morphism $\varphi:\mathcal{F}\rightarrow\overline{\mathcal{F}}$ is an isomorphism.
    \end{property}

    There exists another, more topological, construction of the associated sheaf:
    \begin{construct}[\'Etal\'e spaces]\label{sheaf:etale_construction}
        Let $\mathcal{F}$ be a presheaf over $X$. Consider the disjoint union
        \begin{gather}
            \mathcal{F}^* := \bigsqcup_{x\in X}\mathcal{F}_x.
        \end{gather}
        Define for every local section $s\in\mathcal{F}(U)$ a function $\overline{s}:U\rightarrow\mathcal{F}^*:x\mapsto s_x\in\mathcal{F}_x$. The union $\mathcal{F}^*$ can be turned into an \'etal\'e space \ref{topology:etale_space} over $X$ by equipping it with the topology with basis
        \begin{gather}
            \big\{\overline{s}(U)\mid U\text{ open in }X, s\in\mathcal{F}(U)\big\}.
        \end{gather}
        The projection map $\pi$ is given by $\pi:s_x\in\mathcal{F}_x\mapsto x$. The sheafification $\overline{\mathcal{F}}$ is then given by the sheaf of sections of $\mathcal{F}^*$.
    \end{construct}

    \begin{property}[Paracompact spaces]
        Let $X$ be a paracompact space \ref{topology:paracompact} and consider a sheaf $F$ of Abelian group on $X$. For every closed subset $V\subset X$ there exists an isomorphism
        \begin{gather}
            \varinjlim_{U\supset K}F(U)\cong F(K),
        \end{gather}
        where $F(K)$ is defined as the set of sections of the restriction of the \'etal\'e space $F^*$ to $K$. This implies that every section over a closed subset can be extended to a local section over some open neighbourhood.
    \end{property}

    \newdef{Flabby sheaf}{\index{sheaf!flabby}\index{sheaf!flasque|see{flabby}}
        A sheaf $F$ on a topological space $X$ such that for every two open subsets $U\subseteq V\subseteq X$ the restriction morphism $F(V)\rightarrow F(U)$ is onto.
    }
    \newdef{Soft sheaf}{\index{sheaf!soft}\label{sheaf:soft}
        A sheaf on a topological space (often required to be paracompact Hausdorff) such that for every section over a closed subset can be extended to a global section.

        From the previous property and definition it is clear that (on a paracompact Hausdorff space) every flabby sheaf is soft.
    }

    One can also construct the sheafification in a different way:
    \begin{construct}[Abstract nonsense]\label{sheaf:colimit_construction}
        Consider the equalizer \ref{sheaf:equalizer}. To every presheaf $\mathcal{F}$ one can assign a separated presheaf $\mathcal{F}^\#$ by defining $\mathcal{F}^\#(U)$ as the colimit (direct limit \ref{algebra:direct_limit}) of the equalizers over all open covers of $U$ (which are ordered by refinement). A sheaf is obtained by repeating this construction a second time.
    \end{construct}

    \begin{example}[Constant sheaf]\label{sheaf:constant_sheaf}
        Consider the constant presheaf over $X$ with target $S$ (Example \ref{sheaf:constant_presheaf}). The constant sheaf, denoted by $\underline{S}$ or $\flat S$, is defined as the associated sheaf of this presheaf. The stalks over every point $x\in X$ can be identified with $S$. The continuous sections $\underline{S}(U)$ are the locally constant functions $f:U\rightarrow S$.
    \end{example}

    \begin{notation}[Category of sheaves]
        \nomenclature[S_Sheaf]{$\mathbf{Sh}(X)$}{Category of sheaves over a topological space $X$.}
        Similar to the case of presheaves one can define a morphism of sheaves as a morphism commuting with the restriction maps.\footnote{When viewing a (pre)sheaf as a functor, the (pre)sheaf morphism is a natural transformation.} The sheaves and sheaf morphisms over a space $X$ form a full subcategory of the category of presheaves, denoted by $\mathbf{Sh}(X)$.
    \end{notation}

    \begin{property}[\difficult{Sheaf topos}]
        The category of sheaves $\mathbf{Sh}(X)$ is in fact an elementary topos, called the sheaf topos over $X$. (See property \ref{topoi:sheaf_topos}.)
    \end{property}

    \newdef{Global sections functor}{\index{global!sections}\label{sheaf:global_sections_functor}
        Let $X$ be a topological space. The global sections functor $\Gamma(X,-)$ is defined as the functor $\Gamma(X, -):\mathbf{Sh}(X)\rightarrow\mathbf{Set}:\mathcal{F}\rightarrow\mathcal{F}(X)$.
    }
    \begin{property}\label{sheaf:left_exact_functor}
        The global sections functor is only left exact.
    \end{property}

\section{Cohomology}

    In this section we will only consider Abelian sheaves, i.e. sheaves with values in $\mathbf{Ab}$ (unless stated otherwise).

\subsection{Derived cohomology}

    \begin{property}[Injective resolutions]
        Every Abelian sheaf admits an injective resolution or, equivalently, the category $\mathcal{AB}(X)$ of Abelian sheaves has enough injectives.
    \end{property}
    Because of Property \ref{sheaf:left_exact_functor}, one can construct nontrivial (right) derived functors of $\Gamma(X,-)$:
    \newdef{Sheaf cohomology group}{\index{cohomology!sheaf}
        Let $\mathcal{F}$ be a sheaf over $X$. Given an injective resolution (as usual the result will be independent of the chosen resolution) $I$ of $\mathcal{F}$, the sheaf cohomology groups of $\mathcal{F}$ over $X$ are defined as the cohomology groups of the complex
        \begin{gather}
            \cdots\longrightarrow\Gamma(X,I^i)\longrightarrow\Gamma(X,I^{i+1})\longrightarrow\cdots.
        \end{gather}
        The cohomology group $H^0(X;\mathcal{F})$ is equal to $\Gamma(X,\mathcal{F})$.
    }

    \newdef{Acyclic sheaf}{\index{sheaf!acyclic}
        A sheaf is called acyclic if its higher cohomology groups vanish (cf. Definition \ref{homalg:acyclic_object}).
    }
    \begin{example}[Soft sheaves]\label{sheaf:example_soft}
        Soft sheaves \ref{sheaf:soft} are acylic. Let $(M,\mathcal{O}_M)$ be a smooth manifold with its sheaf of smoth functions (resp. complex manifold with its sheaf of holomorphic functions). All sheaves of $\mathcal{O}_M$-modules are soft and, hence, acyclic.
    \end{example}

    The following theorem is a specific instance of property \ref{homalg:acyclic_derived_functors}:
    \begin{theorem}[de Rham \& Weil]\index{de Rham-Weil}
        Let $\mathcal{F}$ be a sheaf. There exists an isomorphism between the sheaf cohomology groups defined above and the ones obtained by using an acyclic resolution of $\mathcal{F}$.
    \end{theorem}

    \newdef{Image and kernel}{
        Given a morphism of sheaves $\phi:\mathcal{F}\rightarrow\mathcal{G}$ over a space $X$ one can define the kernel/image presheaves which assign to every open subset $U\subseteq X$ the image/kernel of $\phi_U$. The kernel presheaf is already a sheaf and will be denoted by $\ker(\phi)$. The sheafification of the image presheaf will be denoted by $\im(\phi)$. (Smilarly one can also define cokernels and any other notion that makes sense in Abelian categories.)
    }

    \newdef{Cohomology sheaves}{
        Let $\mathcal{F}^\bullet$ be a cohain complex of sheaves over $X$. The cohomology sheaves $\underline{H}^i(X;\mathcal{F}^\bullet)$ are obtained by sheafifying the presheafs that assign to every open subset $U\subseteq X$ the quotient group $\ker(d^i_U)/\im(d^{i-1}_U)$.
    }

\subsection{\v{C}ech cohomology}

    Consider a chain complex $(A_\bullet,\partial)\in\mathbf{Ch}(\mathcal{AB}(X))$ of Abelian sheaves on a topological space $X$ (for simplicity concentrated in nonnegative degree).

    \newdef{\v{C}ech cohomology}{\index{\v{C}ech!cohomology}\label{sheaf:cech}
        For an open cover $\mathcal{U}=\{U_i\subseteq X\}_{i\in I}$, denote the intersection $U_{i_0}\cap\cdots\cap U_{i_k}$ by  $U_{i_0\ldots i_k}$. The cochain groups are defined for all $p\in\mathbb{N}$ as before:
        \begin{gather}
            C^p(\mathcal{U};A_\bullet) := \bigoplus_{\substack{p=n-k\\i_0<\cdots<i_k}}A_n(U_{i_0\ldots i_k}).
        \end{gather}
        Since the (pre)sheaf takes values in Abelian groups, one can define the subtraction of elements and hence the definition of the following differential makes sense:
        \begin{align}
            (d\omega)_{i_0\ldots i_{k+1}} :=&\ \left(\partial\omega + (-1)^k\sum_{i=0}^k(-1)^iA_\bullet(\iota_i)\omega\right)_{i_0\ldots i_{k+1}}\nonumber\\
            =&\ \partial\omega_{i_0\ldots i_{k+1}}+(-1)^k\sum_{j=0}^{k+1}(-1)^j\left.\omega_{i_0\ldots i_{j-1}i_{j+1}\ldots i_{k+1}}\right|_{U_{i_0\ldots i_{k+1}}}\label{sheaf:total_cech_differential}
        \end{align}
        where $\iota_i$ are the inclusion maps as before. The cohomology $\check{H}^\bullet(\mathcal{U};A_\bullet)$ of this complex is called the \v{C}ech cohomology of $\mathcal{U}$ with values in $A_\bullet$.

        By taking the direct limit over the direct system of open covers (the partial ordering is given by refinement of covers) one can define the \v{C}ech cohomology $\check{H}^\bullet(X;A_\bullet)$ of $X$ with values in $A_\bullet$.
    }
    \begin{remark}[Hypercohomology]\index{hypercohomology}
        Two remarks should be made here. The above construction is essentially building a double complex and calculating the cohomology of the total complex. The definition \eqref{sheaf:total_cech_differential} of the total differential might differ from others in the literature by a factor $(-1)^k$ (as is often the case, since vertical and horizontal directions can be interchanged). Furthermore, sometimes the definition of \v{C}ech cohomology is only given with values in an Abelian group, such that the first term in \eqref{sheaf:total_cech_differential} also vanishes. This case can be recovered from the above construction by considering chain complexes concentrated in a single degree. The more general case is often called \textbf{hypercohomology}.
    \end{remark}

    The following two properties state when \v{C}ech cohomology calculates the (derived) cohomology of sheaves:
    \begin{property}
        For a paracompact Hausdorff space, the \v{C}ech cohomology and (derived) sheaf cohomology coincide for all sheaves. For $i=0,1$, one always has
        \begin{gather}
            \check{H}^{0,1}(X;\mathcal{F})\cong H^{0,1}(X;\mathcal{F}).
        \end{gather}
    \end{property}
    \begin{property}[Leray]\index{Leray}\index{acyclic}
        An open cover $\mathcal{U}=\{U_i\subset X\}_{i\in I}$ of a topological space is said to be \textbf{acyclic} with respect to a sheaf $\mathcal{F}$ if $\mathcal{F}$ is acyclic with respect to any finite subcover of $\mathcal{U}$:
        \begin{gather}
            H^{\bullet\geq1}(U_{i_1}\cap\ldots\cap U_{i_k};\mathcal{F})=0
        \end{gather}
        for all $i_1,\ldots,i_k\in I$. If $\mathcal{U}$ is acylic with respect to $\mathcal{F}$, then
        \begin{gather}
            \check{H}^\bullet(\mathcal{U};\mathcal{F})\cong H^\bullet(X;\mathcal{F}).
        \end{gather}
    \end{property}
    \begin{example}[Good covers]
        Consider a topological space admitting a good cover \ref{diff:good_cover}. The Leray theorem applies whenever the cohomology of a single point vanishes. This is for example the case for all locally constant sheaves.
    \end{example}
    \begin{result}
        For all topological spaces admitting a good cover (e.g. finite CW complexes or Riemannian manifolds), the \v{C}ech and singular cohomologies coincide.
    \end{result}

\section{Ringed spaces}

    \newdef{Ringed space}{\index{ringed space}
        A ringed space is a topological space $X$ equipped with a sheaf of rings $\mathcal{O}_X$.
    }
    \newdef{Locally ringed space}{
        A ringed space $(X, \mathcal{O}_X)$ is said to be locally ringed if the stalk over every point $x\in X$ is a local ring \ref{algebra:local_ring}.
    }
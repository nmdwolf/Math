\section{Inner product}\label{linalgebra:innerproduct}

    In the following section all vector spaces $V$ will be defined over $\mathbb{R}$ or $\mathbb{C}$.

    \newdef{Inner product}{\index{inner!product}
        Let $v, w$ be two vectors in $V$. A map $\langle\cdot|\cdot\rangle:V\times V\rightarrow K$ is called an inner product on $V$ if it satisfies the following properties:
        \begin{enumerate}
            \item \textbf{Conjugate symmetry}: $\langle v|w \rangle = \langle w|v \rangle^*$,
            \item \textbf{Linearity in the first argument}: $\langle \lambda u+v|w \rangle = \lambda\langle u|w \rangle + \langle v|w \rangle$,
            \item \textbf{Nondegeneracy}: $\langle v|v \rangle = 0 \iff v = 0$, and
            \item \textbf{Positive-definiteness}: $\langle v|v \rangle \geq 0$.
        \end{enumerate}
    }
    \begin{remark}\index{Hermitian!form}\label{linalgebra:NDH_form}
        Inner products are special cases of \textbf{nondegenerate Hermitian forms} which do not satisfy the positive-definiteness property (they often occur when working over $\mathbb{C}$).
    \end{remark}

    \begin{result}\index{sesquilinear}
        The first two properties have the result of conjugate linearity in the second argument:
        \begin{gather}
            \langle f|\lambda g + \mu h \rangle = \overline{\lambda}\langle f|g \rangle + \overline{\mu}\langle f|h \rangle
        \end{gather}
        Therefore these two properties together are often combined into a \textbf{sesquilinearity} property.
    \end{result}

\subsection{Inner product space}

    \newdef{Inner product space\footnotemark}{
        \footnotetext{Sometimes called a \textbf{pre-Hilbert space}.}
        A vector space equipped with an inner product $\langle\cdot|\cdot\rangle$.
    }

    \newdef{Metric dual\footnotemark}{
        \footnotetext{See also definition \ref{riemann:flat_map}.}
        Using the inner product (or any other nondegenerate Hermitian form) one can define the metric dual of a vector $v$ by the following map:
        \begin{gather}
            \label{linalgebra:metric_dual}
            L:V\rightarrow V^*:v\mapsto \langle v|\cdot \rangle.
        \end{gather}
    }
    \newdef{Adjoint operator}{\index{adjoint}\index{Hermitian}\index{self-adjoint}\label{linalgebra:adjoint_operator}
        Let $A$ be a linear operator on $V$. The (\textbf{Hermitian}) adjoint of $A$ is defined as the linear operator $A^\dag$ that satisfies
        \begin{gather}
            \langle A^\dag v|w\rangle = \langle v|Aw\rangle
        \end{gather}
        for all $v,w\in V$. Alternatively, one can define the adjoint using the transpose and metric dual as follows:
        \begin{gather}
            A^\dag = L^{-1} \circ A^T \circ L.
        \end{gather}
        If $A = A^\dag$ then A is said to be \textbf{Hermitian} or \textbf{self-adjoint}.\footnote{In chapter \ref{chapter:normed_spaces} we will make a distinction between these two notions.}
    }

    \begin{result}
        The Hermitian adjoint of a complex matrix $A\in\mathbb{C}^{m\times n}$ is given by
        \begin{gather}
            A^\dag = \overline{A}^T
        \end{gather}
        where $\overline{A}$ denotes the complex conjugate of $A$ and $A^T$ the transpose of $A$.
    \end{result}

\subsection{Orthogonality}\label{linalgebra:section:orthogonality}

    \newdef{Orthogonal}{\index{orthogonal}
        Consider two vectors $v,w\in V$ in an inner product space. These vectors are said to be orthogonal, denoted by $v\perp w$,  if they obey the following relation:
        \begin{gather}
            \label{linalgebra:orthogonal}
            \langle v|w \rangle = 0.
        \end{gather}
        An \textbf{orthogonal system} is a set of vectors, none of them equal to 0, that are mutually orthogonal.
    }
    \begin{property}
        Orthogonal systems are linearly independent.
    \end{property}

    \newdef{Orthonormal}{
        A set of vectors $S$ is said to be orthonormal if it forms an orthogonal system and if all the elements $v\in S$ obey the following relation:
        \begin{gather}
            \label{linalgebra:orthonormal}
            \langle v|v \rangle = 1.
        \end{gather}
    }
    \newdef{Orthogonal complement\footnotemark}{\index{complement}\label{linalgebra:orthogonal_complement}
        \footnotetext{$W^\perp$ is pronounced as 'W-perp'.}
        Let $W$ be a subspace of an inner product space $V$. The following subspace is called the orthogonal complement of $W$:
        \begin{gather}
            W^\perp := \{v\in V:\forall w\in W:\langle v|w\rangle = 0\}.
        \end{gather}
    }

    \begin{property}
        Let $V$ be a finite-dimensional inner product space. The orthogonal complement $W^\perp$ is a complementary subspace to $W$, i.e. $W\oplus W^\perp=V$. (This explains the name.)
    \end{property}
    \begin{result}\label{linalgebra:perp_of_perp}
        Let $W\leq V$ where $V$ is a finite-dimensional inner product vector space. Taking orthogonal complements defines an involution:
        \begin{gather}
            (W^\perp)^\perp = W.
        \end{gather}
    \end{result}

    \newdef{Orthogonal projection}{\index{projection}\label{linalgebra:orthogonal_projection}
        Let $V$ be a finite-dimensional inner product vector space and consider a subspace $W\leq V$. Consider a vector $w\in W$ and let $\{w_1, \ldots, w_k\}$ be an orthonormal basis of $W$. We define the projection of $v\in V$ on $W$ and $w\in W$ as follows:
        \begin{align}
            \text{proj}_W(v) &:= \sum_{i=1}^k\langle v|w_i \rangle w_i\\
            \text{proj}_w(v) &:= \stylefrac{\langle v|w \rangle}{\langle w|w \rangle}w.
        \end{align}
    }
    \begin{property}
        Orthogonal projections satisfy the following conditions:
        \begin{itemize}
            \item $\forall w\in W:\text{proj}_W(w) = w$, and
            \item $\forall u\in W^\perp:\text{proj}_W(u) = 0$.
        \end{itemize}
    \end{property}

    \newmethod{Gram-Schmidt orthonormalisation}{\label{linalgebra:inner_product:gram_schmidt}
        Let $\{u_i\}_{i\leq n}$ be a set of linearly independent vectors. We can construct an orthonormal set $\{e_i\}_{i\leq n}$ out of $\{u_i\}_{i\leq n}$ using the following procedure:
        \begin{enumerate}
            \item Orthogonalisation:
                \begin{gather}
                    \begin{aligned}
                        &w_1 = u_1&\\
                        &w_2 = u_2 - \stylefrac{\langle u_2|w_1\rangle}{||u_2||^2}w_1&\\
                        &\vdots&\\
                        &w_n = u_n - \sum_{i=1}^{n-1}\stylefrac{\langle u_n|w_i\rangle}{||u_n||^2}w_i&
                    \end{aligned}
                \end{gather}
            \item Normalisation:
                \begin{gather}
                    \begin{aligned}
                        &e_1 = \stylefrac{w_1}{||w_1||}&\\
                        &e_2 = \stylefrac{w_2}{||w_2||}&\\
                        &\vdots&\\
                        &e_n = \stylefrac{w_n}{||w_n||}&
                    \end{aligned}
                \end{gather}
        \end{enumerate}
    }

    \newdef{Householder transformation}{\index{Householder transformation}\label{linalgebra:householder_transformation}
        Let $v$ be an element of an inner product space $V$. The Householder transformation generated by $v$ is given by the linear map
        \begin{gather}
            \sigma_v:w\mapsto w - 2\frac{\langle w|v \rangle}{\langle v|v \rangle}v.
        \end{gather}
        This transformation amounts to a reflection in the hyperplane orthogonal to $v$.
    }

    \newdef{Angle}{\index{angle}
        Let $v,w$ be elements of an inner product space $V$. The angle $\theta$ between $v$ and $w$ is defined using the following formula:
        \begin{gather}
            \label{linalgebra:angle}
            \cos\theta := \stylefrac{\langle v|w \rangle}{||v||||w||}.
        \end{gather}
    }